[0m19:55:43.477002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11870cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11873ffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11873fe00>]}


============================== 19:55:43.489249 | d02b52f0-e03e-486a-af5c-18cb77a33278 ==============================
[0m19:55:43.489249 [info ] [MainThread]: Running with dbt=1.7.15
[0m19:55:43.489784 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:55:47.078108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd02b52f0-e03e-486a-af5c-18cb77a33278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11870ec30>]}
[0m19:55:47.114588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd02b52f0-e03e-486a-af5c-18cb77a33278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c569f0>]}
[0m19:55:47.116465 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m19:55:47.170278 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m19:55:47.171468 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:55:47.171788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd02b52f0-e03e-486a-af5c-18cb77a33278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c654770>]}
[0m19:55:48.039867 [error] [MainThread]: Encountered an error:
Compilation Error in model snap_dim_company (models/snapshots/snap_dim_company.sql)
  Encountered unknown tag 'snapshot'.
    line 1
      {% snapshot snap_dim_company %}
[0m19:55:48.040844 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 4.688792, "process_user_time": 4.546843, "process_kernel_time": 2.256532, "process_mem_max_rss": "245710848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:55:48.041882 [debug] [MainThread]: Command `dbt build` failed at 19:55:48.041711 after 4.69 seconds
[0m19:55:48.042274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118157ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f432f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14c1672f0>]}
[0m19:55:48.042587 [debug] [MainThread]: Flushing usage events
[0m19:56:35.827385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112500fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112502180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112555250>]}


============================== 19:56:35.833353 | ea10d1a2-97bc-409a-9087-a82c3902a179 ==============================
[0m19:56:35.833353 [info ] [MainThread]: Running with dbt=1.7.15
[0m19:56:35.834018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt', 'send_anonymous_usage_stats': 'True'}
[0m19:56:39.020942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166961910>]}
[0m19:56:39.057954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f8d3d0>]}
[0m19:56:39.061419 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m19:56:39.083968 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m19:56:39.085893 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:56:39.086270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1669f5e20>]}
[0m19:56:39.922390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166fc9d00>]}
[0m19:56:39.937377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166e4cef0>]}
[0m19:56:39.937824 [info ] [MainThread]: Found 6 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m19:56:39.939441 [info ] [MainThread]: 
[0m19:56:39.940086 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:56:39.941095 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m19:56:39.941524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:39.942032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m19:56:39.942378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:56:40.953659 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now create_sec-edgar-financials-warehouse_sec_curated_sec_curated)
[0m19:56:40.956459 [debug] [ThreadPool]: Creating schema "database: "sec-edgar-financials-warehouse"
schema: "sec_curated_sec_curated"
"
[0m19:56:40.957097 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now create_sec-edgar-financials-warehouse_sec_curated_sec_raw)
[0m19:56:40.958371 [debug] [ThreadPool]: Creating schema "database: "sec-edgar-financials-warehouse"
schema: "sec_curated_sec_raw"
"
[0m19:56:40.966654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:40.966940 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:41.051087 [debug] [ThreadPool]: On create_sec-edgar-financials-warehouse_sec_curated_sec_curated: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "connection_name": "create_sec-edgar-financials-warehouse_sec_curated_sec_curated"} */
create schema if not exists `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`
  
[0m19:56:41.138753 [debug] [ThreadPool]: On create_sec-edgar-financials-warehouse_sec_curated_sec_raw: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "connection_name": "create_sec-edgar-financials-warehouse_sec_curated_sec_raw"} */
create schema if not exists `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`
  
[0m19:56:41.863909 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:7fa84877-d3d2-4511-a8db-e0108ad6b0be&page=queryresults
[0m19:56:41.948743 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:14cc206e-0cd1-4c44-a106-531892262492&page=queryresults
[0m19:56:42.749157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sec-edgar-financials-warehouse_sec_curated_sec_raw, now list_sec-edgar-financials-warehouse_sec_curated_sec_curated)
[0m19:56:42.749993 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sec-edgar-financials-warehouse_sec_curated_sec_curated, now list_sec-edgar-financials-warehouse_sec_curated_sec_raw)
[0m19:56:42.750469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:42.750731 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:56:43.408574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1671445f0>]}
[0m19:56:43.409646 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:56:43.410010 [info ] [MainThread]: 
[0m19:56:43.477019 [debug] [Thread-1 (]: Began running node model.sec_edgar.stg_companyfacts
[0m19:56:43.477389 [debug] [Thread-2 (]: Began running node model.sec_edgar.stg_submissions
[0m19:56:43.477885 [info ] [Thread-1 (]: 1 of 14 START sql view model sec_curated_sec_raw.stg_companyfacts .............. [RUN]
[0m19:56:43.478232 [info ] [Thread-2 (]: 2 of 14 START sql view model sec_curated_sec_raw.stg_submissions ............... [RUN]
[0m19:56:43.478795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_curated, now model.sec_edgar.stg_companyfacts)
[0m19:56:43.479262 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_raw, now model.sec_edgar.stg_submissions)
[0m19:56:43.479545 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.stg_companyfacts
[0m19:56:43.479796 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.stg_submissions
[0m19:56:43.485556 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.stg_companyfacts"
[0m19:56:43.487575 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.stg_submissions"
[0m19:56:43.493646 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (compile): 19:56:43.479986 => 19:56:43.493474
[0m19:56:43.493979 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (compile): 19:56:43.485779 => 19:56:43.493825
[0m19:56:43.494240 [debug] [Thread-1 (]: Began executing node model.sec_edgar.stg_companyfacts
[0m19:56:43.494511 [debug] [Thread-2 (]: Began executing node model.sec_edgar.stg_submissions
[0m19:56:43.514414 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.stg_submissions"
[0m19:56:43.518544 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.stg_companyfacts"
[0m19:56:43.519104 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:56:43.519398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:43.687796 [debug] [Thread-2 (]: On model.sec_edgar.stg_submissions: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_submissions"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    company_name,
    accession_no,
    form,
    SAFE_CAST(filed as date) as filed,
    SAFE_CAST(report_period as date) as report_period
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_submissions`
)
select * from src;


[0m19:56:43.688250 [debug] [Thread-1 (]: On model.sec_edgar.stg_companyfacts: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_companyfacts"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    concept,
    unit,
    SAFE_CAST(period_end_date as date) as period_end_date,
    SAFE_CAST(val as float64) as value,
    accn, fy, fp, form,
    SAFE_CAST(filed as date) as filed
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_companyfacts`
)
select * from src;


[0m19:56:44.396695 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:1a2ee6e3-aebd-4275-b7c8-b9566df5a58b&page=queryresults
[0m19:56:44.486149 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:d42c7fad-db55-421b-99d6-362dbbe40e90&page=queryresults
[0m19:56:44.755525 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (execute): 19:56:43.500131 => 19:56:44.755359
[0m19:56:44.756162 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1672599d0>]}
[0m19:56:44.756584 [info ] [Thread-2 (]: 2 of 14 OK created sql view model sec_curated_sec_raw.stg_submissions .......... [[32mCREATE VIEW (0 processed)[0m in 1.28s]
[0m19:56:44.756985 [debug] [Thread-2 (]: Finished running node model.sec_edgar.stg_submissions
[0m19:56:44.757378 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m19:56:44.757637 [info ] [Thread-4 (]: 3 of 14 START test not_null_stg_submissions_accession_no ....................... [RUN]
[0m19:56:44.758125 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d'
[0m19:56:44.758364 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m19:56:44.764096 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m19:56:44.764792 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (compile): 19:56:44.758516 => 19:56:44.764644
[0m19:56:44.765058 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m19:56:44.774203 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m19:56:44.774775 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:56:44.861836 [debug] [Thread-4 (]: On test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select accession_no
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
where accession_no is null



      
    ) dbt_internal_test
[0m19:56:44.863823 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (execute): 19:56:43.494682 => 19:56:44.863659
[0m19:56:44.868083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166c6b650>]}
[0m19:56:44.868630 [info ] [Thread-1 (]: 1 of 14 OK created sql view model sec_curated_sec_raw.stg_companyfacts ......... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m19:56:44.869042 [debug] [Thread-1 (]: Finished running node model.sec_edgar.stg_companyfacts
[0m19:56:44.869501 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m19:56:44.869849 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m19:56:44.870194 [info ] [Thread-2 (]: 4 of 14 START test not_null_stg_companyfacts_concept ........................... [RUN]
[0m19:56:44.870536 [info ] [Thread-3 (]: 5 of 14 START test not_null_stg_companyfacts_period_end_date ................... [RUN]
[0m19:56:44.871069 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_submissions, now test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5)
[0m19:56:44.871715 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee'
[0m19:56:44.872129 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m19:56:44.872646 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m19:56:44.876023 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m19:56:44.879333 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m19:56:44.880188 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (compile): 19:56:44.876311 => 19:56:44.880020
[0m19:56:44.880492 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m19:56:44.882372 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m19:56:44.882777 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (compile): 19:56:44.872835 => 19:56:44.882606
[0m19:56:44.883104 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m19:56:44.884807 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m19:56:44.885208 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:56:44.885681 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:56:44.970352 [debug] [Thread-3 (]: On test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where period_end_date is null



      
    ) dbt_internal_test
[0m19:56:45.058219 [debug] [Thread-2 (]: On test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select concept
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where concept is null



      
    ) dbt_internal_test
[0m19:56:46.139948 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:487d8471-6683-4860-b0fd-adaa462d85bd&page=queryresults
[0m19:56:46.144468 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:75ad5b95-da22-4b46-93ad-830c8708a6d3&page=queryresults
[0m19:56:46.258091 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:8f933428-bc4d-4ea2-ae74-22c903a4b00e&page=queryresults
[0m19:56:46.744048 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (execute): 19:56:44.765214 => 19:56:46.743741
[0m19:56:46.744740 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (execute): 19:56:44.880715 => 19:56:46.744554
[0m19:56:46.745528 [info ] [Thread-4 (]: 3 of 14 PASS not_null_stg_submissions_accession_no ............................. [[32mPASS[0m in 1.99s]
[0m19:56:46.746131 [info ] [Thread-3 (]: 5 of 14 PASS not_null_stg_companyfacts_period_end_date ......................... [[32mPASS[0m in 1.87s]
[0m19:56:46.746554 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m19:56:46.746906 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m19:56:46.747632 [debug] [Thread-1 (]: Began running node model.sec_edgar.dim_company
[0m19:56:46.749321 [info ] [Thread-1 (]: 6 of 14 START sql view model sec_curated_sec_curated.dim_company ............... [RUN]
[0m19:56:46.749856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_companyfacts, now model.sec_edgar.dim_company)
[0m19:56:46.750122 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.dim_company
[0m19:56:46.752404 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.dim_company"
[0m19:56:46.753579 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_company (compile): 19:56:46.750295 => 19:56:46.753382
[0m19:56:46.754169 [debug] [Thread-1 (]: Began executing node model.sec_edgar.dim_company
[0m19:56:46.756266 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.dim_company"
[0m19:56:46.756948 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:46.844726 [debug] [Thread-1 (]: On model.sec_edgar.dim_company: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_company"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  OPTIONS()
  as select
  cik,
  any_value(company_name) as company_name,
  array_agg(distinct ticker IGNORE NULLS)[offset(0)] as ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
group by cik;


[0m19:56:46.935848 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (execute): 19:56:44.883283 => 19:56:46.935557
[0m19:56:46.936683 [info ] [Thread-2 (]: 4 of 14 PASS not_null_stg_companyfacts_concept ................................. [[32mPASS[0m in 2.07s]
[0m19:56:46.937121 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m19:56:46.937555 [debug] [Thread-4 (]: Began running node model.sec_edgar.int_companyfacts_normalized
[0m19:56:46.937900 [info ] [Thread-4 (]: 7 of 14 START sql view model sec_curated_sec_curated.int_companyfacts_normalized  [RUN]
[0m19:56:46.938391 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d, now model.sec_edgar.int_companyfacts_normalized)
[0m19:56:46.938672 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.int_companyfacts_normalized
[0m19:56:46.943262 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.int_companyfacts_normalized"
[0m19:56:46.944015 [debug] [Thread-4 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (compile): 19:56:46.938841 => 19:56:46.943864
[0m19:56:46.944279 [debug] [Thread-4 (]: Began executing node model.sec_edgar.int_companyfacts_normalized
[0m19:56:46.946379 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.int_companyfacts_normalized"
[0m19:56:46.946892 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:56:47.031963 [debug] [Thread-4 (]: On model.sec_edgar.int_companyfacts_normalized: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.int_companyfacts_normalized"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
  OPTIONS()
  as with ranked as (
  select
    cik, ticker, concept, unit, period_end_date, value, accn, filed, fy, fp, form,
    row_number() over (
      partition by cik, concept, period_end_date
      order by case
        when unit in ('USD','usd') then 1
        when unit like '%USD%' then 2
        else 3
      end, filed desc
    ) as rn
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
)
select * except(rn) from ranked where rn = 1;


[0m19:56:47.715552 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:96c09c13-fb55-46e2-ab1b-36f6d0007a48&page=queryresults
[0m19:56:47.808376 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3f043859-751f-4c58-abb6-315edbc8a9ea&page=queryresults
[0m19:56:48.042208 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_company (execute): 19:56:46.754344 => 19:56:48.041991
[0m19:56:48.043047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1672ceb10>]}
[0m19:56:48.043880 [info ] [Thread-1 (]: 6 of 14 OK created sql view model sec_curated_sec_curated.dim_company .......... [[32mCREATE VIEW (0 processed)[0m in 1.29s]
[0m19:56:48.044327 [debug] [Thread-1 (]: Finished running node model.sec_edgar.dim_company
[0m19:56:48.045003 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m19:56:48.045360 [debug] [Thread-3 (]: Began running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m19:56:48.045628 [info ] [Thread-2 (]: 8 of 14 START test not_null_dim_company_cik .................................... [RUN]
[0m19:56:48.045928 [info ] [Thread-3 (]: 9 of 14 START test unique_dim_company_cik ...................................... [RUN]
[0m19:56:48.046487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5, now test.sec_edgar.not_null_dim_company_cik.2b3d612d15)
[0m19:56:48.047027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee, now test.sec_edgar.unique_dim_company_cik.ab80a865e2)
[0m19:56:48.047336 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m19:56:48.047597 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m19:56:48.051429 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m19:56:48.055915 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m19:56:48.057063 [debug] [Thread-3 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (compile): 19:56:48.051756 => 19:56:48.056716
[0m19:56:48.057642 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (compile): 19:56:48.047771 => 19:56:48.057394
[0m19:56:48.058155 [debug] [Thread-3 (]: Began executing node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m19:56:48.058647 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m19:56:48.061156 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m19:56:48.063552 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m19:56:48.064388 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:56:48.064921 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:56:48.151004 [debug] [Thread-3 (]: On test.sec_edgar.unique_dim_company_cik.ab80a865e2: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.unique_dim_company_cik.ab80a865e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select cik as unique_field
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  where cik is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:56:48.236964 [debug] [Thread-2 (]: On test.sec_edgar.not_null_dim_company_cik.2b3d612d15: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
where cik is null



      
    ) dbt_internal_test
[0m19:56:48.415408 [debug] [Thread-4 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (execute): 19:56:46.944435 => 19:56:48.415194
[0m19:56:48.416193 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167222ff0>]}
[0m19:56:48.416695 [info ] [Thread-4 (]: 7 of 14 OK created sql view model sec_curated_sec_curated.int_companyfacts_normalized  [[32mCREATE VIEW (0 processed)[0m in 1.48s]
[0m19:56:48.417115 [debug] [Thread-4 (]: Finished running node model.sec_edgar.int_companyfacts_normalized
[0m19:56:48.417499 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m19:56:48.417773 [info ] [Thread-1 (]: 10 of 14 START test not_null_int_companyfacts_normalized_period_end_date ....... [RUN]
[0m19:56:48.418229 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.dim_company, now test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd)
[0m19:56:48.418482 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m19:56:48.421620 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m19:56:48.422367 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (compile): 19:56:48.418637 => 19:56:48.422218
[0m19:56:48.422637 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m19:56:48.424291 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m19:56:48.424795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:56:48.511407 [debug] [Thread-1 (]: On test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
where period_end_date is null



      
    ) dbt_internal_test
[0m19:56:49.369080 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:5bd88e2a-0676-4442-934d-89dd921c46b7&page=queryresults
[0m19:56:49.370320 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:9fc55554-879a-4702-a155-0d981fc5f572&page=queryresults
[0m19:56:49.646515 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:a2364c1a-deab-48ec-9571-727760972434&page=queryresults
[0m19:56:50.007916 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (execute): 19:56:48.061411 => 19:56:50.007200
[0m19:56:50.009129 [info ] [Thread-2 (]: 8 of 14 PASS not_null_dim_company_cik .......................................... [[32mPASS[0m in 1.96s]
[0m19:56:50.009626 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m19:56:50.013800 [debug] [Thread-3 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (execute): 19:56:48.058970 => 19:56:50.013568
[0m19:56:50.014507 [info ] [Thread-3 (]: 9 of 14 PASS unique_dim_company_cik ............................................ [[32mPASS[0m in 1.97s]
[0m19:56:50.014936 [debug] [Thread-3 (]: Finished running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m19:56:50.312168 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (execute): 19:56:48.422796 => 19:56:50.310813
[0m19:56:50.313968 [info ] [Thread-1 (]: 10 of 14 PASS not_null_int_companyfacts_normalized_period_end_date ............. [[32mPASS[0m in 1.90s]
[0m19:56:50.315057 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m19:56:50.315892 [debug] [Thread-4 (]: Began running node model.sec_edgar.dim_concept
[0m19:56:50.316753 [debug] [Thread-2 (]: Began running node model.sec_edgar.fct_financials_quarterly
[0m19:56:50.317736 [info ] [Thread-4 (]: 11 of 14 START sql view model sec_curated_sec_curated.dim_concept .............. [RUN]
[0m19:56:50.318589 [info ] [Thread-2 (]: 12 of 14 START sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [RUN]
[0m19:56:50.319231 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sec_edgar.int_companyfacts_normalized, now model.sec_edgar.dim_concept)
[0m19:56:50.319741 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_dim_company_cik.2b3d612d15, now model.sec_edgar.fct_financials_quarterly)
[0m19:56:50.320035 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.dim_concept
[0m19:56:50.320354 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.fct_financials_quarterly
[0m19:56:50.323403 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.dim_concept"
[0m19:56:50.327219 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_concept (compile): 19:56:50.320531 => 19:56:50.326871
[0m19:56:50.329787 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.fct_financials_quarterly"
[0m19:56:50.330139 [debug] [Thread-4 (]: Began executing node model.sec_edgar.dim_concept
[0m19:56:50.332469 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.dim_concept"
[0m19:56:50.333053 [debug] [Thread-2 (]: Timing info for model.sec_edgar.fct_financials_quarterly (compile): 19:56:50.323634 => 19:56:50.332871
[0m19:56:50.333381 [debug] [Thread-2 (]: Began executing node model.sec_edgar.fct_financials_quarterly
[0m19:56:50.339261 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:56:50.462305 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.fct_financials_quarterly"
[0m19:56:50.462805 [debug] [Thread-4 (]: On model.sec_edgar.dim_concept: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_concept"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_concept`
  OPTIONS()
  as select concept,
  case concept
    when 'us-gaap:Revenues' then 'Revenue'
    when 'us-gaap:SalesRevenueNet' then 'Revenue'
    when 'us-gaap:CostOfRevenue' then 'Cost of Revenue'
    when 'us-gaap:GrossProfit' then 'Gross Profit'
    when 'us-gaap:NetIncomeLoss' then 'Net Income'
    when 'us-gaap:EarningsPerShareDiluted' then 'EPS (Diluted)'
    else concept
  end as concept_label
from (select distinct concept from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`);


[0m19:56:50.466717 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:56:50.556611 [debug] [Thread-2 (]: On model.sec_edgar.fct_financials_quarterly: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.fct_financials_quarterly"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
      
    partition by period_end_date
    cluster by cik, concept

    OPTIONS()
    as (
      
with base as (
  select
    n.cik, n.ticker, n.concept, n.unit,
    n.period_end_date, n.value, n.accn, n.filed, n.fy, n.fp, n.form
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized` n
  where n.fp in ('Q1','Q2','Q3','Q4') or n.form in ('10-Q','10-K')
)
select * from base

    );
  
[0m19:56:51.450660 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:73b12a43-99f4-431b-8c77-69f357243cbe&page=queryresults
[0m19:56:51.832379 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:bf44b91c-15cb-4889-9086-4c140d3da478&page=queryresults
[0m19:56:52.041537 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_concept (execute): 19:56:50.330492 => 19:56:52.041067
[0m19:56:52.043639 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167246fc0>]}
[0m19:56:52.044985 [info ] [Thread-4 (]: 11 of 14 OK created sql view model sec_curated_sec_curated.dim_concept ......... [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m19:56:52.045463 [debug] [Thread-4 (]: Finished running node model.sec_edgar.dim_concept
[0m19:57:07.432711 [debug] [Thread-2 (]: Timing info for model.sec_edgar.fct_financials_quarterly (execute): 19:56:50.333564 => 19:57:07.432373
[0m19:57:07.434088 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea10d1a2-97bc-409a-9087-a82c3902a179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1672e8da0>]}
[0m19:57:07.434833 [info ] [Thread-2 (]: 12 of 14 OK created sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [[32mCREATE TABLE (1.2k rows, 557.9 KiB processed)[0m in 17.11s]
[0m19:57:07.435329 [debug] [Thread-2 (]: Finished running node model.sec_edgar.fct_financials_quarterly
[0m19:57:07.436854 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m19:57:07.437577 [debug] [Thread-3 (]: Began running node test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43
[0m19:57:07.438211 [info ] [Thread-1 (]: 13 of 14 START test not_null_fct_financials_quarterly_period_end_date .......... [RUN]
[0m19:57:07.438848 [info ] [Thread-3 (]: 14 of 14 START test relationships_fct_financials_quarterly_cik__ref_dim_company_  [RUN]
[0m19:57:07.439799 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd, now test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01)
[0m19:57:07.440616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.unique_dim_company_cik.ab80a865e2, now test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43)
[0m19:57:07.441096 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m19:57:07.441522 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43
[0m19:57:07.448067 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m19:57:07.452916 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43"
[0m19:57:07.453805 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (compile): 19:57:07.441807 => 19:57:07.453601
[0m19:57:07.454132 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m19:57:07.456029 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m19:57:07.456534 [debug] [Thread-3 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43 (compile): 19:57:07.448557 => 19:57:07.456278
[0m19:57:07.456963 [debug] [Thread-3 (]: Began executing node test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43
[0m19:57:07.458986 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43"
[0m19:57:07.459464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:07.459887 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:57:07.630621 [debug] [Thread-1 (]: On test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
where period_end_date is null



      
    ) dbt_internal_test
[0m19:57:07.631147 [debug] [Thread-3 (]: On test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select  as from_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
    where  is not null
),

parent as (
    select cik as to_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:57:08.955706 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:ca8d5923-1ba2-461f-a2b1-83cff529d159&page=queryresults
[0m19:57:09.528834 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:79631202-ac14-47b8-ab54-8a46d99f23d4&page=queryresults
[0m19:57:09.530335 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: SELECT list must not be empty at [13:5]; reason: invalidQuery, location: query, message: Syntax error: SELECT list must not be empty at [13:5]')
[0m19:57:09.543952 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (execute): 19:57:07.454302 => 19:57:09.543343
[0m19:57:09.545861 [info ] [Thread-1 (]: 13 of 14 PASS not_null_fct_financials_quarterly_period_end_date ................ [[32mPASS[0m in 2.11s]
[0m19:57:09.546432 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m19:57:09.796359 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3d243ba2-a492-4f23-ba28-6518e520c968&page=queryresults
[0m19:57:09.798191 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3d243ba2-a492-4f23-ba28-6518e520c968&page=queryresults
[0m19:57:09.798987 [debug] [Thread-3 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43 (execute): 19:57:07.457177 => 19:57:09.798785
[0m19:57:09.933664 [debug] [Thread-3 (]: Database Error in test relationships_fct_financials_quarterly_cik__ref_dim_company_ (models/marts/marts.yml)
  Syntax error: SELECT list must not be empty at [13:5]
  compiled Code at target/run/sec_edgar/models/marts/marts.yml/relationships_fct_financials_quarterly_cik__ref_dim_company_.sql
[0m19:57:09.935106 [error] [Thread-3 (]: 14 of 14 ERROR relationships_fct_financials_quarterly_cik__ref_dim_company_ .... [[31mERROR[0m in 2.49s]
[0m19:57:09.936159 [debug] [Thread-3 (]: Finished running node test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43
[0m19:57:09.940161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:09.940769 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01' was properly closed.
[0m19:57:09.941192 [debug] [MainThread]: Connection 'model.sec_edgar.fct_financials_quarterly' was properly closed.
[0m19:57:09.941578 [debug] [MainThread]: Connection 'model.sec_edgar.dim_concept' was properly closed.
[0m19:57:09.941961 [debug] [MainThread]: Connection 'test.sec_edgar.relationships_fct_financials_quarterly_cik__ref_dim_company_.2d98e97a43' was properly closed.
[0m19:57:09.942472 [info ] [MainThread]: 
[0m19:57:09.942975 [info ] [MainThread]: Finished running 5 view models, 8 tests, 1 incremental model in 0 hours 0 minutes and 30.00 seconds (30.00s).
[0m19:57:09.945502 [debug] [MainThread]: Command end result
[0m19:57:09.967230 [info ] [MainThread]: 
[0m19:57:09.967798 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:57:09.968115 [info ] [MainThread]: 
[0m19:57:09.968434 [error] [MainThread]:   Database Error in test relationships_fct_financials_quarterly_cik__ref_dim_company_ (models/marts/marts.yml)
  Syntax error: SELECT list must not be empty at [13:5]
  compiled Code at target/run/sec_edgar/models/marts/marts.yml/relationships_fct_financials_quarterly_cik__ref_dim_company_.sql
[0m19:57:09.968747 [info ] [MainThread]: 
[0m19:57:09.969065 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m19:57:09.970150 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 34.226006, "process_user_time": 6.91415, "process_kernel_time": 2.159758, "process_mem_max_rss": "258834432", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:57:09.970872 [debug] [MainThread]: Command `dbt build` failed at 19:57:09.970739 after 34.23 seconds
[0m19:57:09.971744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112088110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1669d3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11252f5f0>]}
[0m19:57:09.972265 [debug] [MainThread]: Flushing usage events
[0m19:57:28.759955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d55580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d55220>]}


============================== 19:57:28.763830 | 72e17e90-6c2b-4fc4-81bb-c077af2914b2 ==============================
[0m19:57:28.763830 [info ] [MainThread]: Running with dbt=1.7.15
[0m19:57:28.764300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'profiles_dir': './dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:57:31.335133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c577920>]}
[0m19:57:31.370277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c574950>]}
[0m19:57:31.374076 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m19:57:31.391446 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m19:57:31.539546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:57:31.540175 [debug] [MainThread]: Partial parsing: updated file: sec_edgar://models/marts/marts.yml
[0m19:57:31.729285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d03bce0>]}
[0m19:57:31.738629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c6783b0>]}
[0m19:57:31.739057 [info ] [MainThread]: Found 6 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m19:57:31.740656 [info ] [MainThread]: 
[0m19:57:31.741330 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:57:31.742345 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m19:57:31.742688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:31.743152 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m19:57:31.743555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:57:32.449981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_raw)
[0m19:57:32.450454 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:32.451090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_curated)
[0m19:57:32.451426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:57:33.140223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d0dd040>]}
[0m19:57:33.141432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:57:33.141889 [info ] [MainThread]: 
[0m19:57:33.146111 [debug] [Thread-1 (]: Began running node model.sec_edgar.stg_companyfacts
[0m19:57:33.146648 [debug] [Thread-2 (]: Began running node model.sec_edgar.stg_submissions
[0m19:57:33.147291 [info ] [Thread-1 (]: 1 of 14 START sql view model sec_curated_sec_raw.stg_companyfacts .............. [RUN]
[0m19:57:33.147721 [info ] [Thread-2 (]: 2 of 14 START sql view model sec_curated_sec_raw.stg_submissions ............... [RUN]
[0m19:57:33.148537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_raw, now model.sec_edgar.stg_companyfacts)
[0m19:57:33.149305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_curated, now model.sec_edgar.stg_submissions)
[0m19:57:33.149806 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.stg_companyfacts
[0m19:57:33.150107 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.stg_submissions
[0m19:57:33.155966 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.stg_companyfacts"
[0m19:57:33.157979 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.stg_submissions"
[0m19:57:33.167629 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (compile): 19:57:33.150339 => 19:57:33.167456
[0m19:57:33.167991 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (compile): 19:57:33.156208 => 19:57:33.167806
[0m19:57:33.168271 [debug] [Thread-1 (]: Began executing node model.sec_edgar.stg_companyfacts
[0m19:57:33.168561 [debug] [Thread-2 (]: Began executing node model.sec_edgar.stg_submissions
[0m19:57:33.195364 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.stg_submissions"
[0m19:57:33.196372 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.stg_companyfacts"
[0m19:57:33.197372 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:33.197808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:33.367176 [debug] [Thread-2 (]: On model.sec_edgar.stg_submissions: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_submissions"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    company_name,
    accession_no,
    form,
    SAFE_CAST(filed as date) as filed,
    SAFE_CAST(report_period as date) as report_period
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_submissions`
)
select * from src;


[0m19:57:33.367654 [debug] [Thread-1 (]: On model.sec_edgar.stg_companyfacts: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_companyfacts"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    concept,
    unit,
    SAFE_CAST(period_end_date as date) as period_end_date,
    SAFE_CAST(val as float64) as value,
    accn, fy, fp, form,
    SAFE_CAST(filed as date) as filed
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_companyfacts`
)
select * from src;


[0m19:57:34.016333 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:52145c1a-be17-41fb-947f-e2d26cc24406&page=queryresults
[0m19:57:34.161260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:7c059771-55a0-4252-a9a7-c0a73fc48c86&page=queryresults
[0m19:57:34.399618 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (execute): 19:57:33.180422 => 19:57:34.399450
[0m19:57:34.400259 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d0bc1d0>]}
[0m19:57:34.400748 [info ] [Thread-2 (]: 2 of 14 OK created sql view model sec_curated_sec_raw.stg_submissions .......... [[32mCREATE VIEW (0 processed)[0m in 1.25s]
[0m19:57:34.401232 [debug] [Thread-2 (]: Finished running node model.sec_edgar.stg_submissions
[0m19:57:34.401677 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m19:57:34.401963 [info ] [Thread-4 (]: 3 of 14 START test not_null_stg_submissions_accession_no ....................... [RUN]
[0m19:57:34.402468 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d'
[0m19:57:34.402716 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m19:57:34.408428 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m19:57:34.415795 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (compile): 19:57:34.402870 => 19:57:34.415635
[0m19:57:34.416075 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m19:57:34.425245 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m19:57:34.425815 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:57:34.511065 [debug] [Thread-4 (]: On test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select accession_no
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
where accession_no is null



      
    ) dbt_internal_test
[0m19:57:34.647726 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (execute): 19:57:33.168736 => 19:57:34.647498
[0m19:57:34.648578 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d1a6330>]}
[0m19:57:34.649120 [info ] [Thread-1 (]: 1 of 14 OK created sql view model sec_curated_sec_raw.stg_companyfacts ......... [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m19:57:34.649616 [debug] [Thread-1 (]: Finished running node model.sec_edgar.stg_companyfacts
[0m19:57:34.650246 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m19:57:34.650726 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m19:57:34.651151 [info ] [Thread-2 (]: 4 of 14 START test not_null_stg_companyfacts_concept ........................... [RUN]
[0m19:57:34.651546 [info ] [Thread-3 (]: 5 of 14 START test not_null_stg_companyfacts_period_end_date ................... [RUN]
[0m19:57:34.652233 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_submissions, now test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5)
[0m19:57:34.652928 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee'
[0m19:57:34.653355 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m19:57:34.653825 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m19:57:34.658136 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m19:57:34.661552 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m19:57:34.662382 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (compile): 19:57:34.654081 => 19:57:34.662154
[0m19:57:34.662797 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m19:57:34.664705 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m19:57:34.665202 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (compile): 19:57:34.658471 => 19:57:34.665009
[0m19:57:34.665703 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m19:57:34.667672 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m19:57:34.668037 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:34.752979 [debug] [Thread-2 (]: On test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select concept
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where concept is null



      
    ) dbt_internal_test
[0m19:57:34.757232 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:57:34.846820 [debug] [Thread-3 (]: On test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where period_end_date is null



      
    ) dbt_internal_test
[0m19:57:35.514677 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:f176a835-5c2b-462b-b985-f22997b2cd51&page=queryresults
[0m19:57:35.755425 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:8b22bd46-17bd-4303-aa97-06acc1437c17&page=queryresults
[0m19:57:35.910967 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:2810fd12-74f1-4218-8b77-9cf0df32f641&page=queryresults
[0m19:57:36.247817 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (execute): 19:57:34.416245 => 19:57:36.246500
[0m19:57:36.249782 [info ] [Thread-4 (]: 3 of 14 PASS not_null_stg_submissions_accession_no ............................. [[32mPASS[0m in 1.85s]
[0m19:57:36.250819 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m19:57:36.251881 [debug] [Thread-1 (]: Began running node model.sec_edgar.dim_company
[0m19:57:36.252683 [info ] [Thread-1 (]: 6 of 14 START sql view model sec_curated_sec_curated.dim_company ............... [RUN]
[0m19:57:36.253691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_companyfacts, now model.sec_edgar.dim_company)
[0m19:57:36.254191 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.dim_company
[0m19:57:36.258669 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.dim_company"
[0m19:57:36.260681 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_company (compile): 19:57:36.254507 => 19:57:36.260355
[0m19:57:36.261097 [debug] [Thread-1 (]: Began executing node model.sec_edgar.dim_company
[0m19:57:36.264885 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.dim_company"
[0m19:57:36.265881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:36.354818 [debug] [Thread-1 (]: On model.sec_edgar.dim_company: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_company"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  OPTIONS()
  as select
  cik,
  any_value(company_name) as company_name,
  array_agg(distinct ticker IGNORE NULLS)[offset(0)] as ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
group by cik;


[0m19:57:36.524111 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (execute): 19:57:34.665977 => 19:57:36.523879
[0m19:57:36.524839 [info ] [Thread-3 (]: 5 of 14 PASS not_null_stg_companyfacts_period_end_date ......................... [[32mPASS[0m in 1.87s]
[0m19:57:36.525250 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m19:57:36.726286 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (execute): 19:57:34.663050 => 19:57:36.726039
[0m19:57:36.737142 [info ] [Thread-2 (]: 4 of 14 PASS not_null_stg_companyfacts_concept ................................. [[32mPASS[0m in 2.08s]
[0m19:57:36.739022 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m19:57:36.739948 [debug] [Thread-4 (]: Began running node model.sec_edgar.int_companyfacts_normalized
[0m19:57:36.740493 [info ] [Thread-4 (]: 7 of 14 START sql view model sec_curated_sec_curated.int_companyfacts_normalized  [RUN]
[0m19:57:36.742021 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d, now model.sec_edgar.int_companyfacts_normalized)
[0m19:57:36.742413 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.int_companyfacts_normalized
[0m19:57:36.745080 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.int_companyfacts_normalized"
[0m19:57:36.826160 [debug] [Thread-4 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (compile): 19:57:36.742634 => 19:57:36.825155
[0m19:57:36.827438 [debug] [Thread-4 (]: Began executing node model.sec_edgar.int_companyfacts_normalized
[0m19:57:36.835603 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.int_companyfacts_normalized"
[0m19:57:36.837033 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:57:36.928612 [debug] [Thread-4 (]: On model.sec_edgar.int_companyfacts_normalized: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.int_companyfacts_normalized"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
  OPTIONS()
  as with ranked as (
  select
    cik, ticker, concept, unit, period_end_date, value, accn, filed, fy, fp, form,
    row_number() over (
      partition by cik, concept, period_end_date
      order by case
        when unit in ('USD','usd') then 1
        when unit like '%USD%' then 2
        else 3
      end, filed desc
    ) as rn
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
)
select * except(rn) from ranked where rn = 1;


[0m19:57:37.518991 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:f7503bc3-73e6-46cd-a589-b870653bad5c&page=queryresults
[0m19:57:37.882956 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_company (execute): 19:57:36.261283 => 19:57:37.882781
[0m19:57:37.883930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d4a3710>]}
[0m19:57:37.884746 [info ] [Thread-1 (]: 6 of 14 OK created sql view model sec_curated_sec_curated.dim_company .......... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m19:57:37.885248 [debug] [Thread-1 (]: Finished running node model.sec_edgar.dim_company
[0m19:57:37.885787 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m19:57:37.886235 [debug] [Thread-3 (]: Began running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m19:57:37.886724 [info ] [Thread-2 (]: 8 of 14 START test not_null_dim_company_cik .................................... [RUN]
[0m19:57:37.887109 [info ] [Thread-3 (]: 9 of 14 START test unique_dim_company_cik ...................................... [RUN]
[0m19:57:37.887732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5, now test.sec_edgar.not_null_dim_company_cik.2b3d612d15)
[0m19:57:37.888359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee, now test.sec_edgar.unique_dim_company_cik.ab80a865e2)
[0m19:57:37.888835 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m19:57:37.889296 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m19:57:37.893019 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m19:57:37.898187 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m19:57:37.899346 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (compile): 19:57:37.889537 => 19:57:37.899148
[0m19:57:37.899732 [debug] [Thread-3 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (compile): 19:57:37.893364 => 19:57:37.899550
[0m19:57:37.900015 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m19:57:37.900294 [debug] [Thread-3 (]: Began executing node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m19:57:37.902873 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m19:57:37.905155 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m19:57:37.906309 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:57:37.906712 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:37.996256 [debug] [Thread-3 (]: On test.sec_edgar.unique_dim_company_cik.ab80a865e2: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.unique_dim_company_cik.ab80a865e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select cik as unique_field
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  where cik is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m19:57:38.085378 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:ffa28846-b2c7-4c01-be18-4baa535fa440&page=queryresults
[0m19:57:38.086113 [debug] [Thread-2 (]: On test.sec_edgar.not_null_dim_company_cik.2b3d612d15: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
where cik is null



      
    ) dbt_internal_test
[0m19:57:38.393420 [debug] [Thread-4 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (execute): 19:57:36.828174 => 19:57:38.392988
[0m19:57:38.395041 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d47b050>]}
[0m19:57:38.396086 [info ] [Thread-4 (]: 7 of 14 OK created sql view model sec_curated_sec_curated.int_companyfacts_normalized  [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m19:57:38.396985 [debug] [Thread-4 (]: Finished running node model.sec_edgar.int_companyfacts_normalized
[0m19:57:38.397717 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m19:57:38.398036 [info ] [Thread-1 (]: 10 of 14 START test not_null_int_companyfacts_normalized_period_end_date ....... [RUN]
[0m19:57:38.399011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.dim_company, now test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd)
[0m19:57:38.399704 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m19:57:38.405958 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m19:57:38.407876 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (compile): 19:57:38.400042 => 19:57:38.407528
[0m19:57:38.408419 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m19:57:38.411289 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m19:57:38.413546 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:38.502862 [debug] [Thread-1 (]: On test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
where period_end_date is null



      
    ) dbt_internal_test
[0m19:57:39.095316 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:0e01e7d6-d85e-40cc-8d0d-482b9c82f341&page=queryresults
[0m19:57:39.239552 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:29d1ea19-f542-4c45-b183-11ead324aaa3&page=queryresults
[0m19:57:39.670610 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (execute): 19:57:37.900541 => 19:57:39.669276
[0m19:57:39.672298 [info ] [Thread-2 (]: 8 of 14 PASS not_null_dim_company_cik .......................................... [[32mPASS[0m in 1.78s]
[0m19:57:39.672827 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m19:57:39.805366 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:8d74d2f5-b8ba-4d3b-98e2-6d2b5aa3bc7c&page=queryresults
[0m19:57:39.932205 [debug] [Thread-3 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (execute): 19:57:37.903191 => 19:57:39.931838
[0m19:57:39.933166 [info ] [Thread-3 (]: 9 of 14 PASS unique_dim_company_cik ............................................ [[32mPASS[0m in 2.04s]
[0m19:57:39.933616 [debug] [Thread-3 (]: Finished running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m19:57:40.394184 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (execute): 19:57:38.408695 => 19:57:40.393208
[0m19:57:40.396860 [info ] [Thread-1 (]: 10 of 14 PASS not_null_int_companyfacts_normalized_period_end_date ............. [[32mPASS[0m in 2.00s]
[0m19:57:40.397413 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m19:57:40.398247 [debug] [Thread-4 (]: Began running node model.sec_edgar.dim_concept
[0m19:57:40.398600 [debug] [Thread-2 (]: Began running node model.sec_edgar.fct_financials_quarterly
[0m19:57:40.398956 [info ] [Thread-4 (]: 11 of 14 START sql view model sec_curated_sec_curated.dim_concept .............. [RUN]
[0m19:57:40.399371 [info ] [Thread-2 (]: 12 of 14 START sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [RUN]
[0m19:57:40.399945 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sec_edgar.int_companyfacts_normalized, now model.sec_edgar.dim_concept)
[0m19:57:40.400430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_dim_company_cik.2b3d612d15, now model.sec_edgar.fct_financials_quarterly)
[0m19:57:40.400718 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.dim_concept
[0m19:57:40.400983 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.fct_financials_quarterly
[0m19:57:40.403616 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.dim_concept"
[0m19:57:40.407436 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.fct_financials_quarterly"
[0m19:57:40.408730 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_concept (compile): 19:57:40.401158 => 19:57:40.408583
[0m19:57:40.409048 [debug] [Thread-2 (]: Timing info for model.sec_edgar.fct_financials_quarterly (compile): 19:57:40.403825 => 19:57:40.408895
[0m19:57:40.409299 [debug] [Thread-4 (]: Began executing node model.sec_edgar.dim_concept
[0m19:57:40.409564 [debug] [Thread-2 (]: Began executing node model.sec_edgar.fct_financials_quarterly
[0m19:57:40.437922 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m19:57:40.440006 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.dim_concept"
[0m19:57:40.528008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m19:57:40.613067 [debug] [Thread-4 (]: On model.sec_edgar.dim_concept: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_concept"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_concept`
  OPTIONS()
  as select concept,
  case concept
    when 'us-gaap:Revenues' then 'Revenue'
    when 'us-gaap:SalesRevenueNet' then 'Revenue'
    when 'us-gaap:CostOfRevenue' then 'Cost of Revenue'
    when 'us-gaap:GrossProfit' then 'Gross Profit'
    when 'us-gaap:NetIncomeLoss' then 'Net Income'
    when 'us-gaap:EarningsPerShareDiluted' then 'EPS (Diluted)'
    else concept
  end as concept_label
from (select distinct concept from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`);


[0m19:57:41.054323 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.fct_financials_quarterly"
[0m19:57:41.055606 [debug] [Thread-2 (]: On model.sec_edgar.fct_financials_quarterly: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.fct_financials_quarterly"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly` as DBT_INTERNAL_DEST
        using (
with base as (
  select
    n.cik, n.ticker, n.concept, n.unit,
    n.period_end_date, n.value, n.accn, n.filed, n.fy, n.fp, n.form
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized` n
  where n.fp in ('Q1','Q2','Q3','Q4') or n.form in ('10-Q','10-K')
)
select * from base

where period_end_date > (select ifnull(max(period_end_date), date('2000-01-01')) from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`cik`, `ticker`, `concept`, `unit`, `period_end_date`, `value`, `accn`, `filed`, `fy`, `fp`, `form`)
    values
        (`cik`, `ticker`, `concept`, `unit`, `period_end_date`, `value`, `accn`, `filed`, `fy`, `fp`, `form`)


    
[0m19:57:41.611995 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:e87032da-5a6e-4539-8522-07e563133ae8&page=queryresults
[0m19:57:41.671115 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:6448c181-ce11-4fd8-905f-13a5db322bab&page=queryresults
[0m19:57:41.959043 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_concept (execute): 19:57:40.409727 => 19:57:41.958865
[0m19:57:41.959694 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d4d8fb0>]}
[0m19:57:41.960103 [info ] [Thread-4 (]: 11 of 14 OK created sql view model sec_curated_sec_curated.dim_concept ......... [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m19:57:41.960503 [debug] [Thread-4 (]: Finished running node model.sec_edgar.dim_concept
[0m19:57:45.626026 [debug] [Thread-2 (]: Timing info for model.sec_edgar.fct_financials_quarterly (execute): 19:57:40.411520 => 19:57:45.625803
[0m19:57:45.626944 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72e17e90-6c2b-4fc4-81bb-c077af2914b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d4d9d90>]}
[0m19:57:45.627478 [info ] [Thread-2 (]: 12 of 14 OK created sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [[32mMERGE (0.0 rows, 567.2 KiB processed)[0m in 5.23s]
[0m19:57:45.628719 [debug] [Thread-2 (]: Finished running node model.sec_edgar.fct_financials_quarterly
[0m19:57:45.629925 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m19:57:45.630545 [debug] [Thread-3 (]: Began running node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m19:57:45.631215 [info ] [Thread-1 (]: 13 of 14 START test not_null_fct_financials_quarterly_period_end_date .......... [RUN]
[0m19:57:45.631652 [info ] [Thread-3 (]: 14 of 14 START test relationships_fct_financials_quarterly_cik__cik__ref_dim_company_  [RUN]
[0m19:57:45.632272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd, now test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01)
[0m19:57:45.632780 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.unique_dim_company_cik.ab80a865e2, now test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e)
[0m19:57:45.633095 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m19:57:45.633380 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m19:57:45.636977 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m19:57:45.640436 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"
[0m19:57:45.641251 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (compile): 19:57:45.633586 => 19:57:45.641091
[0m19:57:45.641559 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m19:57:45.642041 [debug] [Thread-3 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e (compile): 19:57:45.637227 => 19:57:45.641734
[0m19:57:45.644568 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m19:57:45.644991 [debug] [Thread-3 (]: Began executing node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m19:57:45.647159 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"
[0m19:57:45.647715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:57:45.732490 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:57:45.733110 [debug] [Thread-1 (]: On test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
where period_end_date is null



      
    ) dbt_internal_test
[0m19:57:45.821216 [debug] [Thread-3 (]: On test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cik as from_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
    where cik is not null
),

parent as (
    select cik as to_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:57:46.655038 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:0edf89ab-e333-49ad-8e3a-0680c2f7baf3&page=queryresults
[0m19:57:47.199401 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (execute): 19:57:45.642309 => 19:57:47.198784
[0m19:57:47.201283 [info ] [Thread-1 (]: 13 of 14 PASS not_null_fct_financials_quarterly_period_end_date ................ [[32mPASS[0m in 1.57s]
[0m19:57:47.202317 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m19:57:47.623976 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:03a29085-1098-4bbf-879e-a1b8c4e29e69&page=queryresults
[0m19:57:48.183124 [debug] [Thread-3 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e (execute): 19:57:45.645278 => 19:57:48.182307
[0m19:57:48.184669 [info ] [Thread-3 (]: 14 of 14 PASS relationships_fct_financials_quarterly_cik__cik__ref_dim_company_  [[32mPASS[0m in 2.55s]
[0m19:57:48.185259 [debug] [Thread-3 (]: Finished running node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m19:57:48.187296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:57:48.187836 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01' was properly closed.
[0m19:57:48.188384 [debug] [MainThread]: Connection 'model.sec_edgar.fct_financials_quarterly' was properly closed.
[0m19:57:48.188872 [debug] [MainThread]: Connection 'model.sec_edgar.dim_concept' was properly closed.
[0m19:57:48.189346 [debug] [MainThread]: Connection 'test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e' was properly closed.
[0m19:57:48.189934 [info ] [MainThread]: 
[0m19:57:48.190453 [info ] [MainThread]: Finished running 5 view models, 8 tests, 1 incremental model in 0 hours 0 minutes and 16.45 seconds (16.45s).
[0m19:57:48.193177 [debug] [MainThread]: Command end result
[0m19:57:48.206133 [info ] [MainThread]: 
[0m19:57:48.206659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:57:48.206937 [info ] [MainThread]: 
[0m19:57:48.207253 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m19:57:48.207762 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 19.494238, "process_user_time": 6.090899, "process_kernel_time": 1.883664, "process_mem_max_rss": "258441216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:57:48.208148 [debug] [MainThread]: Command `dbt build` succeeded at 19:57:48.208058 after 19.49 seconds
[0m19:57:48.208952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c01070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d10daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d45b170>]}
[0m19:57:48.209490 [debug] [MainThread]: Flushing usage events
[0m20:24:31.814230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11042e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110452240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110451ee0>]}


============================== 20:24:31.818672 | 11b0ad07-e898-49ea-9274-c101d3e805e4 ==============================
[0m20:24:31.818672 [info ] [MainThread]: Running with dbt=1.7.15
[0m20:24:31.819168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:24:33.209084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131055be0>]}
[0m20:24:33.244653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130ad3f20>]}
[0m20:24:33.245411 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m20:24:33.270842 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m20:24:33.303302 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:24:33.303708 [info ] [MainThread]: Unable to do partial parsing because env vars used in dbt_project.yml have changed
[0m20:24:33.304011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13138c620>]}
[0m20:24:34.204266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13146f2c0>]}
[0m20:24:34.216958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131496090>]}
[0m20:24:34.217421 [info ] [MainThread]: Found 6 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:24:34.218952 [info ] [MainThread]: 
[0m20:24:34.219574 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:24:34.220642 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m20:24:34.221298 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m20:24:34.221669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:34.221998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:24:35.036381 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_curated)
[0m20:24:35.037534 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_raw)
[0m20:24:35.038064 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:35.038338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:24:35.667415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13145a5a0>]}
[0m20:24:35.668480 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:24:35.668805 [info ] [MainThread]: 
[0m20:24:35.677576 [debug] [Thread-1 (]: Began running node model.sec_edgar.stg_companyfacts
[0m20:24:35.678201 [debug] [Thread-2 (]: Began running node model.sec_edgar.stg_submissions
[0m20:24:35.679010 [info ] [Thread-1 (]: 1 of 14 START sql view model sec_curated_sec_raw.stg_companyfacts .............. [RUN]
[0m20:24:35.679725 [info ] [Thread-2 (]: 2 of 14 START sql view model sec_curated_sec_raw.stg_submissions ............... [RUN]
[0m20:24:35.680655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_curated, now model.sec_edgar.stg_companyfacts)
[0m20:24:35.681328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_raw, now model.sec_edgar.stg_submissions)
[0m20:24:35.681738 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.stg_companyfacts
[0m20:24:35.682105 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.stg_submissions
[0m20:24:35.689899 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.stg_companyfacts"
[0m20:24:35.692166 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.stg_submissions"
[0m20:24:35.693775 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (compile): 20:24:35.682377 => 20:24:35.693592
[0m20:24:35.694147 [debug] [Thread-1 (]: Began executing node model.sec_edgar.stg_companyfacts
[0m20:24:35.706870 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (compile): 20:24:35.684996 => 20:24:35.706679
[0m20:24:35.715298 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.stg_companyfacts"
[0m20:24:35.715616 [debug] [Thread-2 (]: Began executing node model.sec_edgar.stg_submissions
[0m20:24:35.718108 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.stg_submissions"
[0m20:24:35.718755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:35.804022 [debug] [Thread-1 (]: On model.sec_edgar.stg_companyfacts: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_companyfacts"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    concept,
    unit,
    SAFE_CAST(period_end_date as date) as period_end_date,
    SAFE_CAST(val as float64) as value,
    accn, fy, fp, form,
    SAFE_CAST(filed as date) as filed
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_companyfacts`
)
select * from src;


[0m20:24:35.808061 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:24:35.894093 [debug] [Thread-2 (]: On model.sec_edgar.stg_submissions: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_submissions"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    company_name,
    accession_no,
    form,
    SAFE_CAST(filed as date) as filed,
    SAFE_CAST(report_period as date) as report_period
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_submissions`
)
select * from src;


[0m20:24:36.531938 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:2a0fedd0-e152-4b07-a839-66c3193c88af&page=queryresults
[0m20:24:36.631236 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:e3de31b6-35d4-4064-92bc-c630b7498d43&page=queryresults
[0m20:24:37.130101 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (execute): 20:24:35.715979 => 20:24:37.129923
[0m20:24:37.131196 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140877f80>]}
[0m20:24:37.131685 [info ] [Thread-2 (]: 2 of 14 OK created sql view model sec_curated_sec_raw.stg_submissions .......... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m20:24:37.132137 [debug] [Thread-2 (]: Finished running node model.sec_edgar.stg_submissions
[0m20:24:37.132594 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:24:37.132882 [info ] [Thread-4 (]: 3 of 14 START test not_null_stg_submissions_accession_no ....................... [RUN]
[0m20:24:37.133429 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d'
[0m20:24:37.133931 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:24:37.141142 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m20:24:37.144237 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (compile): 20:24:37.134139 => 20:24:37.143988
[0m20:24:37.144616 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:24:37.154383 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m20:24:37.155822 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:24:37.240963 [debug] [Thread-4 (]: On test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select accession_no
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
where accession_no is null



      
    ) dbt_internal_test
[0m20:24:37.402798 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (execute): 20:24:35.694339 => 20:24:37.402582
[0m20:24:37.403695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1408c6120>]}
[0m20:24:37.404233 [info ] [Thread-1 (]: 1 of 14 OK created sql view model sec_curated_sec_raw.stg_companyfacts ......... [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m20:24:37.405290 [debug] [Thread-1 (]: Finished running node model.sec_edgar.stg_companyfacts
[0m20:24:37.406047 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:24:37.406406 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:24:37.406766 [info ] [Thread-2 (]: 4 of 14 START test not_null_stg_companyfacts_concept ........................... [RUN]
[0m20:24:37.407593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_submissions, now test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5)
[0m20:24:37.407053 [info ] [Thread-3 (]: 5 of 14 START test not_null_stg_companyfacts_period_end_date ................... [RUN]
[0m20:24:37.407934 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:24:37.408480 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee'
[0m20:24:37.411844 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m20:24:37.412196 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:24:37.415102 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m20:24:37.416133 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (compile): 20:24:37.408675 => 20:24:37.415980
[0m20:24:37.416417 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:24:37.420004 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m20:24:37.420454 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (compile): 20:24:37.412456 => 20:24:37.420270
[0m20:24:37.420863 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:24:37.422779 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m20:24:37.423331 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:24:37.424026 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:24:37.508579 [debug] [Thread-2 (]: On test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select concept
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where concept is null



      
    ) dbt_internal_test
[0m20:24:37.597549 [debug] [Thread-3 (]: On test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where period_end_date is null



      
    ) dbt_internal_test
[0m20:24:38.270800 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:d1620c13-c9d1-4c4f-9da4-7f672a810134&page=queryresults
[0m20:24:38.587432 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:9a98944d-d8bd-4c6b-b373-10dea9ebdd0d&page=queryresults
[0m20:24:38.696521 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:5d8c1277-d052-43ec-930a-08dad5b1a500&page=queryresults
[0m20:24:38.858737 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (execute): 20:24:37.144800 => 20:24:38.858483
[0m20:24:38.859515 [info ] [Thread-4 (]: 3 of 14 PASS not_null_stg_submissions_accession_no ............................. [[32mPASS[0m in 1.73s]
[0m20:24:38.859953 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:24:38.860576 [debug] [Thread-1 (]: Began running node model.sec_edgar.dim_company
[0m20:24:38.861286 [info ] [Thread-1 (]: 6 of 14 START sql view model sec_curated_sec_curated.dim_company ............... [RUN]
[0m20:24:38.862154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_companyfacts, now model.sec_edgar.dim_company)
[0m20:24:38.862618 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.dim_company
[0m20:24:38.865787 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.dim_company"
[0m20:24:38.867696 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_company (compile): 20:24:38.862895 => 20:24:38.867469
[0m20:24:38.868074 [debug] [Thread-1 (]: Began executing node model.sec_edgar.dim_company
[0m20:24:38.870636 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.dim_company"
[0m20:24:38.871832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:38.957514 [debug] [Thread-1 (]: On model.sec_edgar.dim_company: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_company"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  OPTIONS()
  as select
  cik,
  any_value(company_name) as company_name,
  array_agg(distinct ticker IGNORE NULLS)[offset(0)] as ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
group by cik;


[0m20:24:39.426631 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (execute): 20:24:37.416592 => 20:24:39.425569
[0m20:24:39.428560 [info ] [Thread-2 (]: 4 of 14 PASS not_null_stg_companyfacts_concept ................................. [[32mPASS[0m in 2.02s]
[0m20:24:39.429625 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:24:39.648766 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:5c907fc1-e1d0-4155-94e3-99aac27e49e5&page=queryresults
[0m20:24:39.691858 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (execute): 20:24:37.421069 => 20:24:39.691677
[0m20:24:39.692530 [info ] [Thread-3 (]: 5 of 14 PASS not_null_stg_companyfacts_period_end_date ......................... [[32mPASS[0m in 2.28s]
[0m20:24:39.692963 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:24:39.693366 [debug] [Thread-4 (]: Began running node model.sec_edgar.int_companyfacts_normalized
[0m20:24:39.693704 [info ] [Thread-4 (]: 7 of 14 START sql view model sec_curated_sec_curated.int_companyfacts_normalized  [RUN]
[0m20:24:39.694181 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d, now model.sec_edgar.int_companyfacts_normalized)
[0m20:24:39.694453 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.int_companyfacts_normalized
[0m20:24:39.696434 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.int_companyfacts_normalized"
[0m20:24:39.698791 [debug] [Thread-4 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (compile): 20:24:39.694620 => 20:24:39.698638
[0m20:24:39.699076 [debug] [Thread-4 (]: Began executing node model.sec_edgar.int_companyfacts_normalized
[0m20:24:39.701457 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.int_companyfacts_normalized"
[0m20:24:39.702422 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:24:39.786929 [debug] [Thread-4 (]: On model.sec_edgar.int_companyfacts_normalized: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.int_companyfacts_normalized"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
  OPTIONS()
  as with ranked as (
  select
    cik, ticker, concept, unit, period_end_date, value, accn, filed, fy, fp, form,
    row_number() over (
      partition by cik, concept, period_end_date
      order by case
        when unit in ('USD','usd') then 1
        when unit like '%USD%' then 2
        else 3
      end, filed desc
    ) as rn
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
)
select * except(rn) from ranked where rn = 1;


[0m20:24:40.079149 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_company (execute): 20:24:38.868268 => 20:24:40.078746
[0m20:24:40.080722 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1408d58e0>]}
[0m20:24:40.081737 [info ] [Thread-1 (]: 6 of 14 OK created sql view model sec_curated_sec_curated.dim_company .......... [[32mCREATE VIEW (0 processed)[0m in 1.22s]
[0m20:24:40.082365 [debug] [Thread-1 (]: Finished running node model.sec_edgar.dim_company
[0m20:24:40.082998 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:24:40.083348 [debug] [Thread-2 (]: Began running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:24:40.083641 [info ] [Thread-3 (]: 8 of 14 START test not_null_dim_company_cik .................................... [RUN]
[0m20:24:40.083936 [info ] [Thread-2 (]: 9 of 14 START test unique_dim_company_cik ...................................... [RUN]
[0m20:24:40.084567 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee, now test.sec_edgar.not_null_dim_company_cik.2b3d612d15)
[0m20:24:40.085049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5, now test.sec_edgar.unique_dim_company_cik.ab80a865e2)
[0m20:24:40.085325 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:24:40.085579 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:24:40.089297 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m20:24:40.094723 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m20:24:40.096118 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (compile): 20:24:40.085744 => 20:24:40.095901
[0m20:24:40.096445 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:24:40.096809 [debug] [Thread-2 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (compile): 20:24:40.089535 => 20:24:40.096622
[0m20:24:40.098678 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m20:24:40.098997 [debug] [Thread-2 (]: Began executing node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:24:40.100687 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m20:24:40.101076 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:24:40.101417 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:24:40.186518 [debug] [Thread-3 (]: On test.sec_edgar.not_null_dim_company_cik.2b3d612d15: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
where cik is null



      
    ) dbt_internal_test
[0m20:24:40.271161 [debug] [Thread-2 (]: On test.sec_edgar.unique_dim_company_cik.ab80a865e2: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.unique_dim_company_cik.ab80a865e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select cik as unique_field
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  where cik is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:24:40.683943 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:137046b9-4df4-4458-be54-93e455e311e9&page=queryresults
[0m20:24:41.197251 [debug] [Thread-4 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (execute): 20:24:39.699530 => 20:24:41.197044
[0m20:24:41.198132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a1b4a0>]}
[0m20:24:41.198776 [info ] [Thread-4 (]: 7 of 14 OK created sql view model sec_curated_sec_curated.int_companyfacts_normalized  [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m20:24:41.199335 [debug] [Thread-4 (]: Finished running node model.sec_edgar.int_companyfacts_normalized
[0m20:24:41.200100 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:24:41.200874 [info ] [Thread-1 (]: 10 of 14 START test not_null_int_companyfacts_normalized_period_end_date ....... [RUN]
[0m20:24:41.202746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.dim_company, now test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd)
[0m20:24:41.203112 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:24:41.206487 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m20:24:41.208032 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (compile): 20:24:41.203330 => 20:24:41.207843
[0m20:24:41.208353 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:24:41.210154 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m20:24:41.211411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:41.300592 [debug] [Thread-1 (]: On test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
where period_end_date is null



      
    ) dbt_internal_test
[0m20:24:41.328966 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:aa95515b-408c-4055-b3d9-f658f20c5da5&page=queryresults
[0m20:24:41.647650 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3f00134b-6ebc-4bb9-88a0-2382fd5add5e&page=queryresults
[0m20:24:41.904868 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (execute): 20:24:40.096988 => 20:24:41.903814
[0m20:24:41.907040 [info ] [Thread-3 (]: 8 of 14 PASS not_null_dim_company_cik .......................................... [[32mPASS[0m in 1.82s]
[0m20:24:41.907648 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:24:42.310996 [debug] [Thread-2 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (execute): 20:24:40.099234 => 20:24:42.310583
[0m20:24:42.312081 [info ] [Thread-2 (]: 9 of 14 PASS unique_dim_company_cik ............................................ [[32mPASS[0m in 2.23s]
[0m20:24:42.312732 [debug] [Thread-2 (]: Finished running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:24:42.694588 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:4c7310d3-6244-4d33-a2a9-b9bf0916973c&page=queryresults
[0m20:24:43.232203 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (execute): 20:24:41.208533 => 20:24:43.231764
[0m20:24:43.233326 [info ] [Thread-1 (]: 10 of 14 PASS not_null_int_companyfacts_normalized_period_end_date ............. [[32mPASS[0m in 2.03s]
[0m20:24:43.233816 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:24:43.234718 [debug] [Thread-4 (]: Began running node model.sec_edgar.dim_concept
[0m20:24:43.235061 [debug] [Thread-3 (]: Began running node model.sec_edgar.fct_financials_quarterly
[0m20:24:43.235546 [info ] [Thread-4 (]: 11 of 14 START sql view model sec_curated_sec_curated.dim_concept .............. [RUN]
[0m20:24:43.235892 [info ] [Thread-3 (]: 12 of 14 START sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [RUN]
[0m20:24:43.236430 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sec_edgar.int_companyfacts_normalized, now model.sec_edgar.dim_concept)
[0m20:24:43.236903 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_dim_company_cik.2b3d612d15, now model.sec_edgar.fct_financials_quarterly)
[0m20:24:43.237182 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.dim_concept
[0m20:24:43.237439 [debug] [Thread-3 (]: Began compiling node model.sec_edgar.fct_financials_quarterly
[0m20:24:43.239847 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.dim_concept"
[0m20:24:43.243661 [debug] [Thread-3 (]: Writing injected SQL for node "model.sec_edgar.fct_financials_quarterly"
[0m20:24:43.245324 [debug] [Thread-3 (]: Timing info for model.sec_edgar.fct_financials_quarterly (compile): 20:24:43.240062 => 20:24:43.245159
[0m20:24:43.245625 [debug] [Thread-3 (]: Began executing node model.sec_edgar.fct_financials_quarterly
[0m20:24:43.252265 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_concept (compile): 20:24:43.237613 => 20:24:43.252099
[0m20:24:43.258959 [debug] [Thread-4 (]: Began executing node model.sec_edgar.dim_concept
[0m20:24:43.270620 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:24:43.272701 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.dim_concept"
[0m20:24:43.360781 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:24:43.445427 [debug] [Thread-4 (]: On model.sec_edgar.dim_concept: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_concept"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_concept`
  OPTIONS()
  as select concept,
  case concept
    when 'us-gaap:Revenues' then 'Revenue'
    when 'us-gaap:SalesRevenueNet' then 'Revenue'
    when 'us-gaap:CostOfRevenue' then 'Cost of Revenue'
    when 'us-gaap:GrossProfit' then 'Gross Profit'
    when 'us-gaap:NetIncomeLoss' then 'Net Income'
    when 'us-gaap:EarningsPerShareDiluted' then 'EPS (Diluted)'
    else concept
  end as concept_label
from (select distinct concept from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`);


[0m20:24:43.964752 [debug] [Thread-3 (]: Writing runtime sql for node "model.sec_edgar.fct_financials_quarterly"
[0m20:24:43.968320 [debug] [Thread-3 (]: On model.sec_edgar.fct_financials_quarterly: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.fct_financials_quarterly"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly` as DBT_INTERNAL_DEST
        using (
with base as (
  select
    n.cik, n.ticker, n.concept, n.unit,
    n.period_end_date, n.value, n.accn, n.filed, n.fy, n.fp, n.form
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized` n
  where n.fp in ('Q1','Q2','Q3','Q4') or n.form in ('10-Q','10-K')
)
select * from base

where period_end_date > (select ifnull(max(period_end_date), date('2000-01-01')) from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`cik`, `ticker`, `concept`, `unit`, `period_end_date`, `value`, `accn`, `filed`, `fy`, `fp`, `form`)
    values
        (`cik`, `ticker`, `concept`, `unit`, `period_end_date`, `value`, `accn`, `filed`, `fy`, `fp`, `form`)


    
[0m20:24:44.521955 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:0a883cc9-d18c-476a-b00e-5906d08ae804&page=queryresults
[0m20:24:44.618429 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:5d70943b-f2c3-42f8-ae5b-eb34bea84c1c&page=queryresults
[0m20:24:45.107268 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_concept (execute): 20:24:43.270817 => 20:24:45.107102
[0m20:24:45.108206 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131497860>]}
[0m20:24:45.108687 [info ] [Thread-4 (]: 11 of 14 OK created sql view model sec_curated_sec_curated.dim_concept ......... [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m20:24:45.109128 [debug] [Thread-4 (]: Finished running node model.sec_edgar.dim_concept
[0m20:24:47.864582 [debug] [Thread-3 (]: Timing info for model.sec_edgar.fct_financials_quarterly (execute): 20:24:43.245794 => 20:24:47.864359
[0m20:24:47.865668 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11b0ad07-e898-49ea-9274-c101d3e805e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x140a4b290>]}
[0m20:24:47.866217 [info ] [Thread-3 (]: 12 of 14 OK created sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [[32mMERGE (0.0 rows, 567.2 KiB processed)[0m in 4.63s]
[0m20:24:47.866675 [debug] [Thread-3 (]: Finished running node model.sec_edgar.fct_financials_quarterly
[0m20:24:47.867407 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:24:47.867766 [debug] [Thread-2 (]: Began running node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:24:47.868101 [info ] [Thread-1 (]: 13 of 14 START test not_null_fct_financials_quarterly_period_end_date .......... [RUN]
[0m20:24:47.868562 [info ] [Thread-2 (]: 14 of 14 START test relationships_fct_financials_quarterly_cik__cik__ref_dim_company_  [RUN]
[0m20:24:47.869153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd, now test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01)
[0m20:24:47.869668 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.unique_dim_company_cik.ab80a865e2, now test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e)
[0m20:24:47.869964 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:24:47.870233 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:24:47.873715 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m20:24:47.878744 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"
[0m20:24:47.879305 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (compile): 20:24:47.870411 => 20:24:47.879136
[0m20:24:47.879589 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:24:47.881276 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m20:24:47.881718 [debug] [Thread-2 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e (compile): 20:24:47.873935 => 20:24:47.881566
[0m20:24:47.882035 [debug] [Thread-2 (]: Began executing node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:24:47.883702 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"
[0m20:24:47.884010 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:24:47.968564 [debug] [Thread-1 (]: On test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
where period_end_date is null



      
    ) dbt_internal_test
[0m20:24:47.972822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:24:48.058070 [debug] [Thread-2 (]: On test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cik as from_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
    where cik is not null
),

parent as (
    select cik as to_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:24:49.129971 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:4991d79b-049b-4bfd-82b1-53e883897778&page=queryresults
[0m20:24:49.708426 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (execute): 20:24:47.879776 => 20:24:49.708035
[0m20:24:49.709523 [info ] [Thread-1 (]: 13 of 14 PASS not_null_fct_financials_quarterly_period_end_date ................ [[32mPASS[0m in 1.84s]
[0m20:24:49.710004 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:24:49.738690 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:768b6b8d-3602-461f-b1d8-2bc427f185bc&page=queryresults
[0m20:24:50.271571 [debug] [Thread-2 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e (execute): 20:24:47.882235 => 20:24:50.270405
[0m20:24:50.273838 [info ] [Thread-2 (]: 14 of 14 PASS relationships_fct_financials_quarterly_cik__cik__ref_dim_company_  [[32mPASS[0m in 2.40s]
[0m20:24:50.274503 [debug] [Thread-2 (]: Finished running node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:24:50.276315 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:24:50.276640 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01' was properly closed.
[0m20:24:50.276889 [debug] [MainThread]: Connection 'test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e' was properly closed.
[0m20:24:50.277119 [debug] [MainThread]: Connection 'model.sec_edgar.dim_concept' was properly closed.
[0m20:24:50.277335 [debug] [MainThread]: Connection 'model.sec_edgar.fct_financials_quarterly' was properly closed.
[0m20:24:50.277623 [info ] [MainThread]: 
[0m20:24:50.277901 [info ] [MainThread]: Finished running 5 view models, 8 tests, 1 incremental model in 0 hours 0 minutes and 16.06 seconds (16.06s).
[0m20:24:50.279355 [debug] [MainThread]: Command end result
[0m20:24:50.286268 [info ] [MainThread]: 
[0m20:24:50.286579 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:24:50.286817 [info ] [MainThread]: 
[0m20:24:50.287068 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m20:24:50.287439 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 18.521719, "process_user_time": 6.503882, "process_kernel_time": 1.887391, "process_mem_max_rss": "261898240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:24:50.287775 [debug] [MainThread]: Command `dbt build` succeeded at 20:24:50.287693 after 18.52 seconds
[0m20:24:50.288058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110452240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110451970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110452210>]}
[0m20:24:50.288335 [debug] [MainThread]: Flushing usage events
[0m20:27:19.639497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cab380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd76b0>]}


============================== 20:27:19.644125 | 9897bcbe-cf1f-4b54-963d-b7925f4aa9b1 ==============================
[0m20:27:19.644125 [info ] [MainThread]: Running with dbt=1.7.15
[0m20:27:19.644653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'debug': 'False', 'profiles_dir': './dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:27:21.265662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105af91f0>]}
[0m20:27:21.305525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d90d0>]}
[0m20:27:21.306526 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m20:27:21.333581 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m20:27:21.513723 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:27:21.514116 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:27:21.518539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14663ba40>]}
[0m20:27:21.534139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146679f10>]}
[0m20:27:21.534538 [info ] [MainThread]: Found 6 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:27:21.536091 [info ] [MainThread]: 
[0m20:27:21.536686 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:27:21.537653 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m20:27:21.537986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:21.538490 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m20:27:21.538897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:22.416238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_curated)
[0m20:27:22.418894 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_raw)
[0m20:27:22.420269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:22.421011 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:27:23.104231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14670caa0>]}
[0m20:27:23.105240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:23.105622 [info ] [MainThread]: 
[0m20:27:23.115642 [debug] [Thread-1 (]: Began running node model.sec_edgar.stg_companyfacts
[0m20:27:23.116128 [debug] [Thread-2 (]: Began running node model.sec_edgar.stg_submissions
[0m20:27:23.116520 [info ] [Thread-1 (]: 1 of 14 START sql view model sec_curated_sec_raw.stg_companyfacts .............. [RUN]
[0m20:27:23.117030 [info ] [Thread-2 (]: 2 of 14 START sql view model sec_curated_sec_raw.stg_submissions ............... [RUN]
[0m20:27:23.117623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_curated, now model.sec_edgar.stg_companyfacts)
[0m20:27:23.118106 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_raw, now model.sec_edgar.stg_submissions)
[0m20:27:23.118407 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.stg_companyfacts
[0m20:27:23.118744 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.stg_submissions
[0m20:27:23.126025 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.stg_companyfacts"
[0m20:27:23.128323 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.stg_submissions"
[0m20:27:23.130236 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (compile): 20:27:23.119005 => 20:27:23.130031
[0m20:27:23.130584 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (compile): 20:27:23.126284 => 20:27:23.130424
[0m20:27:23.130887 [debug] [Thread-1 (]: Began executing node model.sec_edgar.stg_companyfacts
[0m20:27:23.131177 [debug] [Thread-2 (]: Began executing node model.sec_edgar.stg_submissions
[0m20:27:23.154259 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.stg_submissions"
[0m20:27:23.157952 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.stg_companyfacts"
[0m20:27:23.185779 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:23.186219 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:27:23.270996 [debug] [Thread-1 (]: On model.sec_edgar.stg_companyfacts: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_companyfacts"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    concept,
    unit,
    SAFE_CAST(period_end_date as date) as period_end_date,
    SAFE_CAST(val as float64) as value,
    accn, fy, fp, form,
    SAFE_CAST(filed as date) as filed
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_companyfacts`
)
select * from src;


[0m20:27:23.359643 [debug] [Thread-2 (]: On model.sec_edgar.stg_submissions: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_submissions"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    company_name,
    accession_no,
    form,
    SAFE_CAST(filed as date) as filed,
    SAFE_CAST(report_period as date) as report_period
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_submissions`
)
select * from src;


[0m20:27:24.100771 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:60b2c22d-4b47-4a22-b34f-bd5ccca67362&page=queryresults
[0m20:27:24.133782 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:803204a4-5fc9-4b12-8b80-2d8476e62f58&page=queryresults
[0m20:27:24.646996 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (execute): 20:27:23.133368 => 20:27:24.646821
[0m20:27:24.647738 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146777920>]}
[0m20:27:24.648265 [info ] [Thread-2 (]: 2 of 14 OK created sql view model sec_curated_sec_raw.stg_submissions .......... [[32mCREATE VIEW (0 processed)[0m in 1.53s]
[0m20:27:24.649216 [debug] [Thread-2 (]: Finished running node model.sec_edgar.stg_submissions
[0m20:27:24.652044 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (execute): 20:27:23.131348 => 20:27:24.651891
[0m20:27:24.652528 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:27:24.653065 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146414500>]}
[0m20:27:24.653416 [info ] [Thread-4 (]: 3 of 14 START test not_null_stg_submissions_accession_no ....................... [RUN]
[0m20:27:24.653840 [info ] [Thread-1 (]: 1 of 14 OK created sql view model sec_curated_sec_raw.stg_companyfacts ......... [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m20:27:24.654405 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d'
[0m20:27:24.654779 [debug] [Thread-1 (]: Finished running node model.sec_edgar.stg_companyfacts
[0m20:27:24.655049 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:27:24.663570 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m20:27:24.664110 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:27:24.664596 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:27:24.665087 [info ] [Thread-2 (]: 4 of 14 START test not_null_stg_companyfacts_concept ........................... [RUN]
[0m20:27:24.665416 [info ] [Thread-3 (]: 5 of 14 START test not_null_stg_companyfacts_period_end_date ................... [RUN]
[0m20:27:24.665922 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_submissions, now test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5)
[0m20:27:24.666421 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee'
[0m20:27:24.666695 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:27:24.666948 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:27:24.670919 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m20:27:24.674725 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m20:27:24.675234 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (compile): 20:27:24.655333 => 20:27:24.675015
[0m20:27:24.675711 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:27:24.686628 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m20:27:24.687126 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (compile): 20:27:24.667146 => 20:27:24.686967
[0m20:27:24.687533 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (compile): 20:27:24.671295 => 20:27:24.687348
[0m20:27:24.687888 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:27:24.688291 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:27:24.688649 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:27:24.690608 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m20:27:24.692308 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m20:27:24.777937 [debug] [Thread-4 (]: On test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select accession_no
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
where accession_no is null



      
    ) dbt_internal_test
[0m20:27:24.778408 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:27:24.778724 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:27:24.951760 [debug] [Thread-3 (]: On test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where period_end_date is null



      
    ) dbt_internal_test
[0m20:27:24.952274 [debug] [Thread-2 (]: On test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select concept
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where concept is null



      
    ) dbt_internal_test
[0m20:27:26.000578 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:c9fbd060-104d-44bb-8a74-8a90c4105207&page=queryresults
[0m20:27:26.002220 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:e0d4c1a7-67e9-46b4-8375-0b1d85ed93aa&page=queryresults
[0m20:27:26.004107 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:90f8722d-8b93-4dcb-a9e3-385595e8ec82&page=queryresults
[0m20:27:26.629317 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (execute): 20:27:24.676043 => 20:27:26.628271
[0m20:27:26.632220 [info ] [Thread-4 (]: 3 of 14 PASS not_null_stg_submissions_accession_no ............................. [[32mPASS[0m in 1.98s]
[0m20:27:26.633605 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:27:26.635204 [debug] [Thread-1 (]: Began running node model.sec_edgar.dim_company
[0m20:27:26.637038 [info ] [Thread-1 (]: 6 of 14 START sql view model sec_curated_sec_curated.dim_company ............... [RUN]
[0m20:27:26.641971 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (execute): 20:27:24.688856 => 20:27:26.641142
[0m20:27:26.643252 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_companyfacts, now model.sec_edgar.dim_company)
[0m20:27:26.645311 [info ] [Thread-2 (]: 4 of 14 PASS not_null_stg_companyfacts_concept ................................. [[32mPASS[0m in 1.98s]
[0m20:27:26.646457 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.dim_company
[0m20:27:26.647426 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:27:26.650336 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.dim_company"
[0m20:27:26.651867 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_company (compile): 20:27:26.647711 => 20:27:26.651686
[0m20:27:26.652190 [debug] [Thread-1 (]: Began executing node model.sec_edgar.dim_company
[0m20:27:26.658301 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.dim_company"
[0m20:27:26.659704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:26.748123 [debug] [Thread-1 (]: On model.sec_edgar.dim_company: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_company"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  OPTIONS()
  as select
  cik,
  any_value(company_name) as company_name,
  array_agg(distinct ticker IGNORE NULLS)[offset(0)] as ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
group by cik;


[0m20:27:26.748936 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (execute): 20:27:24.690870 => 20:27:26.748761
[0m20:27:26.752961 [info ] [Thread-3 (]: 5 of 14 PASS not_null_stg_companyfacts_period_end_date ......................... [[32mPASS[0m in 2.09s]
[0m20:27:26.753469 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:27:26.753886 [debug] [Thread-4 (]: Began running node model.sec_edgar.int_companyfacts_normalized
[0m20:27:26.754257 [info ] [Thread-4 (]: 7 of 14 START sql view model sec_curated_sec_curated.int_companyfacts_normalized  [RUN]
[0m20:27:26.754846 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d, now model.sec_edgar.int_companyfacts_normalized)
[0m20:27:26.755354 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.int_companyfacts_normalized
[0m20:27:26.757514 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.int_companyfacts_normalized"
[0m20:27:26.759619 [debug] [Thread-4 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (compile): 20:27:26.755533 => 20:27:26.759456
[0m20:27:26.759900 [debug] [Thread-4 (]: Began executing node model.sec_edgar.int_companyfacts_normalized
[0m20:27:26.761971 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.int_companyfacts_normalized"
[0m20:27:26.762899 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:27:26.847634 [debug] [Thread-4 (]: On model.sec_edgar.int_companyfacts_normalized: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.int_companyfacts_normalized"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
  OPTIONS()
  as with ranked as (
  select
    cik, ticker, concept, unit, period_end_date, value, accn, filed, fy, fp, form,
    row_number() over (
      partition by cik, concept, period_end_date
      order by case
        when unit in ('USD','usd') then 1
        when unit like '%USD%' then 2
        else 3
      end, filed desc
    ) as rn
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
)
select * except(rn) from ranked where rn = 1;


[0m20:27:27.664625 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:4ef86674-5542-474e-b0b9-9a7f6c03f8d3&page=queryresults
[0m20:27:27.700583 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:21872bc0-a305-4f76-bb72-1a97f516dce7&page=queryresults
[0m20:27:28.206480 [debug] [Thread-4 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (execute): 20:27:26.760065 => 20:27:28.205645
[0m20:27:28.211826 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1468bfa40>]}
[0m20:27:28.214067 [info ] [Thread-4 (]: 7 of 14 OK created sql view model sec_curated_sec_curated.int_companyfacts_normalized  [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m20:27:28.215410 [debug] [Thread-4 (]: Finished running node model.sec_edgar.int_companyfacts_normalized
[0m20:27:28.216876 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:27:28.217683 [info ] [Thread-3 (]: 8 of 14 START test not_null_int_companyfacts_normalized_period_end_date ........ [RUN]
[0m20:27:28.219536 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee, now test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd)
[0m20:27:28.220494 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:27:28.225434 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m20:27:28.227318 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (compile): 20:27:28.220918 => 20:27:28.227143
[0m20:27:28.227630 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:27:28.229402 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m20:27:28.230395 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:27:28.315214 [debug] [Thread-3 (]: On test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
where period_end_date is null



      
    ) dbt_internal_test
[0m20:27:28.320789 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_company (execute): 20:27:26.652378 => 20:27:28.320626
[0m20:27:28.321552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146613860>]}
[0m20:27:28.322214 [info ] [Thread-1 (]: 6 of 14 OK created sql view model sec_curated_sec_curated.dim_company .......... [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m20:27:28.322649 [debug] [Thread-1 (]: Finished running node model.sec_edgar.dim_company
[0m20:27:28.323370 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:27:28.323720 [debug] [Thread-2 (]: Began running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:27:28.324052 [info ] [Thread-4 (]: 9 of 14 START test not_null_dim_company_cik .................................... [RUN]
[0m20:27:28.324450 [info ] [Thread-2 (]: 10 of 14 START test unique_dim_company_cik ..................................... [RUN]
[0m20:27:28.324999 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sec_edgar.int_companyfacts_normalized, now test.sec_edgar.not_null_dim_company_cik.2b3d612d15)
[0m20:27:28.325827 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5, now test.sec_edgar.unique_dim_company_cik.ab80a865e2)
[0m20:27:28.326112 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:27:28.326373 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:27:28.329652 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m20:27:28.334006 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m20:27:28.335304 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (compile): 20:27:28.326544 => 20:27:28.335123
[0m20:27:28.335739 [debug] [Thread-2 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (compile): 20:27:28.329907 => 20:27:28.335508
[0m20:27:28.336077 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:27:28.336395 [debug] [Thread-2 (]: Began executing node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:27:28.338177 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m20:27:28.339865 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m20:27:28.340803 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:27:28.341192 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:27:28.426854 [debug] [Thread-4 (]: On test.sec_edgar.not_null_dim_company_cik.2b3d612d15: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
where cik is null



      
    ) dbt_internal_test
[0m20:27:28.516238 [debug] [Thread-2 (]: On test.sec_edgar.unique_dim_company_cik.ab80a865e2: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.unique_dim_company_cik.ab80a865e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select cik as unique_field
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  where cik is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:27:29.621770 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:0c259fe3-adfc-440e-a600-6737237e65ed&page=queryresults
[0m20:27:29.909987 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:f84e7706-3e59-441f-8adf-47e9f134b8bb&page=queryresults
[0m20:27:29.966404 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:8fb45bac-7c0b-4e1f-a7d6-2ad3b4a46498&page=queryresults
[0m20:27:30.197205 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (execute): 20:27:28.336600 => 20:27:30.196333
[0m20:27:30.199291 [info ] [Thread-4 (]: 9 of 14 PASS not_null_dim_company_cik .......................................... [[32mPASS[0m in 1.87s]
[0m20:27:30.200422 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:27:30.551417 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (execute): 20:27:28.227806 => 20:27:30.549830
[0m20:27:30.552951 [info ] [Thread-3 (]: 8 of 14 PASS not_null_int_companyfacts_normalized_period_end_date .............. [[32mPASS[0m in 2.33s]
[0m20:27:30.558537 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:27:30.561482 [debug] [Thread-1 (]: Began running node model.sec_edgar.dim_concept
[0m20:27:30.567573 [info ] [Thread-1 (]: 11 of 14 START sql view model sec_curated_sec_curated.dim_concept .............. [RUN]
[0m20:27:30.569193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.dim_company, now model.sec_edgar.dim_concept)
[0m20:27:30.569985 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.dim_concept
[0m20:27:30.570765 [debug] [Thread-4 (]: Began running node model.sec_edgar.fct_financials_quarterly
[0m20:27:30.573274 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.dim_concept"
[0m20:27:30.573928 [info ] [Thread-4 (]: 12 of 14 START sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [RUN]
[0m20:27:30.574714 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_dim_company_cik.2b3d612d15, now model.sec_edgar.fct_financials_quarterly)
[0m20:27:30.575069 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.fct_financials_quarterly
[0m20:27:30.584513 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.fct_financials_quarterly"
[0m20:27:30.585261 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_concept (compile): 20:27:30.571036 => 20:27:30.584972
[0m20:27:30.585832 [debug] [Thread-4 (]: Timing info for model.sec_edgar.fct_financials_quarterly (compile): 20:27:30.575249 => 20:27:30.585660
[0m20:27:30.586121 [debug] [Thread-1 (]: Began executing node model.sec_edgar.dim_concept
[0m20:27:30.586516 [debug] [Thread-4 (]: Began executing node model.sec_edgar.fct_financials_quarterly
[0m20:27:30.588880 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.dim_concept"
[0m20:27:30.616439 [debug] [Thread-2 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (execute): 20:27:28.338385 => 20:27:30.616175
[0m20:27:30.617038 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:27:30.617845 [info ] [Thread-2 (]: 10 of 14 PASS unique_dim_company_cik ........................................... [[32mPASS[0m in 2.29s]
[0m20:27:30.618522 [debug] [Thread-2 (]: Finished running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:27:30.718028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:27:30.804469 [debug] [Thread-1 (]: On model.sec_edgar.dim_concept: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_concept"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_concept`
  OPTIONS()
  as select concept,
  case concept
    when 'us-gaap:Revenues' then 'Revenue'
    when 'us-gaap:SalesRevenueNet' then 'Revenue'
    when 'us-gaap:CostOfRevenue' then 'Cost of Revenue'
    when 'us-gaap:GrossProfit' then 'Gross Profit'
    when 'us-gaap:NetIncomeLoss' then 'Net Income'
    when 'us-gaap:EarningsPerShareDiluted' then 'EPS (Diluted)'
    else concept
  end as concept_label
from (select distinct concept from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`);


[0m20:27:31.548614 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:e87edb08-eafb-4341-a2b5-fe208c4ca8bd&page=queryresults
[0m20:27:31.682715 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.fct_financials_quarterly"
[0m20:27:31.684158 [debug] [Thread-4 (]: On model.sec_edgar.fct_financials_quarterly: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.fct_financials_quarterly"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly` as DBT_INTERNAL_DEST
        using (
with base as (
  select
    n.cik, n.ticker, n.concept, n.unit,
    n.period_end_date, n.value, n.accn, n.filed, n.fy, n.fp, n.form
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized` n
  where n.fp in ('Q1','Q2','Q3','Q4') or n.form in ('10-Q','10-K')
)
select * from base

where period_end_date > (select ifnull(max(period_end_date), date('2000-01-01')) from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`cik`, `ticker`, `concept`, `unit`, `period_end_date`, `value`, `accn`, `filed`, `fy`, `fp`, `form`)
    values
        (`cik`, `ticker`, `concept`, `unit`, `period_end_date`, `value`, `accn`, `filed`, `fy`, `fp`, `form`)


    
[0m20:27:32.016346 [debug] [Thread-1 (]: Timing info for model.sec_edgar.dim_concept (execute): 20:27:30.586779 => 20:27:32.016171
[0m20:27:32.017021 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146612f00>]}
[0m20:27:32.017471 [info ] [Thread-1 (]: 11 of 14 OK created sql view model sec_curated_sec_curated.dim_concept ......... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m20:27:32.018226 [debug] [Thread-1 (]: Finished running node model.sec_edgar.dim_concept
[0m20:27:32.398182 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:78677f39-5b3e-4d38-92b6-432e5a9988b3&page=queryresults
[0m20:27:35.209859 [debug] [Thread-4 (]: Timing info for model.sec_edgar.fct_financials_quarterly (execute): 20:27:30.589131 => 20:27:35.209356
[0m20:27:35.212086 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9897bcbe-cf1f-4b54-963d-b7925f4aa9b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146885580>]}
[0m20:27:35.213738 [info ] [Thread-4 (]: 12 of 14 OK created sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [[32mMERGE (0.0 rows, 567.2 KiB processed)[0m in 4.64s]
[0m20:27:35.215330 [debug] [Thread-4 (]: Finished running node model.sec_edgar.fct_financials_quarterly
[0m20:27:35.217536 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:27:35.218273 [debug] [Thread-2 (]: Began running node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:27:35.219122 [info ] [Thread-3 (]: 13 of 14 START test not_null_fct_financials_quarterly_period_end_date .......... [RUN]
[0m20:27:35.219886 [info ] [Thread-2 (]: 14 of 14 START test relationships_fct_financials_quarterly_cik__cik__ref_dim_company_  [RUN]
[0m20:27:35.222570 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd, now test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01)
[0m20:27:35.224168 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.unique_dim_company_cik.ab80a865e2, now test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e)
[0m20:27:35.225112 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:27:35.225803 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:27:35.229711 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m20:27:35.235234 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"
[0m20:27:35.236491 [debug] [Thread-2 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e (compile): 20:27:35.229951 => 20:27:35.236292
[0m20:27:35.236830 [debug] [Thread-2 (]: Began executing node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:27:35.238566 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"
[0m20:27:35.238909 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (compile): 20:27:35.226030 => 20:27:35.238751
[0m20:27:35.239241 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:27:35.240903 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m20:27:35.241291 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:27:35.241683 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:27:35.327618 [debug] [Thread-2 (]: On test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cik as from_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
    where cik is not null
),

parent as (
    select cik as to_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:27:35.416611 [debug] [Thread-3 (]: On test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
where period_end_date is null



      
    ) dbt_internal_test
[0m20:27:36.360732 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:51f2d1dd-4147-4ab6-9ba7-52d1c69ee72a&page=queryresults
[0m20:27:36.868552 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (execute): 20:27:35.239435 => 20:27:36.868001
[0m20:27:36.870130 [info ] [Thread-3 (]: 13 of 14 PASS not_null_fct_financials_quarterly_period_end_date ................ [[32mPASS[0m in 1.65s]
[0m20:27:36.871152 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:27:36.933630 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:494916c2-133c-4e8b-b9b3-444e63a606d1&page=queryresults
[0m20:27:37.518996 [debug] [Thread-2 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e (execute): 20:27:35.237027 => 20:27:37.518016
[0m20:27:37.521283 [info ] [Thread-2 (]: 14 of 14 PASS relationships_fct_financials_quarterly_cik__cik__ref_dim_company_  [[32mPASS[0m in 2.30s]
[0m20:27:37.522520 [debug] [Thread-2 (]: Finished running node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:27:37.527663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:37.528726 [debug] [MainThread]: Connection 'model.sec_edgar.dim_concept' was properly closed.
[0m20:27:37.529249 [debug] [MainThread]: Connection 'test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e' was properly closed.
[0m20:27:37.530694 [debug] [MainThread]: Connection 'model.sec_edgar.fct_financials_quarterly' was properly closed.
[0m20:27:37.531632 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01' was properly closed.
[0m20:27:37.532407 [info ] [MainThread]: 
[0m20:27:37.533049 [info ] [MainThread]: Finished running 5 view models, 8 tests, 1 incremental model in 0 hours 0 minutes and 16.00 seconds (16.00s).
[0m20:27:37.539573 [debug] [MainThread]: Command end result
[0m20:27:37.556219 [info ] [MainThread]: 
[0m20:27:37.556605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:27:37.556861 [info ] [MainThread]: 
[0m20:27:37.557119 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m20:27:37.557560 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 17.968832, "process_user_time": 6.060781, "process_kernel_time": 1.972356, "process_mem_max_rss": "255311872", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:27:37.558262 [debug] [MainThread]: Command `dbt build` succeeded at 20:27:37.558120 after 17.97 seconds
[0m20:27:37.558946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bab5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cd7a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc7860>]}
[0m20:27:37.559447 [debug] [MainThread]: Flushing usage events
[0m20:36:27.507215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196fecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119752420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119752120>]}


============================== 20:36:27.512154 | f1fef245-57d9-453d-a5fe-e2f57615a430 ==============================
[0m20:36:27.512154 [info ] [MainThread]: Running with dbt=1.7.15
[0m20:36:27.512654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'dbt/logs', 'profiles_dir': './dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:36:31.147218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad5d670>]}
[0m20:36:31.183516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11972c9e0>]}
[0m20:36:31.185237 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m20:36:31.207173 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m20:36:31.215454 [info ] [MainThread]: Unable to do partial parsing because env vars used in dbt_project.yml have changed
[0m20:36:31.215876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3a74d0>]}
[0m20:36:32.063200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b69cce0>]}
[0m20:36:32.073965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b674080>]}
[0m20:36:32.074354 [info ] [MainThread]: Found 6 models, 8 tests, 2 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m20:36:32.076012 [info ] [MainThread]: 
[0m20:36:32.076729 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:36:32.077790 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m20:36:32.078409 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m20:36:32.078751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:32.079028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:32.846027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_curated)
[0m20:36:32.846672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_raw)
[0m20:36:32.847180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:32.847460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:33.539958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f9310>]}
[0m20:36:33.540675 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:36:33.540952 [info ] [MainThread]: 
[0m20:36:33.543919 [debug] [Thread-1 (]: Began running node model.sec_edgar.stg_companyfacts
[0m20:36:33.544396 [debug] [Thread-2 (]: Began running node model.sec_edgar.stg_submissions
[0m20:36:33.544848 [info ] [Thread-1 (]: 1 of 14 START sql view model sec_curated_sec_raw.stg_companyfacts .............. [RUN]
[0m20:36:33.545195 [info ] [Thread-2 (]: 2 of 14 START sql view model sec_curated_sec_raw.stg_submissions ............... [RUN]
[0m20:36:33.545738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_curated, now model.sec_edgar.stg_companyfacts)
[0m20:36:33.546912 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.stg_companyfacts
[0m20:36:33.552873 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.stg_companyfacts"
[0m20:36:33.553384 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_raw, now model.sec_edgar.stg_submissions)
[0m20:36:33.553827 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.stg_submissions
[0m20:36:33.555860 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.stg_submissions"
[0m20:36:33.556455 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (compile): 20:36:33.547306 => 20:36:33.556298
[0m20:36:33.556718 [debug] [Thread-1 (]: Began executing node model.sec_edgar.stg_companyfacts
[0m20:36:33.579018 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.stg_companyfacts"
[0m20:36:33.579520 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (compile): 20:36:33.554005 => 20:36:33.579273
[0m20:36:33.580033 [debug] [Thread-2 (]: Began executing node model.sec_edgar.stg_submissions
[0m20:36:33.582307 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.stg_submissions"
[0m20:36:33.602966 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:36:33.603356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:33.773878 [debug] [Thread-2 (]: On model.sec_edgar.stg_submissions: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_submissions"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    company_name,
    accession_no,
    form,
    SAFE_CAST(filed as date) as filed,
    SAFE_CAST(report_period as date) as report_period
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_submissions`
)
select * from src;


[0m20:36:33.774371 [debug] [Thread-1 (]: On model.sec_edgar.stg_companyfacts: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.stg_companyfacts"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
  OPTIONS()
  as with src as (
  select
    SAFE_CAST(cik as string) as cik,
    upper(ticker) as ticker,
    concept,
    unit,
    SAFE_CAST(period_end_date as date) as period_end_date,
    SAFE_CAST(val as float64) as value,
    accn, fy, fp, form,
    SAFE_CAST(filed as date) as filed
  from `sec-edgar-financials-warehouse`.`sec_raw`.`raw_companyfacts`
)
select * from src;


[0m20:36:34.414405 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:ff1d7203-cae2-4d10-b80e-11431e3386bf&page=queryresults
[0m20:36:34.801978 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:5b252dd7-4e26-491a-82fc-1aee2d78c843&page=queryresults
[0m20:36:34.949183 [debug] [Thread-1 (]: Timing info for model.sec_edgar.stg_companyfacts (execute): 20:36:33.556872 => 20:36:34.949011
[0m20:36:34.949866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ba61e0>]}
[0m20:36:34.950303 [info ] [Thread-1 (]: 1 of 14 OK created sql view model sec_curated_sec_raw.stg_companyfacts ......... [[32mCREATE VIEW (0 processed)[0m in 1.40s]
[0m20:36:34.950779 [debug] [Thread-1 (]: Finished running node model.sec_edgar.stg_companyfacts
[0m20:36:34.951519 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:36:34.951999 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:36:34.952332 [info ] [Thread-4 (]: 3 of 14 START test not_null_stg_companyfacts_concept ........................... [RUN]
[0m20:36:34.952648 [info ] [Thread-3 (]: 4 of 14 START test not_null_stg_companyfacts_period_end_date ................... [RUN]
[0m20:36:34.953203 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5'
[0m20:36:34.953685 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee'
[0m20:36:34.953971 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:36:34.954336 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:36:34.960608 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m20:36:34.964472 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m20:36:34.966010 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (compile): 20:36:34.954528 => 20:36:34.965812
[0m20:36:34.966319 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:36:34.973974 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (compile): 20:36:34.960859 => 20:36:34.973766
[0m20:36:34.976930 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"
[0m20:36:34.977346 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:36:34.979213 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"
[0m20:36:34.979682 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:36:34.980134 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:36:35.064991 [debug] [Thread-4 (]: On test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select concept
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where concept is null



      
    ) dbt_internal_test
[0m20:36:35.150169 [debug] [Thread-3 (]: On test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
where period_end_date is null



      
    ) dbt_internal_test
[0m20:36:35.414787 [debug] [Thread-2 (]: Timing info for model.sec_edgar.stg_submissions (execute): 20:36:33.580298 => 20:36:35.414371
[0m20:36:35.416382 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1c79e0>]}
[0m20:36:35.417448 [info ] [Thread-2 (]: 2 of 14 OK created sql view model sec_curated_sec_raw.stg_submissions .......... [[32mCREATE VIEW (0 processed)[0m in 1.87s]
[0m20:36:35.418413 [debug] [Thread-2 (]: Finished running node model.sec_edgar.stg_submissions
[0m20:36:35.419203 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:36:35.419624 [info ] [Thread-1 (]: 5 of 14 START test not_null_stg_submissions_accession_no ....................... [RUN]
[0m20:36:35.420262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_companyfacts, now test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d)
[0m20:36:35.420646 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:36:35.426551 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m20:36:35.427684 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (compile): 20:36:35.420892 => 20:36:35.427513
[0m20:36:35.427970 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:36:35.429659 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"
[0m20:36:35.430634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:35.515543 [debug] [Thread-1 (]: On test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select accession_no
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
where accession_no is null



      
    ) dbt_internal_test
[0m20:36:36.110030 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3a5d53eb-1f48-4968-804d-7d29c8eef487&page=queryresults
[0m20:36:36.112469 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:d2a3abb9-5586-4f16-a298-39a69bc5413e&page=queryresults
[0m20:36:36.572958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:c9a2f003-1a24-46fb-ab31-0f50d0045382&page=queryresults
[0m20:36:36.694551 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee (execute): 20:36:34.977616 => 20:36:36.693645
[0m20:36:36.696556 [info ] [Thread-3 (]: 4 of 14 PASS not_null_stg_companyfacts_period_end_date ......................... [[32mPASS[0m in 1.74s]
[0m20:36:36.697216 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee
[0m20:36:36.732892 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5 (execute): 20:36:34.966506 => 20:36:36.732255
[0m20:36:36.734566 [info ] [Thread-4 (]: 3 of 14 PASS not_null_stg_companyfacts_concept ................................. [[32mPASS[0m in 1.78s]
[0m20:36:36.735066 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5
[0m20:36:36.735538 [debug] [Thread-2 (]: Began running node model.sec_edgar.int_companyfacts_normalized
[0m20:36:36.735947 [info ] [Thread-2 (]: 6 of 14 START sql view model sec_curated_sec_curated.int_companyfacts_normalized  [RUN]
[0m20:36:36.736483 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sec_edgar.stg_submissions, now model.sec_edgar.int_companyfacts_normalized)
[0m20:36:36.736747 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.int_companyfacts_normalized
[0m20:36:36.739470 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.int_companyfacts_normalized"
[0m20:36:36.741583 [debug] [Thread-2 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (compile): 20:36:36.736913 => 20:36:36.741416
[0m20:36:36.741866 [debug] [Thread-2 (]: Began executing node model.sec_edgar.int_companyfacts_normalized
[0m20:36:36.744196 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.int_companyfacts_normalized"
[0m20:36:36.745083 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:36:36.830671 [debug] [Thread-2 (]: On model.sec_edgar.int_companyfacts_normalized: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.int_companyfacts_normalized"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
  OPTIONS()
  as with ranked as (
  select
    cik, ticker, concept, unit, period_end_date, value, accn, filed, fy, fp, form,
    row_number() over (
      partition by cik, concept, period_end_date
      order by case
        when unit in ('USD','usd') then 1
        when unit like '%USD%' then 2
        else 3
      end, filed desc
    ) as rn
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_companyfacts`
)
select * except(rn) from ranked where rn = 1;


[0m20:36:37.385468 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d (execute): 20:36:35.428136 => 20:36:37.384308
[0m20:36:37.387536 [info ] [Thread-1 (]: 5 of 14 PASS not_null_stg_submissions_accession_no ............................. [[32mPASS[0m in 1.97s]
[0m20:36:37.388783 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d
[0m20:36:37.389848 [debug] [Thread-4 (]: Began running node model.sec_edgar.dim_company
[0m20:36:37.390561 [info ] [Thread-4 (]: 7 of 14 START sql view model sec_curated_sec_curated.dim_company ............... [RUN]
[0m20:36:37.391328 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_concept.b71f04fbc5, now model.sec_edgar.dim_company)
[0m20:36:37.391681 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.dim_company
[0m20:36:37.394895 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.dim_company"
[0m20:36:37.396426 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_company (compile): 20:36:37.391902 => 20:36:37.396053
[0m20:36:37.397002 [debug] [Thread-4 (]: Began executing node model.sec_edgar.dim_company
[0m20:36:37.400629 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.dim_company"
[0m20:36:37.403215 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:36:37.490393 [debug] [Thread-4 (]: On model.sec_edgar.dim_company: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_company"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  OPTIONS()
  as select
  cik,
  any_value(company_name) as company_name,
  array_agg(distinct ticker IGNORE NULLS)[offset(0)] as ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_raw`.`stg_submissions`
group by cik;


[0m20:36:37.573683 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:5a0d68be-9d03-428b-aeeb-2b0f441da665&page=queryresults
[0m20:36:38.112583 [debug] [Thread-2 (]: Timing info for model.sec_edgar.int_companyfacts_normalized (execute): 20:36:36.742021 => 20:36:38.112359
[0m20:36:38.113647 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ef290>]}
[0m20:36:38.114237 [info ] [Thread-2 (]: 6 of 14 OK created sql view model sec_curated_sec_curated.int_companyfacts_normalized  [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m20:36:38.114710 [debug] [Thread-2 (]: Finished running node model.sec_edgar.int_companyfacts_normalized
[0m20:36:38.115250 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:36:38.115595 [info ] [Thread-1 (]: 8 of 14 START test not_null_int_companyfacts_normalized_period_end_date ........ [RUN]
[0m20:36:38.117022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_submissions_accession_no.4edd837c9d, now test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd)
[0m20:36:38.117716 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:36:38.123571 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m20:36:38.125361 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (compile): 20:36:38.118074 => 20:36:38.125131
[0m20:36:38.125704 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:36:38.127853 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"
[0m20:36:38.128868 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:38.214346 [debug] [Thread-1 (]: On test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`
where period_end_date is null



      
    ) dbt_internal_test
[0m20:36:38.324714 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:4542d685-afd5-48a4-abd4-1d6b2b12d4fa&page=queryresults
[0m20:36:38.849379 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_company (execute): 20:36:37.397325 => 20:36:38.849207
[0m20:36:38.850065 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c23fad0>]}
[0m20:36:38.850503 [info ] [Thread-4 (]: 7 of 14 OK created sql view model sec_curated_sec_curated.dim_company .......... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m20:36:38.850916 [debug] [Thread-4 (]: Finished running node model.sec_edgar.dim_company
[0m20:36:38.851468 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:36:38.851857 [debug] [Thread-3 (]: Began running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:36:38.852228 [info ] [Thread-2 (]: 9 of 14 START test not_null_dim_company_cik .................................... [RUN]
[0m20:36:38.852539 [info ] [Thread-3 (]: 10 of 14 START test unique_dim_company_cik ..................................... [RUN]
[0m20:36:38.853121 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sec_edgar.int_companyfacts_normalized, now test.sec_edgar.not_null_dim_company_cik.2b3d612d15)
[0m20:36:38.853625 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_stg_companyfacts_period_end_date.4469ada2ee, now test.sec_edgar.unique_dim_company_cik.ab80a865e2)
[0m20:36:38.853904 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:36:38.854160 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:36:38.857990 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m20:36:38.862170 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m20:36:38.863481 [debug] [Thread-3 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (compile): 20:36:38.858202 => 20:36:38.863317
[0m20:36:38.863811 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (compile): 20:36:38.854323 => 20:36:38.863656
[0m20:36:38.864054 [debug] [Thread-3 (]: Began executing node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:36:38.864330 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:36:38.866799 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"
[0m20:36:38.869224 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.unique_dim_company_cik.ab80a865e2"
[0m20:36:38.869631 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:36:38.870023 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:36:38.954460 [debug] [Thread-2 (]: On test.sec_edgar.not_null_dim_company_cik.2b3d612d15: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_dim_company_cik.2b3d612d15"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
where cik is null



      
    ) dbt_internal_test
[0m20:36:39.042780 [debug] [Thread-3 (]: On test.sec_edgar.unique_dim_company_cik.ab80a865e2: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.unique_dim_company_cik.ab80a865e2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select cik as unique_field
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  where cik is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m20:36:39.835385 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:4a3c2e10-2bd6-4a56-a0ca-32e6bc9eeb31&page=queryresults
[0m20:36:40.237699 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:5afc3e6b-ae13-41b7-b551-29ba8526d0dc&page=queryresults
[0m20:36:40.339197 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:84990b26-2a4c-41e8-8bff-e81d5e4bb062&page=queryresults
[0m20:36:40.495765 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd (execute): 20:36:38.125871 => 20:36:40.495491
[0m20:36:40.496528 [info ] [Thread-1 (]: 8 of 14 PASS not_null_int_companyfacts_normalized_period_end_date .............. [[32mPASS[0m in 2.38s]
[0m20:36:40.496960 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd
[0m20:36:40.497393 [debug] [Thread-4 (]: Began running node model.sec_edgar.dim_concept
[0m20:36:40.497726 [info ] [Thread-4 (]: 11 of 14 START sql view model sec_curated_sec_curated.dim_concept .............. [RUN]
[0m20:36:40.498047 [debug] [Thread-1 (]: Began running node model.sec_edgar.fct_financials_quarterly
[0m20:36:40.498538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.sec_edgar.dim_company, now model.sec_edgar.dim_concept)
[0m20:36:40.498895 [info ] [Thread-1 (]: 12 of 14 START sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [RUN]
[0m20:36:40.499194 [debug] [Thread-4 (]: Began compiling node model.sec_edgar.dim_concept
[0m20:36:40.499649 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_int_companyfacts_normalized_period_end_date.9dfecd3dcd, now model.sec_edgar.fct_financials_quarterly)
[0m20:36:40.501893 [debug] [Thread-4 (]: Writing injected SQL for node "model.sec_edgar.dim_concept"
[0m20:36:40.502194 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.fct_financials_quarterly
[0m20:36:40.506132 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.fct_financials_quarterly"
[0m20:36:40.506590 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_concept (compile): 20:36:40.499833 => 20:36:40.506441
[0m20:36:40.506870 [debug] [Thread-4 (]: Began executing node model.sec_edgar.dim_concept
[0m20:36:40.507167 [debug] [Thread-1 (]: Timing info for model.sec_edgar.fct_financials_quarterly (compile): 20:36:40.502430 => 20:36:40.507014
[0m20:36:40.509288 [debug] [Thread-4 (]: Writing runtime sql for node "model.sec_edgar.dim_concept"
[0m20:36:40.509575 [debug] [Thread-1 (]: Began executing node model.sec_edgar.fct_financials_quarterly
[0m20:36:40.529151 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:36:40.534193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:40.704875 [debug] [Thread-4 (]: On model.sec_edgar.dim_concept: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.dim_concept"} */


  create or replace view `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_concept`
  OPTIONS()
  as select concept,
  case concept
    when 'us-gaap:Revenues' then 'Revenue'
    when 'us-gaap:SalesRevenueNet' then 'Revenue'
    when 'us-gaap:CostOfRevenue' then 'Cost of Revenue'
    when 'us-gaap:GrossProfit' then 'Gross Profit'
    when 'us-gaap:NetIncomeLoss' then 'Net Income'
    when 'us-gaap:EarningsPerShareDiluted' then 'EPS (Diluted)'
    else concept
  end as concept_label
from (select distinct concept from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized`);


[0m20:36:40.907930 [debug] [Thread-3 (]: Timing info for test.sec_edgar.unique_dim_company_cik.ab80a865e2 (execute): 20:36:38.864494 => 20:36:40.907592
[0m20:36:40.908951 [info ] [Thread-3 (]: 10 of 14 PASS unique_dim_company_cik ........................................... [[32mPASS[0m in 2.06s]
[0m20:36:40.909405 [debug] [Thread-3 (]: Finished running node test.sec_edgar.unique_dim_company_cik.ab80a865e2
[0m20:36:41.169642 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.fct_financials_quarterly"
[0m20:36:41.171746 [debug] [Thread-1 (]: On model.sec_edgar.fct_financials_quarterly: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "model.sec_edgar.fct_financials_quarterly"} */
-- back compat for old kwarg name
  
  
        
    

    

    merge into `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly` as DBT_INTERNAL_DEST
        using (
with base as (
  select
    n.cik, n.ticker, n.concept, n.unit,
    n.period_end_date, n.value, n.accn, n.filed, n.fy, n.fp, n.form
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`int_companyfacts_normalized` n
  where n.fp in ('Q1','Q2','Q3','Q4') or n.form in ('10-Q','10-K')
)
select * from base

where period_end_date > (select ifnull(max(period_end_date), date('2000-01-01')) from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`)

        ) as DBT_INTERNAL_SOURCE
        on (FALSE)

    

    when not matched then insert
        (`cik`, `ticker`, `concept`, `unit`, `period_end_date`, `value`, `accn`, `filed`, `fy`, `fp`, `form`)
    values
        (`cik`, `ticker`, `concept`, `unit`, `period_end_date`, `value`, `accn`, `filed`, `fy`, `fp`, `form`)


    
[0m20:36:41.366449 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_dim_company_cik.2b3d612d15 (execute): 20:36:38.865374 => 20:36:41.365402
[0m20:36:41.367625 [info ] [Thread-2 (]: 9 of 14 PASS not_null_dim_company_cik .......................................... [[32mPASS[0m in 2.51s]
[0m20:36:41.368121 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_dim_company_cik.2b3d612d15
[0m20:36:41.472608 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:b82e5acf-a903-4500-9356-77cc76086da9&page=queryresults
[0m20:36:41.870722 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:037502d9-20ac-45c7-8b19-033a12efd635&page=queryresults
[0m20:36:42.035077 [debug] [Thread-4 (]: Timing info for model.sec_edgar.dim_concept (execute): 20:36:40.507334 => 20:36:42.034861
[0m20:36:42.036012 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2b8320>]}
[0m20:36:42.036544 [info ] [Thread-4 (]: 11 of 14 OK created sql view model sec_curated_sec_curated.dim_concept ......... [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m20:36:42.036984 [debug] [Thread-4 (]: Finished running node model.sec_edgar.dim_concept
[0m20:36:46.451921 [debug] [Thread-1 (]: Timing info for model.sec_edgar.fct_financials_quarterly (execute): 20:36:40.509807 => 20:36:46.451685
[0m20:36:46.453210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1fef245-57d9-453d-a5fe-e2f57615a430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6751f0>]}
[0m20:36:46.453824 [info ] [Thread-1 (]: 12 of 14 OK created sql incremental model sec_curated_sec_curated.fct_financials_quarterly  [[32mMERGE (0.0 rows, 567.2 KiB processed)[0m in 5.95s]
[0m20:36:46.454323 [debug] [Thread-1 (]: Finished running node model.sec_edgar.fct_financials_quarterly
[0m20:36:46.455308 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:36:46.455733 [debug] [Thread-2 (]: Began running node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:36:46.456063 [info ] [Thread-3 (]: 13 of 14 START test not_null_fct_financials_quarterly_period_end_date .......... [RUN]
[0m20:36:46.456362 [info ] [Thread-2 (]: 14 of 14 START test relationships_fct_financials_quarterly_cik__cik__ref_dim_company_  [RUN]
[0m20:36:46.456853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.unique_dim_company_cik.ab80a865e2, now test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01)
[0m20:36:46.457297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_dim_company_cik.2b3d612d15, now test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e)
[0m20:36:46.457561 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:36:46.457810 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:36:46.461525 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m20:36:46.465851 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"
[0m20:36:46.467831 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (compile): 20:36:46.457971 => 20:36:46.467587
[0m20:36:46.468173 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:36:46.468514 [debug] [Thread-2 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e (compile): 20:36:46.461805 => 20:36:46.468326
[0m20:36:46.470234 [debug] [Thread-2 (]: Began executing node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:36:46.472279 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"
[0m20:36:46.474861 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"
[0m20:36:46.477863 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:36:46.478388 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:36:46.648623 [debug] [Thread-3 (]: On test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select period_end_date
from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
where period_end_date is null



      
    ) dbt_internal_test
[0m20:36:46.649194 [debug] [Thread-2 (]: On test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "dev", "node_id": "test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select cik as from_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
    where cik is not null
),

parent as (
    select cik as to_field
    from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:36:47.651896 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:0518dd3d-e926-4bd8-8f94-7bd722a571ea&page=queryresults
[0m20:36:48.262553 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01 (execute): 20:36:46.468715 => 20:36:48.262066
[0m20:36:48.263803 [info ] [Thread-3 (]: 13 of 14 PASS not_null_fct_financials_quarterly_period_end_date ................ [[32mPASS[0m in 1.81s]
[0m20:36:48.264294 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01
[0m20:36:48.316678 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:df9ee13d-9454-4073-baf7-223f52bddf95&page=queryresults
[0m20:36:48.922859 [debug] [Thread-2 (]: Timing info for test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e (execute): 20:36:46.470638 => 20:36:48.922458
[0m20:36:48.923954 [info ] [Thread-2 (]: 14 of 14 PASS relationships_fct_financials_quarterly_cik__cik__ref_dim_company_  [[32mPASS[0m in 2.47s]
[0m20:36:48.924411 [debug] [Thread-2 (]: Finished running node test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e
[0m20:36:48.926497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:48.927040 [debug] [MainThread]: Connection 'model.sec_edgar.fct_financials_quarterly' was properly closed.
[0m20:36:48.927399 [debug] [MainThread]: Connection 'test.sec_edgar.relationships_fct_financials_quarterly_cik__cik__ref_dim_company_.9367db2f8e' was properly closed.
[0m20:36:48.927731 [debug] [MainThread]: Connection 'model.sec_edgar.dim_concept' was properly closed.
[0m20:36:48.928043 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_fct_financials_quarterly_period_end_date.15c2900e01' was properly closed.
[0m20:36:48.928429 [info ] [MainThread]: 
[0m20:36:48.928815 [info ] [MainThread]: Finished running 5 view models, 8 tests, 1 incremental model in 0 hours 0 minutes and 16.85 seconds (16.85s).
[0m20:36:48.930940 [debug] [MainThread]: Command end result
[0m20:36:48.939109 [info ] [MainThread]: 
[0m20:36:48.939496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:48.939738 [info ] [MainThread]: 
[0m20:36:48.939997 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 TOTAL=14
[0m20:36:48.940416 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 21.47783, "process_user_time": 6.537589, "process_kernel_time": 2.109194, "process_mem_max_rss": "268206080", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:36:48.940754 [debug] [MainThread]: Command `dbt build` succeeded at 20:36:48.940671 after 21.48 seconds
[0m20:36:48.941039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6e01d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3e8d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3e93a0>]}
[0m20:36:48.941307 [debug] [MainThread]: Flushing usage events
[0m10:51:33.498463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b108ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15cce0>]}


============================== 10:51:33.513394 | 55f0d6be-0e49-4d5a-bfb3-6d457d576fbf ==============================
[0m10:51:33.513394 [info ] [MainThread]: Running with dbt=1.7.15
[0m10:51:33.513945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'dbt/logs', 'version_check': 'True', 'profiles_dir': './dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt --select marts_viz', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:51:45.884988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55f0d6be-0e49-4d5a-bfb3-6d457d576fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa0d1c0>]}
[0m10:51:45.920866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55f0d6be-0e49-4d5a-bfb3-6d457d576fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fde2f30>]}
[0m10:51:45.922592 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m10:51:45.983629 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m10:51:46.022162 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m10:51:46.022578 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m10:51:46.022873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55f0d6be-0e49-4d5a-bfb3-6d457d576fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fa2c380>]}
[0m10:51:47.012159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55f0d6be-0e49-4d5a-bfb3-6d457d576fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c2d1fa0>]}
[0m10:51:47.023960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55f0d6be-0e49-4d5a-bfb3-6d457d576fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fe6a1e0>]}
[0m10:51:47.024348 [info ] [MainThread]: Found 9 models, 21 tests, 2 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m10:51:47.025898 [info ] [MainThread]: 
[0m10:51:47.026481 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:51:47.027375 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m10:51:47.027701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:49.417384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now create_sec-edgar-financials-warehouse_sec_curated_sec_viz)
[0m10:51:49.418264 [debug] [ThreadPool]: Creating schema "database: "sec-edgar-financials-warehouse"
schema: "sec_curated_sec_viz"
"
[0m10:51:49.425169 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:49.425537 [debug] [ThreadPool]: On create_sec-edgar-financials-warehouse_sec_curated_sec_viz: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "connection_name": "create_sec-edgar-financials-warehouse_sec_curated_sec_viz"} */
create schema if not exists `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`
  
[0m10:51:50.019156 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:8182b5a0-ebd9-4b29-a0ce-41e9152e450f&page=queryresults
[0m10:51:51.018980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_sec-edgar-financials-warehouse_sec_curated_sec_viz, now list_sec-edgar-financials-warehouse_sec_curated_sec_curated)
[0m10:51:51.019646 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse_sec_curated_sec_viz'
[0m10:51:51.020212 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse_sec_curated_sec_raw'
[0m10:51:51.020546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:51:51.020943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:51.021207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:51:51.631844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f0d6be-0e49-4d5a-bfb3-6d457d576fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c25bd10>]}
[0m10:51:51.635749 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m10:51:51.636150 [info ] [MainThread]: 
[0m10:51:51.646520 [debug] [Thread-1 (]: Began running node model.sec_edgar.company_dim
[0m10:51:51.646875 [debug] [Thread-2 (]: Began running node model.sec_edgar.kpi_company_latest
[0m10:51:51.647195 [debug] [Thread-3 (]: Began running node model.sec_edgar.kpi_ttm_revenue
[0m10:51:51.647630 [info ] [Thread-1 (]: 1 of 16 START sql table model sec_curated_sec_viz.company_dim .................. [RUN]
[0m10:51:51.648002 [info ] [Thread-2 (]: 2 of 16 START sql table model sec_curated_sec_viz.kpi_company_latest ........... [RUN]
[0m10:51:51.648822 [info ] [Thread-3 (]: 3 of 16 START sql table model sec_curated_sec_viz.kpi_ttm_revenue .............. [RUN]
[0m10:51:51.650039 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_curated, now model.sec_edgar.company_dim)
[0m10:51:51.650831 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_viz, now model.sec_edgar.kpi_company_latest)
[0m10:51:51.651614 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_raw, now model.sec_edgar.kpi_ttm_revenue)
[0m10:51:51.652182 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.company_dim
[0m10:51:51.652666 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.kpi_company_latest
[0m10:51:51.652989 [debug] [Thread-3 (]: Began compiling node model.sec_edgar.kpi_ttm_revenue
[0m10:51:51.664533 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.company_dim"
[0m10:51:51.667521 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.kpi_company_latest"
[0m10:51:51.672125 [debug] [Thread-3 (]: Writing injected SQL for node "model.sec_edgar.kpi_ttm_revenue"
[0m10:51:51.672945 [debug] [Thread-1 (]: Timing info for model.sec_edgar.company_dim (compile): 10:51:51.653212 => 10:51:51.672735
[0m10:51:51.673321 [debug] [Thread-1 (]: Began executing node model.sec_edgar.company_dim
[0m10:51:51.673736 [debug] [Thread-2 (]: Timing info for model.sec_edgar.kpi_company_latest (compile): 10:51:51.654323 => 10:51:51.673523
[0m10:51:51.680993 [debug] [Thread-3 (]: Timing info for model.sec_edgar.kpi_ttm_revenue (compile): 10:51:51.654439 => 10:51:51.680802
[0m10:51:51.697104 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.company_dim"
[0m10:51:51.697481 [debug] [Thread-2 (]: Began executing node model.sec_edgar.kpi_company_latest
[0m10:51:51.697781 [debug] [Thread-3 (]: Began executing node model.sec_edgar.kpi_ttm_revenue
[0m10:51:51.700029 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.kpi_company_latest"
[0m10:51:51.702288 [debug] [Thread-3 (]: Writing runtime sql for node "model.sec_edgar.kpi_ttm_revenue"
[0m10:51:51.702922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:51:51.703201 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:51:51.703662 [debug] [Thread-1 (]: On model.sec_edgar.company_dim: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.company_dim"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
      
    
    

    OPTIONS()
    as (
      

with company_base as (
  select 
    cik,
    ticker,
    name as company_name,
    sic,
    sic_description,
    ein,
    category,
    fiscal_year_end,
    state_of_incorporation,
    state_of_incorporation_description
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  where ticker is not null
),
latest_filing as (
  select 
    cik,
    max(period_end_date) as latest_filing_date,
    count(distinct period_end_date) as total_quarters_filed
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  group by cik
),
revenue_summary as (
  select 
    cik,
    count(distinct case when concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax') then period_end_date end) as revenue_quarters_count,
    max(case when concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax') then period_end_date end) as latest_revenue_date
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  where value > 0
  group by cik
)
select 
  cb.cik,
  cb.ticker,
  cb.company_name,
  cb.sic,
  cb.sic_description,
  cb.ein,
  cb.category,
  cb.fiscal_year_end,
  cb.state_of_incorporation,
  cb.state_of_incorporation_description,
  lf.latest_filing_date,
  lf.total_quarters_filed,
  coalesce(rs.revenue_quarters_count, 0) as revenue_quarters_count,
  rs.latest_revenue_date,
  case 
    when rs.revenue_quarters_count >= 4 then 'Active'
    when rs.revenue_quarters_count >= 1 then 'Limited Data'
    else 'No Revenue Data'
  end as data_completeness,
  current_timestamp() as refreshed_at
from company_base cb
left join latest_filing lf on cb.cik = lf.cik
left join revenue_summary rs on cb.cik = rs.cik
order by cb.ticker
    );
  
[0m10:51:51.704036 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:51:51.704387 [debug] [Thread-2 (]: On model.sec_edgar.kpi_company_latest: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.kpi_company_latest"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
      
    
    

    OPTIONS()
    as (
      

with latest_quarters as (
  select 
    cik,
    ticker,
    max(period_end_date) as latest_quarter
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  group by cik, ticker
),
revenue_data as (
  select 
    f.cik,
    f.ticker,
    f.period_end_date,
    f.value as revenue,
    f.fy,
    f.fp
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly` f
  join latest_quarters lq on f.cik = lq.cik and f.period_end_date = lq.latest_quarter
  where f.concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax')
    and f.value > 0
),
company_info as (
  select 
    cik,
    ticker,
    name as company_name,
    sic,
    sic_description
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)
select 
  ci.cik,
  ci.ticker,
  ci.company_name,
  ci.sic,
  ci.sic_description,
  rd.period_end_date as latest_quarter,
  rd.revenue as latest_revenue,
  rd.fy as fiscal_year,
  rd.fp as fiscal_period,
  current_timestamp() as refreshed_at
from company_info ci
left join revenue_data rd on ci.cik = rd.cik
where ci.ticker is not null
order by rd.revenue desc
    );
  
[0m10:51:51.705335 [debug] [Thread-3 (]: On model.sec_edgar.kpi_ttm_revenue: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.kpi_ttm_revenue"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
  select 
    cik,
    ticker,
    period_end_date,
    value as revenue,
    fy,
    fp
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  where concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax')
    and value > 0
    and fp in ('Q1', 'Q2', 'Q3', 'Q4')
),
latest_quarters as (
  select 
    cik,
    ticker,
    max(period_end_date) as latest_quarter
  from quarterly_revenue
  group by cik, ticker
),
ttm_calculation as (
  select 
    qr.cik,
    qr.ticker,
    sum(qr.revenue) as ttm_revenue,
    count(*) as quarters_count,
    max(qr.period_end_date) as latest_quarter_date,
    string_agg(concat(cast(qr.fy as string), '-', qr.fp), ', ' order by qr.period_end_date) as ttm_periods
  from quarterly_revenue qr
  join latest_quarters lq on qr.cik = lq.cik
  where qr.period_end_date > date_sub(lq.latest_quarter, interval 365 day)
    and qr.period_end_date <= lq.latest_quarter
  group by qr.cik, qr.ticker
  having count(*) >= 3
),
company_info as (
  select 
    cik,
    ticker,
    name as company_name,
    sic,
    sic_description
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)
select 
  ci.cik,
  ci.ticker,
  ci.company_name,
  ci.sic,
  ci.sic_description,
  ttm.ttm_revenue,
  ttm.quarters_count,
  ttm.latest_quarter_date,
  ttm.ttm_periods,
  round(ttm.ttm_revenue / 1000000000, 2) as ttm_revenue_billions,
  current_timestamp() as refreshed_at
from company_info ci
join ttm_calculation ttm on ci.cik = ttm.cik
where ci.ticker is not null
order by ttm.ttm_revenue desc
    );
  
[0m10:51:52.999077 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:d4d41136-586f-4e9e-a8dd-36684a98059c&page=queryresults
[0m10:51:53.008008 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:341ddc39-1188-46cf-936e-5e35bc8906af&page=queryresults
[0m10:51:53.040583 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:4cd0ad3c-2808-4f0a-b7bd-00da0a68dd76&page=queryresults
[0m10:51:53.216597 [debug] [Thread-2 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: name at [40:5]; reason: invalidQuery, location: query, message: Unrecognized name: name at [40:5]')
[0m10:51:53.248638 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: name at [19:5]; reason: invalidQuery, location: query, message: Unrecognized name: name at [19:5]')
[0m10:51:53.291468 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: name at [55:5]; reason: invalidQuery, location: query, message: Unrecognized name: name at [55:5]')
[0m10:51:54.686182 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:bbf39dc1-21df-44cc-a699-3df16104f415&page=queryresults
[0m10:51:54.747962 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:2c885e4e-ac71-4229-b118-5fa04c7ee1a3&page=queryresults
[0m10:51:54.893335 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:bbf39dc1-21df-44cc-a699-3df16104f415&page=queryresults
[0m10:51:54.894288 [debug] [Thread-2 (]: Timing info for model.sec_edgar.kpi_company_latest (execute): 10:51:51.698056 => 10:51:54.894086
[0m10:51:54.984535 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:2c885e4e-ac71-4229-b118-5fa04c7ee1a3&page=queryresults
[0m10:51:54.986663 [debug] [Thread-3 (]: Timing info for model.sec_edgar.kpi_ttm_revenue (execute): 10:51:51.700285 => 10:51:54.986188
[0m10:51:55.002729 [debug] [Thread-3 (]: Database Error in model kpi_ttm_revenue (models/marts_viz/kpi_ttm_revenue.sql)
  Unrecognized name: name at [55:5]
  compiled Code at target/run/sec_edgar/models/marts_viz/kpi_ttm_revenue.sql
[0m10:51:55.004112 [debug] [Thread-2 (]: Database Error in model kpi_company_latest (models/marts_viz/kpi_company_latest.sql)
  Unrecognized name: name at [40:5]
  compiled Code at target/run/sec_edgar/models/marts_viz/kpi_company_latest.sql
[0m10:51:55.004723 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f0d6be-0e49-4d5a-bfb3-6d457d576fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12fff9d30>]}
[0m10:51:55.005060 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f0d6be-0e49-4d5a-bfb3-6d457d576fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c56e240>]}
[0m10:51:55.005665 [error] [Thread-3 (]: 3 of 16 ERROR creating sql table model sec_curated_sec_viz.kpi_ttm_revenue ..... [[31mERROR[0m in 3.35s]
[0m10:51:55.006750 [error] [Thread-2 (]: 2 of 16 ERROR creating sql table model sec_curated_sec_viz.kpi_company_latest .. [[31mERROR[0m in 3.35s]
[0m10:51:55.007797 [debug] [Thread-3 (]: Finished running node model.sec_edgar.kpi_ttm_revenue
[0m10:51:55.008522 [debug] [Thread-2 (]: Finished running node model.sec_edgar.kpi_company_latest
[0m10:51:55.010173 [debug] [Thread-4 (]: Began running node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:51:55.010582 [info ] [Thread-4 (]: 4 of 16 SKIP test accepted_values_kpi_ttm_revenue_quarters_count__3__4 ......... [[33mSKIP[0m]
[0m10:51:55.010910 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:51:55.011200 [debug] [Thread-4 (]: Finished running node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:51:55.011446 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:51:55.011736 [info ] [Thread-3 (]: 5 of 16 SKIP test not_null_kpi_ttm_revenue_cik ................................. [[33mSKIP[0m]
[0m10:51:55.012043 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:51:55.012324 [info ] [Thread-2 (]: 6 of 16 SKIP test not_null_kpi_ttm_revenue_ticker .............................. [[33mSKIP[0m]
[0m10:51:55.012641 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:51:55.012905 [info ] [Thread-4 (]: 7 of 16 SKIP test not_null_kpi_ttm_revenue_ttm_revenue ......................... [[33mSKIP[0m]
[0m10:51:55.013194 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:51:55.013470 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:51:55.013740 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:51:55.014053 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301
[0m10:51:55.014363 [info ] [Thread-3 (]: 8 of 16 SKIP test not_null_kpi_company_latest_cik .............................. [[33mSKIP[0m]
[0m10:51:55.014667 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0
[0m10:51:55.014969 [info ] [Thread-2 (]: 9 of 16 SKIP test not_null_kpi_company_latest_latest_quarter ................... [[33mSKIP[0m]
[0m10:51:55.015431 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:51:55.015916 [info ] [Thread-4 (]: 10 of 16 SKIP test not_null_kpi_company_latest_latest_revenue .................. [[33mSKIP[0m]
[0m10:51:55.016397 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301
[0m10:51:55.016856 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:51:55.017305 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0
[0m10:51:55.017701 [info ] [Thread-3 (]: 11 of 16 SKIP test not_null_kpi_company_latest_ticker .......................... [[33mSKIP[0m]
[0m10:51:55.018259 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:51:55.028411 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3649403a-c9e3-40e6-92b9-df1c7aab6a6d&page=queryresults
[0m10:51:55.285609 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3649403a-c9e3-40e6-92b9-df1c7aab6a6d&page=queryresults
[0m10:51:55.286220 [debug] [Thread-1 (]: Timing info for model.sec_edgar.company_dim (execute): 10:51:51.673970 => 10:51:55.286052
[0m10:51:55.288654 [debug] [Thread-1 (]: Database Error in model company_dim (models/marts_viz/company_dim.sql)
  Unrecognized name: name at [19:5]
  compiled Code at target/run/sec_edgar/models/marts_viz/company_dim.sql
[0m10:51:55.288975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f0d6be-0e49-4d5a-bfb3-6d457d576fbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c2a3530>]}
[0m10:51:55.289390 [error] [Thread-1 (]: 1 of 16 ERROR creating sql table model sec_curated_sec_viz.company_dim ......... [[31mERROR[0m in 3.64s]
[0m10:51:55.289772 [debug] [Thread-1 (]: Finished running node model.sec_edgar.company_dim
[0m10:51:55.290403 [debug] [Thread-2 (]: Began running node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:51:55.290722 [info ] [Thread-2 (]: 12 of 16 SKIP test accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data  [[33mSKIP[0m]
[0m10:51:55.291142 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:51:55.291433 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:51:55.291707 [debug] [Thread-2 (]: Finished running node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:51:55.291949 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:51:55.292247 [info ] [Thread-4 (]: 13 of 16 SKIP test not_null_company_dim_cik .................................... [[33mSKIP[0m]
[0m10:51:55.292565 [info ] [Thread-3 (]: 14 of 16 SKIP test not_null_company_dim_company_name ........................... [[33mSKIP[0m]
[0m10:51:55.292866 [debug] [Thread-2 (]: Began running node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:51:55.293230 [info ] [Thread-1 (]: 15 of 16 SKIP test not_null_company_dim_ticker ................................. [[33mSKIP[0m]
[0m10:51:55.293583 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:51:55.293860 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:51:55.294258 [info ] [Thread-2 (]: 16 of 16 SKIP test unique_company_dim_cik ...................................... [[33mSKIP[0m]
[0m10:51:55.294692 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:51:55.295207 [debug] [Thread-2 (]: Finished running node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:51:55.296629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:51:55.296912 [debug] [MainThread]: Connection 'model.sec_edgar.company_dim' was properly closed.
[0m10:51:55.297136 [debug] [MainThread]: Connection 'model.sec_edgar.kpi_company_latest' was properly closed.
[0m10:51:55.297348 [debug] [MainThread]: Connection 'model.sec_edgar.kpi_ttm_revenue' was properly closed.
[0m10:51:55.297616 [info ] [MainThread]: 
[0m10:51:55.297880 [info ] [MainThread]: Finished running 3 table models, 13 tests in 0 hours 0 minutes and 8.27 seconds (8.27s).
[0m10:51:55.298722 [debug] [MainThread]: Command end result
[0m10:51:55.306414 [info ] [MainThread]: 
[0m10:51:55.306792 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:51:55.307039 [info ] [MainThread]: 
[0m10:51:55.307272 [error] [MainThread]:   Database Error in model kpi_ttm_revenue (models/marts_viz/kpi_ttm_revenue.sql)
  Unrecognized name: name at [55:5]
  compiled Code at target/run/sec_edgar/models/marts_viz/kpi_ttm_revenue.sql
[0m10:51:55.307497 [info ] [MainThread]: 
[0m10:51:55.307715 [error] [MainThread]:   Database Error in model kpi_company_latest (models/marts_viz/kpi_company_latest.sql)
  Unrecognized name: name at [40:5]
  compiled Code at target/run/sec_edgar/models/marts_viz/kpi_company_latest.sql
[0m10:51:55.307926 [info ] [MainThread]: 
[0m10:51:55.308136 [error] [MainThread]:   Database Error in model company_dim (models/marts_viz/company_dim.sql)
  Unrecognized name: name at [19:5]
  compiled Code at target/run/sec_edgar/models/marts_viz/company_dim.sql
[0m10:51:55.308356 [info ] [MainThread]: 
[0m10:51:55.308599 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=13 TOTAL=16
[0m10:51:55.309021 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 21.968264, "process_user_time": 5.600157, "process_kernel_time": 2.914806, "process_mem_max_rss": "248004608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:51:55.309362 [debug] [MainThread]: Command `dbt build` failed at 10:51:55.309281 after 21.97 seconds
[0m10:51:55.309661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b15cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adb3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad876e0>]}
[0m10:51:55.309929 [debug] [MainThread]: Flushing usage events
[0m10:52:38.564625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107948ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797bdd0>]}


============================== 10:52:38.568986 | bd36e399-f7e7-4c2a-8ea1-0941be98aba2 ==============================
[0m10:52:38.568986 [info ] [MainThread]: Running with dbt=1.7.15
[0m10:52:38.569435 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': './dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt --select marts_viz', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:52:40.944620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd36e399-f7e7-4c2a-8ea1-0941be98aba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132dea510>]}
[0m10:52:40.979665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd36e399-f7e7-4c2a-8ea1-0941be98aba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d3f170>]}
[0m10:52:40.980698 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m10:52:40.996739 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m10:52:41.098877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m10:52:41.099493 [debug] [MainThread]: Partial parsing: updated file: sec_edgar://models/marts_viz/company_dim.sql
[0m10:52:41.099826 [debug] [MainThread]: Partial parsing: updated file: sec_edgar://models/marts_viz/kpi_company_latest.sql
[0m10:52:41.100127 [debug] [MainThread]: Partial parsing: updated file: sec_edgar://models/marts_viz/kpi_ttm_revenue.sql
[0m10:52:41.311620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd36e399-f7e7-4c2a-8ea1-0941be98aba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134b0fb00>]}
[0m10:52:41.321737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd36e399-f7e7-4c2a-8ea1-0941be98aba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134ba0170>]}
[0m10:52:41.322117 [info ] [MainThread]: Found 9 models, 21 tests, 2 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m10:52:41.323647 [info ] [MainThread]: 
[0m10:52:41.324251 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:52:41.325094 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m10:52:41.325399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:43.107198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_raw)
[0m10:52:43.108645 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse_sec_curated_sec_curated'
[0m10:52:43.109320 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse_sec_curated_sec_viz'
[0m10:52:43.109709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:52:43.110004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:43.110242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:52:43.663320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd36e399-f7e7-4c2a-8ea1-0941be98aba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1428fc5f0>]}
[0m10:52:43.664103 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m10:52:43.664385 [info ] [MainThread]: 
[0m10:52:43.666461 [debug] [Thread-1 (]: Began running node model.sec_edgar.company_dim
[0m10:52:43.666782 [debug] [Thread-2 (]: Began running node model.sec_edgar.kpi_company_latest
[0m10:52:43.667045 [debug] [Thread-3 (]: Began running node model.sec_edgar.kpi_ttm_revenue
[0m10:52:43.667414 [info ] [Thread-1 (]: 1 of 16 START sql table model sec_curated_sec_viz.company_dim .................. [RUN]
[0m10:52:43.667957 [info ] [Thread-2 (]: 2 of 16 START sql table model sec_curated_sec_viz.kpi_company_latest ........... [RUN]
[0m10:52:43.668366 [info ] [Thread-3 (]: 3 of 16 START sql table model sec_curated_sec_viz.kpi_ttm_revenue .............. [RUN]
[0m10:52:43.668926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_raw, now model.sec_edgar.company_dim)
[0m10:52:43.669424 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_curated, now model.sec_edgar.kpi_company_latest)
[0m10:52:43.669878 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_viz, now model.sec_edgar.kpi_ttm_revenue)
[0m10:52:43.670160 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.company_dim
[0m10:52:43.670415 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.kpi_company_latest
[0m10:52:43.670659 [debug] [Thread-3 (]: Began compiling node model.sec_edgar.kpi_ttm_revenue
[0m10:52:43.677079 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.company_dim"
[0m10:52:43.681189 [debug] [Thread-3 (]: Writing injected SQL for node "model.sec_edgar.kpi_ttm_revenue"
[0m10:52:43.682923 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.kpi_company_latest"
[0m10:52:43.683760 [debug] [Thread-1 (]: Timing info for model.sec_edgar.company_dim (compile): 10:52:43.670826 => 10:52:43.683523
[0m10:52:43.684162 [debug] [Thread-1 (]: Began executing node model.sec_edgar.company_dim
[0m10:52:43.701445 [debug] [Thread-3 (]: Timing info for model.sec_edgar.kpi_ttm_revenue (compile): 10:52:43.679093 => 10:52:43.701238
[0m10:52:43.701839 [debug] [Thread-2 (]: Timing info for model.sec_edgar.kpi_company_latest (compile): 10:52:43.677152 => 10:52:43.701637
[0m10:52:43.711175 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.company_dim"
[0m10:52:43.711560 [debug] [Thread-3 (]: Began executing node model.sec_edgar.kpi_ttm_revenue
[0m10:52:43.711835 [debug] [Thread-2 (]: Began executing node model.sec_edgar.kpi_company_latest
[0m10:52:43.714007 [debug] [Thread-3 (]: Writing runtime sql for node "model.sec_edgar.kpi_ttm_revenue"
[0m10:52:43.715917 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.kpi_company_latest"
[0m10:52:43.716248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:43.716847 [debug] [Thread-1 (]: On model.sec_edgar.company_dim: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.company_dim"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
      
    
    

    OPTIONS()
    as (
      

with company_base as (
  select 
    cik,
    ticker,
    company_name
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  where ticker is not null
),
latest_filing as (
  select 
    cik,
    max(period_end_date) as latest_filing_date,
    count(distinct period_end_date) as total_quarters_filed
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  group by cik
),
revenue_summary as (
  select 
    cik,
    count(distinct case when concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax') then period_end_date end) as revenue_quarters_count,
    max(case when concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax') then period_end_date end) as latest_revenue_date
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  where value > 0
  group by cik
)
select 
  cb.cik,
  cb.ticker,
  cb.company_name,
  lf.latest_filing_date,
  lf.total_quarters_filed,
  coalesce(rs.revenue_quarters_count, 0) as revenue_quarters_count,
  rs.latest_revenue_date,
  case 
    when rs.revenue_quarters_count >= 4 then 'Active'
    when rs.revenue_quarters_count >= 1 then 'Limited Data'
    else 'No Revenue Data'
  end as data_completeness,
  current_timestamp() as refreshed_at
from company_base cb
left join latest_filing lf on cb.cik = lf.cik
left join revenue_summary rs on cb.cik = rs.cik
order by cb.ticker
    );
  
[0m10:52:43.717472 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:52:43.718024 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:52:43.718584 [debug] [Thread-2 (]: On model.sec_edgar.kpi_company_latest: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.kpi_company_latest"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
      
    
    

    OPTIONS()
    as (
      

with latest_quarters as (
  select 
    cik,
    ticker,
    max(period_end_date) as latest_quarter
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  group by cik, ticker
),
revenue_data as (
  select 
    f.cik,
    f.ticker,
    f.period_end_date,
    f.value as revenue,
    f.fy,
    f.fp
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly` f
  join latest_quarters lq on f.cik = lq.cik and f.period_end_date = lq.latest_quarter
  where f.concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax')
    and f.value > 0
),
company_info as (
  select 
    cik,
    ticker,
    company_name
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)
select 
  ci.cik,
  ci.ticker,
  ci.company_name,
  rd.period_end_date as latest_quarter,
  rd.revenue as latest_revenue,
  rd.fy as fiscal_year,
  rd.fp as fiscal_period,
  current_timestamp() as refreshed_at
from company_info ci
left join revenue_data rd on ci.cik = rd.cik
where ci.ticker is not null
order by rd.revenue desc
    );
  
[0m10:52:43.719073 [debug] [Thread-3 (]: On model.sec_edgar.kpi_ttm_revenue: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.kpi_ttm_revenue"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
  select 
    cik,
    ticker,
    period_end_date,
    value as revenue,
    fy,
    fp
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  where concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax')
    and value > 0
    and fp in ('Q1', 'Q2', 'Q3', 'Q4')
),
latest_quarters as (
  select 
    cik,
    ticker,
    max(period_end_date) as latest_quarter
  from quarterly_revenue
  group by cik, ticker
),
ttm_calculation as (
  select 
    qr.cik,
    qr.ticker,
    sum(qr.revenue) as ttm_revenue,
    count(*) as quarters_count,
    max(qr.period_end_date) as latest_quarter_date,
    string_agg(concat(cast(qr.fy as string), '-', qr.fp), ', ' order by qr.period_end_date) as ttm_periods
  from quarterly_revenue qr
  join latest_quarters lq on qr.cik = lq.cik
  where qr.period_end_date > date_sub(lq.latest_quarter, interval 365 day)
    and qr.period_end_date <= lq.latest_quarter
  group by qr.cik, qr.ticker
  having count(*) >= 3
),
company_info as (
  select 
    cik,
    ticker,
    company_name
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)
select 
  ci.cik,
  ci.ticker,
  ci.company_name,
  ttm.ttm_revenue,
  ttm.quarters_count,
  ttm.latest_quarter_date,
  ttm.ttm_periods,
  round(ttm.ttm_revenue / 1000000000, 2) as ttm_revenue_billions,
  current_timestamp() as refreshed_at
from company_info ci
join ttm_calculation ttm on ci.cik = ttm.cik
where ci.ticker is not null
order by ttm.ttm_revenue desc
    );
  
[0m10:52:44.697657 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:09af5226-ffa1-4959-be21-838189850fc6&page=queryresults
[0m10:52:44.704060 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:429f8cdd-0415-4d62-9689-297cc41ec12d&page=queryresults
[0m10:52:44.741169 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:eb405288-46ce-4b39-937c-1f217a4c60c6&page=queryresults
[0m10:52:48.129421 [debug] [Thread-3 (]: Timing info for model.sec_edgar.kpi_ttm_revenue (execute): 10:52:43.712097 => 10:52:48.129025
[0m10:52:48.130630 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd36e399-f7e7-4c2a-8ea1-0941be98aba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x134dc09e0>]}
[0m10:52:48.131324 [info ] [Thread-3 (]: 3 of 16 OK created sql table model sec_curated_sec_viz.kpi_ttm_revenue ......... [[32mCREATE TABLE (0.0 rows, 1.0 MiB processed)[0m in 4.46s]
[0m10:52:48.132067 [debug] [Thread-3 (]: Finished running node model.sec_edgar.kpi_ttm_revenue
[0m10:52:48.132980 [debug] [Thread-4 (]: Began running node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:52:48.133465 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:52:48.133920 [info ] [Thread-4 (]: 4 of 16 START test accepted_values_kpi_ttm_revenue_quarters_count__3__4 ........ [RUN]
[0m10:52:48.134384 [info ] [Thread-3 (]: 5 of 16 START test not_null_kpi_ttm_revenue_cik ................................ [RUN]
[0m10:52:48.135246 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5'
[0m10:52:48.136053 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sec_edgar.kpi_ttm_revenue, now test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973)
[0m10:52:48.136675 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:52:48.137097 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:52:48.140780 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5"
[0m10:52:48.148454 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973"
[0m10:52:48.149885 [debug] [Thread-4 (]: Timing info for test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5 (compile): 10:52:48.137320 => 10:52:48.149685
[0m10:52:48.150321 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973 (compile): 10:52:48.142211 => 10:52:48.150127
[0m10:52:48.150693 [debug] [Thread-4 (]: Began executing node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:52:48.151026 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:52:48.161055 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5"
[0m10:52:48.163057 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973"
[0m10:52:48.163845 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:52:48.164140 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:52:48.164585 [debug] [Thread-3 (]: On test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
where cik is null



      
    ) dbt_internal_test
[0m10:52:48.164980 [debug] [Thread-4 (]: On test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        quarters_count as value_field,
        count(*) as n_records

    from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
    group by quarters_count

)

select *
from all_values
where value_field not in (
    '3','4'
)



      
    ) dbt_internal_test
[0m10:52:48.260738 [debug] [Thread-1 (]: Timing info for model.sec_edgar.company_dim (execute): 10:52:43.684443 => 10:52:48.260564
[0m10:52:48.261459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd36e399-f7e7-4c2a-8ea1-0941be98aba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1428ce3c0>]}
[0m10:52:48.261881 [info ] [Thread-1 (]: 1 of 16 OK created sql table model sec_curated_sec_viz.company_dim ............. [[32mCREATE TABLE (5.0 rows, 1.1 MiB processed)[0m in 4.59s]
[0m10:52:48.262282 [debug] [Thread-1 (]: Finished running node model.sec_edgar.company_dim
[0m10:52:48.262586 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:52:48.262966 [info ] [Thread-1 (]: 6 of 16 START test not_null_kpi_ttm_revenue_ticker ............................. [RUN]
[0m10:52:48.263438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.company_dim, now test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1)
[0m10:52:48.263688 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:52:48.266762 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1"
[0m10:52:48.267454 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1 (compile): 10:52:48.263842 => 10:52:48.267309
[0m10:52:48.267718 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:52:48.269342 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1"
[0m10:52:48.269776 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:48.270085 [debug] [Thread-1 (]: On test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
where ticker is null



      
    ) dbt_internal_test
[0m10:52:48.421831 [debug] [Thread-2 (]: Timing info for model.sec_edgar.kpi_company_latest (execute): 10:52:43.714230 => 10:52:48.421624
[0m10:52:48.422639 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd36e399-f7e7-4c2a-8ea1-0941be98aba2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142a5cce0>]}
[0m10:52:48.423156 [info ] [Thread-2 (]: 2 of 16 OK created sql table model sec_curated_sec_viz.kpi_company_latest ...... [[32mCREATE TABLE (5.0 rows, 1.0 MiB processed)[0m in 4.75s]
[0m10:52:48.423605 [debug] [Thread-2 (]: Finished running node model.sec_edgar.kpi_company_latest
[0m10:52:48.423952 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:52:48.424427 [info ] [Thread-2 (]: 7 of 16 START test not_null_kpi_ttm_revenue_ttm_revenue ........................ [RUN]
[0m10:52:48.425031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sec_edgar.kpi_company_latest, now test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93)
[0m10:52:48.425336 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:52:48.428687 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93"
[0m10:52:48.429358 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93 (compile): 10:52:48.425512 => 10:52:48.429209
[0m10:52:48.429630 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:52:48.431308 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93"
[0m10:52:48.431752 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:52:48.432064 [debug] [Thread-2 (]: On test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ttm_revenue
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
where ttm_revenue is null



      
    ) dbt_internal_test
[0m10:52:48.829645 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:96688e57-02cd-47d5-9a9a-db6652630f86&page=queryresults
[0m10:52:48.832045 [debug] [Thread-4 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]; reason: invalidQuery, location: query, message: No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]')
[0m10:52:49.074554 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:23bd4688-f413-4cc5-9296-1e407919503a&page=queryresults
[0m10:52:49.225463 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:f388783d-b5b4-492d-820f-6a9359d92430&page=queryresults
[0m10:52:49.452660 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3c0269b8-722e-4c6a-b807-fa12d2cdad56&page=queryresults
[0m10:52:49.807500 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:52fa0cf5-d92d-4585-86b4-5a3a5b36464a&page=queryresults
[0m10:52:49.808241 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:52fa0cf5-d92d-4585-86b4-5a3a5b36464a&page=queryresults
[0m10:52:49.809499 [debug] [Thread-4 (]: Timing info for test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5 (execute): 10:52:48.151236 => 10:52:49.809332
[0m10:52:49.823985 [debug] [Thread-4 (]: Database Error in test accepted_values_kpi_ttm_revenue_quarters_count__3__4 (models/marts_viz/viz.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
  compiled Code at target/run/sec_edgar/models/marts_viz/viz.yml/accepted_values_kpi_ttm_revenue_quarters_count__3__4.sql
[0m10:52:49.824509 [error] [Thread-4 (]: 4 of 16 ERROR accepted_values_kpi_ttm_revenue_quarters_count__3__4 ............. [[31mERROR[0m in 1.69s]
[0m10:52:49.824955 [debug] [Thread-4 (]: Finished running node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:52:49.825323 [debug] [Thread-4 (]: Began running node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:52:49.826024 [info ] [Thread-4 (]: 8 of 16 START test accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data  [RUN]
[0m10:52:49.826561 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5, now test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad)
[0m10:52:49.826847 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:52:49.830161 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad"
[0m10:52:49.830844 [debug] [Thread-4 (]: Timing info for test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad (compile): 10:52:49.827013 => 10:52:49.830687
[0m10:52:49.831121 [debug] [Thread-4 (]: Began executing node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:52:49.832771 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad"
[0m10:52:49.833231 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:52:49.833566 [debug] [Thread-4 (]: On test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        data_completeness as value_field,
        count(*) as n_records

    from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
    group by data_completeness

)

select *
from all_values
where value_field not in (
    'Active','Limited Data','No Revenue Data'
)



      
    ) dbt_internal_test
[0m10:52:49.941192 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973 (execute): 10:52:48.161367 => 10:52:49.940974
[0m10:52:49.941904 [info ] [Thread-3 (]: 5 of 16 PASS not_null_kpi_ttm_revenue_cik ...................................... [[32mPASS[0m in 1.81s]
[0m10:52:49.942311 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:52:49.942606 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:52:49.942920 [info ] [Thread-3 (]: 9 of 16 START test not_null_company_dim_cik .................................... [RUN]
[0m10:52:49.943435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973, now test.sec_edgar.not_null_company_dim_cik.1042ff3e8b)
[0m10:52:49.943709 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:52:49.946850 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_company_dim_cik.1042ff3e8b"
[0m10:52:49.947525 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_company_dim_cik.1042ff3e8b (compile): 10:52:49.943892 => 10:52:49.947382
[0m10:52:49.947786 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:52:49.949519 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_company_dim_cik.1042ff3e8b"
[0m10:52:49.949962 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:52:49.950262 [debug] [Thread-3 (]: On test.sec_edgar.not_null_company_dim_cik.1042ff3e8b: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_company_dim_cik.1042ff3e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
where cik is null



      
    ) dbt_internal_test
[0m10:52:49.988147 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1 (execute): 10:52:48.267878 => 10:52:49.987946
[0m10:52:49.988773 [info ] [Thread-1 (]: 6 of 16 PASS not_null_kpi_ttm_revenue_ticker ................................... [[32mPASS[0m in 1.73s]
[0m10:52:49.989178 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:52:49.989482 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:52:49.989785 [info ] [Thread-1 (]: 10 of 16 START test not_null_company_dim_company_name .......................... [RUN]
[0m10:52:49.990284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1, now test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce)
[0m10:52:49.990546 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:52:49.993612 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce"
[0m10:52:49.994193 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce (compile): 10:52:49.990703 => 10:52:49.994048
[0m10:52:49.994452 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:52:49.996058 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce"
[0m10:52:49.996499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:49.996801 [debug] [Thread-1 (]: On test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
where company_name is null



      
    ) dbt_internal_test
[0m10:52:50.359485 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93 (execute): 10:52:48.429793 => 10:52:50.359051
[0m10:52:50.360599 [info ] [Thread-2 (]: 7 of 16 PASS not_null_kpi_ttm_revenue_ttm_revenue .............................. [[32mPASS[0m in 1.94s]
[0m10:52:50.361062 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:52:50.361411 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:52:50.361797 [info ] [Thread-2 (]: 11 of 16 START test not_null_company_dim_ticker ................................ [RUN]
[0m10:52:50.362393 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93, now test.sec_edgar.not_null_company_dim_ticker.c89adc0564)
[0m10:52:50.362691 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:52:50.366704 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_company_dim_ticker.c89adc0564"
[0m10:52:50.367506 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_company_dim_ticker.c89adc0564 (compile): 10:52:50.362870 => 10:52:50.367355
[0m10:52:50.367781 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:52:50.369452 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_company_dim_ticker.c89adc0564"
[0m10:52:50.369915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:52:50.370236 [debug] [Thread-2 (]: On test.sec_edgar.not_null_company_dim_ticker.c89adc0564: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_company_dim_ticker.c89adc0564"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
where ticker is null



      
    ) dbt_internal_test
[0m10:52:51.024264 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:ebc8dfcd-449c-4475-ba9d-c0bcf0b9f125&page=queryresults
[0m10:52:51.042311 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:58befeaa-5d82-41df-aca6-e44d73a7dff9&page=queryresults
[0m10:52:51.067907 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:61e3e5f0-f581-4702-8f8d-604c298819af&page=queryresults
[0m10:52:51.345709 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:8cd96989-10f8-42ba-acf0-8925f6fb630e&page=queryresults
[0m10:52:51.860339 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce (execute): 10:52:49.994607 => 10:52:51.859245
[0m10:52:51.861407 [info ] [Thread-1 (]: 10 of 16 PASS not_null_company_dim_company_name ................................ [[32mPASS[0m in 1.87s]
[0m10:52:51.861940 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:52:51.862327 [debug] [Thread-1 (]: Began running node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:52:51.862724 [info ] [Thread-1 (]: 12 of 16 START test unique_company_dim_cik ..................................... [RUN]
[0m10:52:51.863382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce, now test.sec_edgar.unique_company_dim_cik.9427e720be)
[0m10:52:51.867314 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:52:51.873807 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.unique_company_dim_cik.9427e720be"
[0m10:52:51.875015 [debug] [Thread-1 (]: Timing info for test.sec_edgar.unique_company_dim_cik.9427e720be (compile): 10:52:51.867789 => 10:52:51.874794
[0m10:52:51.875396 [debug] [Thread-1 (]: Began executing node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:52:51.878224 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.unique_company_dim_cik.9427e720be"
[0m10:52:51.879198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:52:51.879749 [debug] [Thread-1 (]: On test.sec_edgar.unique_company_dim_cik.9427e720be: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.unique_company_dim_cik.9427e720be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select cik as unique_field
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
  where cik is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:52:51.956673 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_company_dim_cik.1042ff3e8b (execute): 10:52:49.948018 => 10:52:51.956301
[0m10:52:51.957690 [info ] [Thread-3 (]: 9 of 16 PASS not_null_company_dim_cik .......................................... [[32mPASS[0m in 2.01s]
[0m10:52:51.958196 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:52:51.958590 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:52:51.959335 [info ] [Thread-3 (]: 13 of 16 START test not_null_kpi_company_latest_cik ............................ [RUN]
[0m10:52:51.960476 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_company_dim_cik.1042ff3e8b, now test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd)
[0m10:52:51.961036 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:52:51.966966 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd"
[0m10:52:51.967918 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd (compile): 10:52:51.961389 => 10:52:51.967681
[0m10:52:51.968372 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:52:51.971316 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd"
[0m10:52:51.972887 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:52:51.973365 [debug] [Thread-3 (]: On test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
where cik is null



      
    ) dbt_internal_test
[0m10:52:51.977769 [debug] [Thread-4 (]: Timing info for test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad (execute): 10:52:49.831284 => 10:52:51.977451
[0m10:52:51.978789 [info ] [Thread-4 (]: 8 of 16 PASS accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data  [[32mPASS[0m in 2.15s]
[0m10:52:51.979433 [debug] [Thread-4 (]: Finished running node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:52:51.979883 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301
[0m10:52:51.980323 [info ] [Thread-4 (]: 14 of 16 START test not_null_kpi_company_latest_latest_quarter ................. [RUN]
[0m10:52:51.980996 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad, now test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301)
[0m10:52:51.981383 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301
[0m10:52:51.985630 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301"
[0m10:52:51.986460 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301 (compile): 10:52:51.981619 => 10:52:51.986272
[0m10:52:51.986803 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301
[0m10:52:51.988896 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301"
[0m10:52:51.989454 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:52:51.989831 [debug] [Thread-4 (]: On test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latest_quarter
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
where latest_quarter is null



      
    ) dbt_internal_test
[0m10:52:52.232573 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_company_dim_ticker.c89adc0564 (execute): 10:52:50.367941 => 10:52:52.232187
[0m10:52:52.234245 [info ] [Thread-2 (]: 11 of 16 PASS not_null_company_dim_ticker ...................................... [[32mPASS[0m in 1.87s]
[0m10:52:52.234764 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:52:52.235149 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0
[0m10:52:52.235693 [info ] [Thread-2 (]: 15 of 16 START test not_null_kpi_company_latest_latest_revenue ................. [RUN]
[0m10:52:52.236656 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_company_dim_ticker.c89adc0564, now test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0)
[0m10:52:52.237014 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0
[0m10:52:52.240709 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0"
[0m10:52:52.241400 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0 (compile): 10:52:52.237213 => 10:52:52.241245
[0m10:52:52.241682 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0
[0m10:52:52.243356 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0"
[0m10:52:52.243812 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:52:52.244132 [debug] [Thread-2 (]: On test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select latest_revenue
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
where latest_revenue is null



      
    ) dbt_internal_test
[0m10:52:52.865109 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:f33bbaf2-4e51-4fc9-8098-eca384f63e47&page=queryresults
[0m10:52:52.879965 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:a225f2c5-f093-405a-84ea-13a0a5d3ee30&page=queryresults
[0m10:52:53.136038 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:5641a6b1-6da0-4dc9-a7f0-210705d27ed4&page=queryresults
[0m10:52:53.179247 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:fe06942f-8f8c-4f5f-b367-35e63911d4f5&page=queryresults
[0m10:52:53.515880 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd (execute): 10:52:51.968640 => 10:52:53.514969
[0m10:52:53.517102 [info ] [Thread-3 (]: 13 of 16 PASS not_null_kpi_company_latest_cik .................................. [[32mPASS[0m in 1.56s]
[0m10:52:53.517602 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:52:53.517963 [debug] [Thread-3 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:52:53.518387 [info ] [Thread-3 (]: 16 of 16 START test not_null_kpi_company_latest_ticker ......................... [RUN]
[0m10:52:53.519001 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd, now test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db)
[0m10:52:53.519311 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:52:53.523274 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db"
[0m10:52:53.524044 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db (compile): 10:52:53.519490 => 10:52:53.523894
[0m10:52:53.524312 [debug] [Thread-3 (]: Began executing node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:52:53.525998 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db"
[0m10:52:53.526501 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:52:53.526830 [debug] [Thread-3 (]: On test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
where ticker is null



      
    ) dbt_internal_test
[0m10:52:53.571908 [debug] [Thread-1 (]: Timing info for test.sec_edgar.unique_company_dim_cik.9427e720be (execute): 10:52:51.875613 => 10:52:53.571669
[0m10:52:53.572634 [info ] [Thread-1 (]: 12 of 16 PASS unique_company_dim_cik ........................................... [[32mPASS[0m in 1.71s]
[0m10:52:53.573042 [debug] [Thread-1 (]: Finished running node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:52:53.840503 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301 (execute): 10:52:51.987041 => 10:52:53.840127
[0m10:52:53.841419 [error] [Thread-4 (]: 14 of 16 FAIL 5 not_null_kpi_company_latest_latest_quarter ..................... [[31mFAIL 5[0m in 1.86s]
[0m10:52:53.841878 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301
[0m10:52:53.870697 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0 (execute): 10:52:52.241846 => 10:52:53.869845
[0m10:52:53.871904 [error] [Thread-2 (]: 15 of 16 FAIL 5 not_null_kpi_company_latest_latest_revenue ..................... [[31mFAIL 5[0m in 1.64s]
[0m10:52:53.872390 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0
[0m10:52:54.260269 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:37282345-bde8-4599-9c31-66f63440bf5b&page=queryresults
[0m10:52:54.953739 [debug] [Thread-3 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db (execute): 10:52:53.524481 => 10:52:54.952780
[0m10:52:54.955011 [info ] [Thread-3 (]: 16 of 16 PASS not_null_kpi_company_latest_ticker ............................... [[32mPASS[0m in 1.44s]
[0m10:52:54.955574 [debug] [Thread-3 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:52:54.957448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:52:54.957720 [debug] [MainThread]: Connection 'test.sec_edgar.unique_company_dim_cik.9427e720be' was properly closed.
[0m10:52:54.957937 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_kpi_company_latest_latest_revenue.4c439626b0' was properly closed.
[0m10:52:54.958143 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db' was properly closed.
[0m10:52:54.958351 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_kpi_company_latest_latest_quarter.3a9a0f5301' was properly closed.
[0m10:52:54.958646 [info ] [MainThread]: 
[0m10:52:54.958918 [info ] [MainThread]: Finished running 3 table models, 13 tests in 0 hours 0 minutes and 13.63 seconds (13.63s).
[0m10:52:54.960617 [debug] [MainThread]: Command end result
[0m10:52:54.969952 [info ] [MainThread]: 
[0m10:52:54.970310 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m10:52:54.970564 [info ] [MainThread]: 
[0m10:52:54.970812 [error] [MainThread]:   Database Error in test accepted_values_kpi_ttm_revenue_quarters_count__3__4 (models/marts_viz/viz.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
  compiled Code at target/run/sec_edgar/models/marts_viz/viz.yml/accepted_values_kpi_ttm_revenue_quarters_count__3__4.sql
[0m10:52:54.971044 [info ] [MainThread]: 
[0m10:52:54.971265 [error] [MainThread]: [31mFailure in test not_null_kpi_company_latest_latest_quarter (models/marts_viz/viz.yml)[0m
[0m10:52:54.971482 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m10:52:54.971681 [info ] [MainThread]: 
[0m10:52:54.971887 [info ] [MainThread]:   compiled Code at target/compiled/sec_edgar/models/marts_viz/viz.yml/not_null_kpi_company_latest_latest_quarter.sql
[0m10:52:54.972090 [info ] [MainThread]: 
[0m10:52:54.972296 [error] [MainThread]: [31mFailure in test not_null_kpi_company_latest_latest_revenue (models/marts_viz/viz.yml)[0m
[0m10:52:54.972498 [error] [MainThread]:   Got 5 results, configured to fail if != 0
[0m10:52:54.972695 [info ] [MainThread]: 
[0m10:52:54.972890 [info ] [MainThread]:   compiled Code at target/compiled/sec_edgar/models/marts_viz/viz.yml/not_null_kpi_company_latest_latest_revenue.sql
[0m10:52:54.973107 [info ] [MainThread]: 
[0m10:52:54.973341 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=3 SKIP=0 TOTAL=16
[0m10:52:54.973716 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 16.455713, "process_user_time": 4.441735, "process_kernel_time": 1.805715, "process_mem_max_rss": "246824960", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:52:54.974037 [debug] [MainThread]: Command `dbt build` failed at 10:52:54.973959 after 16.46 seconds
[0m10:52:54.974330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x142aac560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13298bf20>]}
[0m10:52:54.974703 [debug] [MainThread]: Flushing usage events
[0m10:53:12.620911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10892f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897bcb0>]}


============================== 10:53:12.625134 | 7414a80f-07e1-40b4-a61d-b1679ceec673 ==============================
[0m10:53:12.625134 [info ] [MainThread]: Running with dbt=1.7.15
[0m10:53:12.625599 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'dbt/logs', 'fail_fast': 'False', 'profiles_dir': './dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt --select marts_viz', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:53:14.477364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7414a80f-07e1-40b4-a61d-b1679ceec673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108949a60>]}
[0m10:53:14.512103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7414a80f-07e1-40b4-a61d-b1679ceec673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720da60>]}
[0m10:53:14.513020 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m10:53:14.530288 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m10:53:14.643300 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:14.644060 [debug] [MainThread]: Partial parsing: updated file: sec_edgar://models/marts_viz/viz.yml
[0m10:53:14.828715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7414a80f-07e1-40b4-a61d-b1679ceec673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bc317c0>]}
[0m10:53:14.838437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7414a80f-07e1-40b4-a61d-b1679ceec673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b973440>]}
[0m10:53:14.838814 [info ] [MainThread]: Found 9 models, 19 tests, 2 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m10:53:14.840341 [info ] [MainThread]: 
[0m10:53:14.840924 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:53:14.841790 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m10:53:14.842144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:16.707402 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_curated)
[0m10:53:16.708378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse_sec_curated_sec_raw'
[0m10:53:16.709010 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse_sec_curated_sec_viz'
[0m10:53:16.709437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:16.709699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:16.709924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:17.149038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7414a80f-07e1-40b4-a61d-b1679ceec673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd1cd10>]}
[0m10:53:17.150318 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m10:53:17.150661 [info ] [MainThread]: 
[0m10:53:17.155100 [debug] [Thread-1 (]: Began running node model.sec_edgar.company_dim
[0m10:53:17.155482 [debug] [Thread-2 (]: Began running node model.sec_edgar.kpi_company_latest
[0m10:53:17.155947 [info ] [Thread-1 (]: 1 of 14 START sql table model sec_curated_sec_viz.company_dim .................. [RUN]
[0m10:53:17.156290 [debug] [Thread-3 (]: Began running node model.sec_edgar.kpi_ttm_revenue
[0m10:53:17.156599 [info ] [Thread-2 (]: 2 of 14 START sql table model sec_curated_sec_viz.kpi_company_latest ........... [RUN]
[0m10:53:17.157803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_curated, now model.sec_edgar.company_dim)
[0m10:53:17.158668 [info ] [Thread-3 (]: 3 of 14 START sql table model sec_curated_sec_viz.kpi_ttm_revenue .............. [RUN]
[0m10:53:17.159509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_raw, now model.sec_edgar.kpi_company_latest)
[0m10:53:17.159909 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.company_dim
[0m10:53:17.160395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_viz, now model.sec_edgar.kpi_ttm_revenue)
[0m10:53:17.160664 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.kpi_company_latest
[0m10:53:17.167761 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.company_dim"
[0m10:53:17.168101 [debug] [Thread-3 (]: Began compiling node model.sec_edgar.kpi_ttm_revenue
[0m10:53:17.170423 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.kpi_company_latest"
[0m10:53:17.172872 [debug] [Thread-3 (]: Writing injected SQL for node "model.sec_edgar.kpi_ttm_revenue"
[0m10:53:17.173692 [debug] [Thread-1 (]: Timing info for model.sec_edgar.company_dim (compile): 10:53:17.160863 => 10:53:17.173442
[0m10:53:17.174144 [debug] [Thread-2 (]: Timing info for model.sec_edgar.kpi_company_latest (compile): 10:53:17.168280 => 10:53:17.173961
[0m10:53:17.174456 [debug] [Thread-1 (]: Began executing node model.sec_edgar.company_dim
[0m10:53:17.174885 [debug] [Thread-2 (]: Began executing node model.sec_edgar.kpi_company_latest
[0m10:53:17.175219 [debug] [Thread-3 (]: Timing info for model.sec_edgar.kpi_ttm_revenue (compile): 10:53:17.170725 => 10:53:17.175069
[0m10:53:17.187432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:17.187906 [debug] [Thread-3 (]: Began executing node model.sec_edgar.kpi_ttm_revenue
[0m10:53:17.189822 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:17.195330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:17.690903 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.kpi_company_latest"
[0m10:53:17.692203 [debug] [Thread-2 (]: On model.sec_edgar.kpi_company_latest: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.kpi_company_latest"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
      
    
    

    OPTIONS()
    as (
      

with latest_quarters as (
  select 
    cik,
    ticker,
    max(period_end_date) as latest_quarter
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  group by cik, ticker
),
revenue_data as (
  select 
    f.cik,
    f.ticker,
    f.period_end_date,
    f.value as revenue,
    f.fy,
    f.fp
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly` f
  join latest_quarters lq on f.cik = lq.cik and f.period_end_date = lq.latest_quarter
  where f.concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax')
    and f.value > 0
),
company_info as (
  select 
    cik,
    ticker,
    company_name
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)
select 
  ci.cik,
  ci.ticker,
  ci.company_name,
  rd.period_end_date as latest_quarter,
  rd.revenue as latest_revenue,
  rd.fy as fiscal_year,
  rd.fp as fiscal_period,
  current_timestamp() as refreshed_at
from company_info ci
left join revenue_data rd on ci.cik = rd.cik
where ci.ticker is not null
order by rd.revenue desc
    );
  
[0m10:53:17.747414 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.company_dim"
[0m10:53:17.764705 [debug] [Thread-1 (]: On model.sec_edgar.company_dim: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.company_dim"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
      
    
    

    OPTIONS()
    as (
      

with company_base as (
  select 
    cik,
    ticker,
    company_name
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  where ticker is not null
),
latest_filing as (
  select 
    cik,
    max(period_end_date) as latest_filing_date,
    count(distinct period_end_date) as total_quarters_filed
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  group by cik
),
revenue_summary as (
  select 
    cik,
    count(distinct case when concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax') then period_end_date end) as revenue_quarters_count,
    max(case when concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax') then period_end_date end) as latest_revenue_date
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  where value > 0
  group by cik
)
select 
  cb.cik,
  cb.ticker,
  cb.company_name,
  lf.latest_filing_date,
  lf.total_quarters_filed,
  coalesce(rs.revenue_quarters_count, 0) as revenue_quarters_count,
  rs.latest_revenue_date,
  case 
    when rs.revenue_quarters_count >= 4 then 'Active'
    when rs.revenue_quarters_count >= 1 then 'Limited Data'
    else 'No Revenue Data'
  end as data_completeness,
  current_timestamp() as refreshed_at
from company_base cb
left join latest_filing lf on cb.cik = lf.cik
left join revenue_summary rs on cb.cik = rs.cik
order by cb.ticker
    );
  
[0m10:53:17.776605 [debug] [Thread-3 (]: Writing runtime sql for node "model.sec_edgar.kpi_ttm_revenue"
[0m10:53:17.784989 [debug] [Thread-3 (]: On model.sec_edgar.kpi_ttm_revenue: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.kpi_ttm_revenue"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
  select 
    cik,
    ticker,
    period_end_date,
    value as revenue,
    fy,
    fp
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  where concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax')
    and value > 0
    and fp in ('Q1', 'Q2', 'Q3', 'Q4')
),
latest_quarters as (
  select 
    cik,
    ticker,
    max(period_end_date) as latest_quarter
  from quarterly_revenue
  group by cik, ticker
),
ttm_calculation as (
  select 
    qr.cik,
    qr.ticker,
    sum(qr.revenue) as ttm_revenue,
    count(*) as quarters_count,
    max(qr.period_end_date) as latest_quarter_date,
    string_agg(concat(cast(qr.fy as string), '-', qr.fp), ', ' order by qr.period_end_date) as ttm_periods
  from quarterly_revenue qr
  join latest_quarters lq on qr.cik = lq.cik
  where qr.period_end_date > date_sub(lq.latest_quarter, interval 365 day)
    and qr.period_end_date <= lq.latest_quarter
  group by qr.cik, qr.ticker
  having count(*) >= 3
),
company_info as (
  select 
    cik,
    ticker,
    company_name
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)
select 
  ci.cik,
  ci.ticker,
  ci.company_name,
  ttm.ttm_revenue,
  ttm.quarters_count,
  ttm.latest_quarter_date,
  ttm.ttm_periods,
  round(ttm.ttm_revenue / 1000000000, 2) as ttm_revenue_billions,
  current_timestamp() as refreshed_at
from company_info ci
join ttm_calculation ttm on ci.cik = ttm.cik
where ci.ticker is not null
order by ttm.ttm_revenue desc
    );
  
[0m10:53:18.222366 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:6fcac162-255e-4dd3-9400-488ee7322093&page=queryresults
[0m10:53:18.350441 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:4e58c3f2-892e-4dc2-b332-6a97b82796f7&page=queryresults
[0m10:53:18.382408 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:adbf471a-c6a3-44e7-9f36-1991643a2cb6&page=queryresults
[0m10:53:21.231783 [debug] [Thread-2 (]: Timing info for model.sec_edgar.kpi_company_latest (execute): 10:53:17.177977 => 10:53:21.231609
[0m10:53:21.232663 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7414a80f-07e1-40b4-a61d-b1679ceec673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd4d220>]}
[0m10:53:21.233101 [info ] [Thread-2 (]: 2 of 14 OK created sql table model sec_curated_sec_viz.kpi_company_latest ...... [[32mCREATE TABLE (5.0 rows, 1.0 MiB processed)[0m in 4.07s]
[0m10:53:21.233516 [debug] [Thread-2 (]: Finished running node model.sec_edgar.kpi_company_latest
[0m10:53:21.233986 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:53:21.234332 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:53:21.234579 [info ] [Thread-4 (]: 4 of 14 START test not_null_kpi_company_latest_cik ............................. [RUN]
[0m10:53:21.234865 [info ] [Thread-2 (]: 5 of 14 START test not_null_kpi_company_latest_ticker .......................... [RUN]
[0m10:53:21.235378 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd'
[0m10:53:21.235803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.sec_edgar.kpi_company_latest, now test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db)
[0m10:53:21.236081 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:53:21.236357 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:53:21.242265 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd"
[0m10:53:21.245093 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db"
[0m10:53:21.246569 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd (compile): 10:53:21.236526 => 10:53:21.246379
[0m10:53:21.246894 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db (compile): 10:53:21.242498 => 10:53:21.246742
[0m10:53:21.247191 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:53:21.247457 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:53:21.258152 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd"
[0m10:53:21.260311 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db"
[0m10:53:21.261328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:21.261693 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:53:21.262092 [debug] [Thread-2 (]: On test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
where ticker is null



      
    ) dbt_internal_test
[0m10:53:21.262460 [debug] [Thread-4 (]: On test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
where cik is null



      
    ) dbt_internal_test
[0m10:53:21.814472 [debug] [Thread-1 (]: Timing info for model.sec_edgar.company_dim (execute): 10:53:17.175399 => 10:53:21.814236
[0m10:53:21.816168 [debug] [Thread-3 (]: Timing info for model.sec_edgar.kpi_ttm_revenue (execute): 10:53:17.188559 => 10:53:21.816006
[0m10:53:21.816967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7414a80f-07e1-40b4-a61d-b1679ceec673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd4d8b0>]}
[0m10:53:21.817514 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7414a80f-07e1-40b4-a61d-b1679ceec673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13bd4d760>]}
[0m10:53:21.817999 [info ] [Thread-1 (]: 1 of 14 OK created sql table model sec_curated_sec_viz.company_dim ............. [[32mCREATE TABLE (5.0 rows, 1.1 MiB processed)[0m in 4.66s]
[0m10:53:21.818418 [info ] [Thread-3 (]: 3 of 14 OK created sql table model sec_curated_sec_viz.kpi_ttm_revenue ......... [[32mCREATE TABLE (0.0 rows, 1.0 MiB processed)[0m in 4.66s]
[0m10:53:21.818842 [debug] [Thread-1 (]: Finished running node model.sec_edgar.company_dim
[0m10:53:21.819198 [debug] [Thread-3 (]: Finished running node model.sec_edgar.kpi_ttm_revenue
[0m10:53:21.819756 [debug] [Thread-3 (]: Began running node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:53:21.820106 [info ] [Thread-3 (]: 6 of 14 START test accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data  [RUN]
[0m10:53:21.820542 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:53:21.821013 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.sec_edgar.kpi_ttm_revenue, now test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad)
[0m10:53:21.821323 [info ] [Thread-1 (]: 7 of 14 START test not_null_company_dim_cik .................................... [RUN]
[0m10:53:21.821934 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:53:21.822702 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.company_dim, now test.sec_edgar.not_null_company_dim_cik.1042ff3e8b)
[0m10:53:21.827227 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad"
[0m10:53:21.827585 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:53:21.830597 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_company_dim_cik.1042ff3e8b"
[0m10:53:21.831406 [debug] [Thread-3 (]: Timing info for test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad (compile): 10:53:21.822915 => 10:53:21.831236
[0m10:53:21.831714 [debug] [Thread-3 (]: Began executing node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:53:21.832035 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_company_dim_cik.1042ff3e8b (compile): 10:53:21.827827 => 10:53:21.831885
[0m10:53:21.833409 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:53:21.835143 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_company_dim_cik.1042ff3e8b"
[0m10:53:21.837332 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad"
[0m10:53:21.837929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:21.838413 [debug] [Thread-1 (]: On test.sec_edgar.not_null_company_dim_cik.1042ff3e8b: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_company_dim_cik.1042ff3e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
where cik is null



      
    ) dbt_internal_test
[0m10:53:21.838743 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:21.839560 [debug] [Thread-3 (]: On test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        data_completeness as value_field,
        count(*) as n_records

    from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
    group by data_completeness

)

select *
from all_values
where value_field not in (
    'Active','Limited Data','No Revenue Data'
)



      
    ) dbt_internal_test
[0m10:53:22.034806 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:8eb0d9ee-f1d6-45ec-96d4-b73c669098aa&page=queryresults
[0m10:53:22.193433 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:a29408e6-8954-489a-9e3b-25b5924c486e&page=queryresults
[0m10:53:23.016046 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:8793f8aa-508c-47e9-a897-f477121b1ccb&page=queryresults
[0m10:53:23.189180 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:46bc557c-be8c-4bfe-a909-5846cf2cd9ce&page=queryresults
[0m10:53:24.020300 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db (execute): 10:53:21.258446 => 10:53:24.020038
[0m10:53:24.021048 [info ] [Thread-2 (]: 5 of 14 PASS not_null_kpi_company_latest_ticker ................................ [[32mPASS[0m in 2.79s]
[0m10:53:24.021466 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:53:24.021781 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:53:24.022141 [info ] [Thread-2 (]: 8 of 14 START test not_null_company_dim_company_name ........................... [RUN]
[0m10:53:24.022775 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db, now test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce)
[0m10:53:24.023046 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:53:24.026312 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce"
[0m10:53:24.027069 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce (compile): 10:53:24.023213 => 10:53:24.026917
[0m10:53:24.027345 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:53:24.029000 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce"
[0m10:53:24.029638 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:24.030006 [debug] [Thread-2 (]: On test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
where company_name is null



      
    ) dbt_internal_test
[0m10:53:24.058052 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd (execute): 10:53:21.247642 => 10:53:24.057811
[0m10:53:24.058799 [info ] [Thread-4 (]: 4 of 14 PASS not_null_kpi_company_latest_cik ................................... [[32mPASS[0m in 2.82s]
[0m10:53:24.059213 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:53:24.059518 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:53:24.059868 [info ] [Thread-4 (]: 9 of 14 START test not_null_company_dim_ticker ................................. [RUN]
[0m10:53:24.060620 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd, now test.sec_edgar.not_null_company_dim_ticker.c89adc0564)
[0m10:53:24.061084 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:53:24.065166 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_company_dim_ticker.c89adc0564"
[0m10:53:24.065981 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_company_dim_ticker.c89adc0564 (compile): 10:53:24.061372 => 10:53:24.065832
[0m10:53:24.066258 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:53:24.067918 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_company_dim_ticker.c89adc0564"
[0m10:53:24.068501 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:24.068809 [debug] [Thread-4 (]: On test.sec_edgar.not_null_company_dim_ticker.c89adc0564: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_company_dim_ticker.c89adc0564"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
where ticker is null



      
    ) dbt_internal_test
[0m10:53:24.294158 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_company_dim_cik.1042ff3e8b (execute): 10:53:21.833659 => 10:53:24.293752
[0m10:53:24.295423 [info ] [Thread-1 (]: 7 of 14 PASS not_null_company_dim_cik .......................................... [[32mPASS[0m in 2.47s]
[0m10:53:24.296246 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:53:24.296665 [debug] [Thread-1 (]: Began running node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:53:24.296979 [info ] [Thread-1 (]: 10 of 14 START test unique_company_dim_cik ..................................... [RUN]
[0m10:53:24.298257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_company_dim_cik.1042ff3e8b, now test.sec_edgar.unique_company_dim_cik.9427e720be)
[0m10:53:24.298987 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:53:24.306407 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.unique_company_dim_cik.9427e720be"
[0m10:53:24.308139 [debug] [Thread-1 (]: Timing info for test.sec_edgar.unique_company_dim_cik.9427e720be (compile): 10:53:24.299209 => 10:53:24.307690
[0m10:53:24.308936 [debug] [Thread-1 (]: Began executing node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:53:24.311200 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.unique_company_dim_cik.9427e720be"
[0m10:53:24.312321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:24.312694 [debug] [Thread-1 (]: On test.sec_edgar.unique_company_dim_cik.9427e720be: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.unique_company_dim_cik.9427e720be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select cik as unique_field
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
  where cik is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:53:24.336346 [debug] [Thread-3 (]: Timing info for test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad (execute): 10:53:21.832197 => 10:53:24.336034
[0m10:53:24.337220 [info ] [Thread-3 (]: 6 of 14 PASS accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data  [[32mPASS[0m in 2.52s]
[0m10:53:24.337704 [debug] [Thread-3 (]: Finished running node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:53:24.338048 [debug] [Thread-3 (]: Began running node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:53:24.338432 [info ] [Thread-3 (]: 11 of 14 START test accepted_values_kpi_ttm_revenue_quarters_count__3__4 ....... [RUN]
[0m10:53:24.339033 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad, now test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5)
[0m10:53:24.339347 [debug] [Thread-3 (]: Began compiling node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:53:24.342591 [debug] [Thread-3 (]: Writing injected SQL for node "test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5"
[0m10:53:24.343405 [debug] [Thread-3 (]: Timing info for test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5 (compile): 10:53:24.339530 => 10:53:24.343252
[0m10:53:24.344005 [debug] [Thread-3 (]: Began executing node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:53:24.345682 [debug] [Thread-3 (]: Writing runtime sql for node "test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5"
[0m10:53:24.346351 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:24.346703 [debug] [Thread-3 (]: On test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        quarters_count as value_field,
        count(*) as n_records

    from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
    group by quarters_count

)

select *
from all_values
where value_field not in (
    '3','4'
)



      
    ) dbt_internal_test
[0m10:53:24.759393 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:bb90cf97-f07e-4030-97fe-49759fba48c3&page=queryresults
[0m10:53:24.897186 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:5784edf7-3bc4-4597-a495-8ad465d4f1bd&page=queryresults
[0m10:53:25.033026 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:9f59bbdd-9225-410f-b647-04cb5a67f55f&page=queryresults
[0m10:53:25.035342 [debug] [Thread-3 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]; reason: invalidQuery, location: query, message: No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]')
[0m10:53:25.373595 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:749f3951-62f2-4466-ab4e-3a5906ce8844&page=queryresults
[0m10:53:25.600963 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce (execute): 10:53:24.027509 => 10:53:25.599893
[0m10:53:25.602330 [info ] [Thread-2 (]: 8 of 14 PASS not_null_company_dim_company_name ................................. [[32mPASS[0m in 1.58s]
[0m10:53:25.602851 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:53:25.603221 [debug] [Thread-2 (]: Began running node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:53:25.603636 [info ] [Thread-2 (]: 12 of 14 START test not_null_kpi_ttm_revenue_cik ............................... [RUN]
[0m10:53:25.604266 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce, now test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973)
[0m10:53:25.604619 [debug] [Thread-2 (]: Began compiling node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:53:25.608647 [debug] [Thread-2 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973"
[0m10:53:25.609748 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973 (compile): 10:53:25.605128 => 10:53:25.609584
[0m10:53:25.610089 [debug] [Thread-2 (]: Began executing node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:53:25.613854 [debug] [Thread-2 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973"
[0m10:53:25.614591 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:25.614930 [debug] [Thread-2 (]: On test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
where cik is null



      
    ) dbt_internal_test
[0m10:53:25.780182 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_company_dim_ticker.c89adc0564 (execute): 10:53:24.066421 => 10:53:25.779101
[0m10:53:25.782194 [info ] [Thread-4 (]: 9 of 14 PASS not_null_company_dim_ticker ....................................... [[32mPASS[0m in 1.72s]
[0m10:53:25.783540 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:53:25.784415 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:53:25.785114 [info ] [Thread-4 (]: 13 of 14 START test not_null_kpi_ttm_revenue_ticker ............................ [RUN]
[0m10:53:25.785821 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_company_dim_ticker.c89adc0564, now test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1)
[0m10:53:25.786140 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:53:25.790303 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1"
[0m10:53:25.791100 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1 (compile): 10:53:25.786328 => 10:53:25.790907
[0m10:53:25.791431 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:53:25.793195 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1"
[0m10:53:25.793808 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:25.794138 [debug] [Thread-4 (]: On test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
where ticker is null



      
    ) dbt_internal_test
[0m10:53:26.017148 [debug] [Thread-1 (]: Timing info for test.sec_edgar.unique_company_dim_cik.9427e720be (execute): 10:53:24.309275 => 10:53:26.016245
[0m10:53:26.019211 [info ] [Thread-1 (]: 10 of 14 PASS unique_company_dim_cik ........................................... [[32mPASS[0m in 1.72s]
[0m10:53:26.020537 [debug] [Thread-1 (]: Finished running node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:53:26.021329 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:53:26.022040 [info ] [Thread-1 (]: 14 of 14 START test not_null_kpi_ttm_revenue_ttm_revenue ....................... [RUN]
[0m10:53:26.022744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.unique_company_dim_cik.9427e720be, now test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93)
[0m10:53:26.023071 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:53:26.027197 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93"
[0m10:53:26.028045 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93 (compile): 10:53:26.023269 => 10:53:26.027887
[0m10:53:26.028332 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:53:26.030026 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93"
[0m10:53:26.030611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:26.030939 [debug] [Thread-1 (]: On test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ttm_revenue
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
where ttm_revenue is null



      
    ) dbt_internal_test
[0m10:53:26.256364 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:dcccb46d-9972-4b71-a239-71102db30bf9&page=queryresults
[0m10:53:26.416680 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:ce828af1-5b68-4943-9001-ec10335696f9&page=queryresults
[0m10:53:26.419258 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:ce828af1-5b68-4943-9001-ec10335696f9&page=queryresults
[0m10:53:26.421853 [debug] [Thread-3 (]: Timing info for test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5 (execute): 10:53:24.344167 => 10:53:26.420513
[0m10:53:26.435005 [debug] [Thread-3 (]: Database Error in test accepted_values_kpi_ttm_revenue_quarters_count__3__4 (models/marts_viz/viz.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
  compiled Code at target/run/sec_edgar/models/marts_viz/viz.yml/accepted_values_kpi_ttm_revenue_quarters_count__3__4.sql
[0m10:53:26.435652 [error] [Thread-3 (]: 11 of 14 ERROR accepted_values_kpi_ttm_revenue_quarters_count__3__4 ............ [[31mERROR[0m in 2.10s]
[0m10:53:26.436129 [debug] [Thread-3 (]: Finished running node test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5
[0m10:53:26.607377 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:9e4201f9-995b-4ccf-bf97-e3eda12bc7c7&page=queryresults
[0m10:53:26.920402 [debug] [Thread-2 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973 (execute): 10:53:25.610262 => 10:53:26.920102
[0m10:53:26.921278 [info ] [Thread-2 (]: 12 of 14 PASS not_null_kpi_ttm_revenue_cik ..................................... [[32mPASS[0m in 1.32s]
[0m10:53:26.921761 [debug] [Thread-2 (]: Finished running node test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973
[0m10:53:27.651570 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:42778d08-4a6b-4e7f-9c65-898875f40114&page=queryresults
[0m10:53:27.715343 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1 (execute): 10:53:25.791609 => 10:53:27.714998
[0m10:53:27.716367 [info ] [Thread-4 (]: 13 of 14 PASS not_null_kpi_ttm_revenue_ticker .................................. [[32mPASS[0m in 1.93s]
[0m10:53:27.716838 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1
[0m10:53:29.419728 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93 (execute): 10:53:26.028497 => 10:53:29.418739
[0m10:53:29.421187 [info ] [Thread-1 (]: 14 of 14 PASS not_null_kpi_ttm_revenue_ttm_revenue ............................. [[32mPASS[0m in 3.40s]
[0m10:53:29.421739 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93
[0m10:53:29.424687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:29.425523 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_kpi_ttm_revenue_ttm_revenue.061c148d93' was properly closed.
[0m10:53:29.426021 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_kpi_ttm_revenue_cik.85c0804973' was properly closed.
[0m10:53:29.426425 [debug] [MainThread]: Connection 'test.sec_edgar.accepted_values_kpi_ttm_revenue_quarters_count__3__4.09558f1ea5' was properly closed.
[0m10:53:29.426805 [debug] [MainThread]: Connection 'test.sec_edgar.not_null_kpi_ttm_revenue_ticker.8bea3e7cf1' was properly closed.
[0m10:53:29.427303 [info ] [MainThread]: 
[0m10:53:29.427812 [info ] [MainThread]: Finished running 3 table models, 11 tests in 0 hours 0 minutes and 14.59 seconds (14.59s).
[0m10:53:29.430490 [debug] [MainThread]: Command end result
[0m10:53:29.442052 [info ] [MainThread]: 
[0m10:53:29.442434 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m10:53:29.442678 [info ] [MainThread]: 
[0m10:53:29.442931 [error] [MainThread]:   Database Error in test accepted_values_kpi_ttm_revenue_quarters_count__3__4 (models/marts_viz/viz.yml)
  No matching signature for operator IN for argument types INT64 and {STRING} at [24:23]
  compiled Code at target/run/sec_edgar/models/marts_viz/viz.yml/accepted_values_kpi_ttm_revenue_quarters_count__3__4.sql
[0m10:53:29.443178 [info ] [MainThread]: 
[0m10:53:29.443516 [info ] [MainThread]: Done. PASS=13 WARN=0 ERROR=1 SKIP=0 TOTAL=14
[0m10:53:29.443950 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 16.877398, "process_user_time": 4.39826, "process_kernel_time": 2.009463, "process_mem_max_rss": "252166144", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:53:29.444301 [debug] [MainThread]: Command `dbt build` failed at 10:53:29.444219 after 16.88 seconds
[0m10:53:29.444611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082cea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ef1d0>]}
[0m10:53:29.444884 [debug] [MainThread]: Flushing usage events
[0m10:53:46.699103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a40890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a42180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a94ef0>]}


============================== 10:53:46.703182 | cf3b206d-b80c-41a3-86e6-9b971585a6ed ==============================
[0m10:53:46.703182 [info ] [MainThread]: Running with dbt=1.7.15
[0m10:53:46.703690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'dbt/logs', 'profiles_dir': './dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir ./dbt --profiles-dir ./dbt --select marts_viz', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:53:48.481581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf3b206d-b80c-41a3-86e6-9b971585a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a427e0>]}
[0m10:53:48.516339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf3b206d-b80c-41a3-86e6-9b971585a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15e815790>]}
[0m10:53:48.517225 [info ] [MainThread]: Registered adapter: bigquery=1.7.5
[0m10:53:48.533043 [debug] [MainThread]: checksum: e4cfa841c1cf2b310128daf3fe81590497b767fe3788aa75c7f0bcc4959f94d1, vars: {}, profile: , target: , version: 1.7.15
[0m10:53:48.634603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:48.635271 [debug] [MainThread]: Partial parsing: updated file: sec_edgar://models/marts_viz/viz.yml
[0m10:53:48.802355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf3b206d-b80c-41a3-86e6-9b971585a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f9e7ec0>]}
[0m10:53:48.811767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf3b206d-b80c-41a3-86e6-9b971585a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ec93170>]}
[0m10:53:48.812132 [info ] [MainThread]: Found 9 models, 18 tests, 2 sources, 0 exposures, 0 metrics, 454 macros, 0 groups, 0 semantic models
[0m10:53:48.813586 [info ] [MainThread]: 
[0m10:53:48.814153 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:53:48.815036 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse'
[0m10:53:48.815364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:50.522256 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse, now list_sec-edgar-financials-warehouse_sec_curated_sec_raw)
[0m10:53:50.523357 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse_sec_curated_sec_viz'
[0m10:53:50.524002 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_sec-edgar-financials-warehouse_sec_curated_sec_curated'
[0m10:53:50.524461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:53:50.524714 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:50.524945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:50.930997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf3b206d-b80c-41a3-86e6-9b971585a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15eb5e780>]}
[0m10:53:50.932174 [info ] [MainThread]: Concurrency: 4 threads (target='prod')
[0m10:53:50.932524 [info ] [MainThread]: 
[0m10:53:50.937065 [debug] [Thread-1 (]: Began running node model.sec_edgar.company_dim
[0m10:53:50.937426 [debug] [Thread-2 (]: Began running node model.sec_edgar.kpi_company_latest
[0m10:53:50.937753 [debug] [Thread-3 (]: Began running node model.sec_edgar.kpi_ttm_revenue
[0m10:53:50.938180 [info ] [Thread-1 (]: 1 of 13 START sql table model sec_curated_sec_viz.company_dim .................. [RUN]
[0m10:53:50.938577 [info ] [Thread-2 (]: 2 of 13 START sql table model sec_curated_sec_viz.kpi_company_latest ........... [RUN]
[0m10:53:50.938928 [info ] [Thread-3 (]: 3 of 13 START sql table model sec_curated_sec_viz.kpi_ttm_revenue .............. [RUN]
[0m10:53:50.939539 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_raw, now model.sec_edgar.company_dim)
[0m10:53:50.940003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_viz, now model.sec_edgar.kpi_company_latest)
[0m10:53:50.940734 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_sec-edgar-financials-warehouse_sec_curated_sec_curated, now model.sec_edgar.kpi_ttm_revenue)
[0m10:53:50.941047 [debug] [Thread-1 (]: Began compiling node model.sec_edgar.company_dim
[0m10:53:50.941307 [debug] [Thread-2 (]: Began compiling node model.sec_edgar.kpi_company_latest
[0m10:53:50.941556 [debug] [Thread-3 (]: Began compiling node model.sec_edgar.kpi_ttm_revenue
[0m10:53:50.950169 [debug] [Thread-2 (]: Writing injected SQL for node "model.sec_edgar.kpi_company_latest"
[0m10:53:50.950354 [debug] [Thread-1 (]: Writing injected SQL for node "model.sec_edgar.company_dim"
[0m10:53:50.952591 [debug] [Thread-3 (]: Writing injected SQL for node "model.sec_edgar.kpi_ttm_revenue"
[0m10:53:50.953663 [debug] [Thread-2 (]: Timing info for model.sec_edgar.kpi_company_latest (compile): 10:53:50.948052 => 10:53:50.953325
[0m10:53:50.954116 [debug] [Thread-1 (]: Timing info for model.sec_edgar.company_dim (compile): 10:53:50.941741 => 10:53:50.953932
[0m10:53:50.954460 [debug] [Thread-2 (]: Began executing node model.sec_edgar.kpi_company_latest
[0m10:53:50.954807 [debug] [Thread-3 (]: Timing info for model.sec_edgar.kpi_ttm_revenue (compile): 10:53:50.950540 => 10:53:50.954656
[0m10:53:50.955051 [debug] [Thread-1 (]: Began executing node model.sec_edgar.company_dim
[0m10:53:50.964796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:53:50.965118 [debug] [Thread-3 (]: Began executing node model.sec_edgar.kpi_ttm_revenue
[0m10:53:50.966602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:50.968590 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:53:51.334919 [debug] [Thread-3 (]: Writing runtime sql for node "model.sec_edgar.kpi_ttm_revenue"
[0m10:53:51.335949 [debug] [Thread-3 (]: On model.sec_edgar.kpi_ttm_revenue: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.kpi_ttm_revenue"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_ttm_revenue`
      
    
    

    OPTIONS()
    as (
      

with quarterly_revenue as (
  select 
    cik,
    ticker,
    period_end_date,
    value as revenue,
    fy,
    fp
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  where concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax')
    and value > 0
    and fp in ('Q1', 'Q2', 'Q3', 'Q4')
),
latest_quarters as (
  select 
    cik,
    ticker,
    max(period_end_date) as latest_quarter
  from quarterly_revenue
  group by cik, ticker
),
ttm_calculation as (
  select 
    qr.cik,
    qr.ticker,
    sum(qr.revenue) as ttm_revenue,
    count(*) as quarters_count,
    max(qr.period_end_date) as latest_quarter_date,
    string_agg(concat(cast(qr.fy as string), '-', qr.fp), ', ' order by qr.period_end_date) as ttm_periods
  from quarterly_revenue qr
  join latest_quarters lq on qr.cik = lq.cik
  where qr.period_end_date > date_sub(lq.latest_quarter, interval 365 day)
    and qr.period_end_date <= lq.latest_quarter
  group by qr.cik, qr.ticker
  having count(*) >= 3
),
company_info as (
  select 
    cik,
    ticker,
    company_name
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)
select 
  ci.cik,
  ci.ticker,
  ci.company_name,
  ttm.ttm_revenue,
  ttm.quarters_count,
  ttm.latest_quarter_date,
  ttm.ttm_periods,
  round(ttm.ttm_revenue / 1000000000, 2) as ttm_revenue_billions,
  current_timestamp() as refreshed_at
from company_info ci
join ttm_calculation ttm on ci.cik = ttm.cik
where ci.ticker is not null
order by ttm.ttm_revenue desc
    );
  
[0m10:53:51.363712 [debug] [Thread-1 (]: Writing runtime sql for node "model.sec_edgar.company_dim"
[0m10:53:51.364546 [debug] [Thread-1 (]: On model.sec_edgar.company_dim: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.company_dim"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
      
    
    

    OPTIONS()
    as (
      

with company_base as (
  select 
    cik,
    ticker,
    company_name
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
  where ticker is not null
),
latest_filing as (
  select 
    cik,
    max(period_end_date) as latest_filing_date,
    count(distinct period_end_date) as total_quarters_filed
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  group by cik
),
revenue_summary as (
  select 
    cik,
    count(distinct case when concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax') then period_end_date end) as revenue_quarters_count,
    max(case when concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax') then period_end_date end) as latest_revenue_date
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  where value > 0
  group by cik
)
select 
  cb.cik,
  cb.ticker,
  cb.company_name,
  lf.latest_filing_date,
  lf.total_quarters_filed,
  coalesce(rs.revenue_quarters_count, 0) as revenue_quarters_count,
  rs.latest_revenue_date,
  case 
    when rs.revenue_quarters_count >= 4 then 'Active'
    when rs.revenue_quarters_count >= 1 then 'Limited Data'
    else 'No Revenue Data'
  end as data_completeness,
  current_timestamp() as refreshed_at
from company_base cb
left join latest_filing lf on cb.cik = lf.cik
left join revenue_summary rs on cb.cik = rs.cik
order by cb.ticker
    );
  
[0m10:53:51.418369 [debug] [Thread-2 (]: Writing runtime sql for node "model.sec_edgar.kpi_company_latest"
[0m10:53:51.420038 [debug] [Thread-2 (]: On model.sec_edgar.kpi_company_latest: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "model.sec_edgar.kpi_company_latest"} */

  
    

    create or replace table `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
      
    
    

    OPTIONS()
    as (
      

with latest_quarters as (
  select 
    cik,
    ticker,
    max(period_end_date) as latest_quarter
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly`
  group by cik, ticker
),
revenue_data as (
  select 
    f.cik,
    f.ticker,
    f.period_end_date,
    f.value as revenue,
    f.fy,
    f.fp
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`fct_financials_quarterly` f
  join latest_quarters lq on f.cik = lq.cik and f.period_end_date = lq.latest_quarter
  where f.concept in ('Revenues', 'SalesRevenueNet', 'RevenueFromContractWithCustomerExcludingAssessedTax')
    and f.value > 0
),
company_info as (
  select 
    cik,
    ticker,
    company_name
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_curated`.`dim_company`
)
select 
  ci.cik,
  ci.ticker,
  ci.company_name,
  rd.period_end_date as latest_quarter,
  rd.revenue as latest_revenue,
  rd.fy as fiscal_year,
  rd.fp as fiscal_period,
  current_timestamp() as refreshed_at
from company_info ci
left join revenue_data rd on ci.cik = rd.cik
where ci.ticker is not null
order by rd.revenue desc
    );
  
[0m10:53:51.926187 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:ba990b16-e886-4edd-81ee-e75818af8603&page=queryresults
[0m10:53:51.967531 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3d27283c-0777-40b7-9077-756dd8cf14b9&page=queryresults
[0m10:53:52.086353 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:bee2526a-e6fd-42c6-9174-3e1f4729137d&page=queryresults
[0m10:53:55.347510 [debug] [Thread-1 (]: Timing info for model.sec_edgar.company_dim (execute): 10:53:50.965322 => 10:53:55.347344
[0m10:53:55.349076 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf3b206d-b80c-41a3-86e6-9b971585a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fa0cbf0>]}
[0m10:53:55.349509 [info ] [Thread-1 (]: 1 of 13 OK created sql table model sec_curated_sec_viz.company_dim ............. [[32mCREATE TABLE (5.0 rows, 1.1 MiB processed)[0m in 4.41s]
[0m10:53:55.349926 [debug] [Thread-1 (]: Finished running node model.sec_edgar.company_dim
[0m10:53:55.350436 [debug] [Thread-4 (]: Began running node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:53:55.350793 [info ] [Thread-4 (]: 4 of 13 START test accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data  [RUN]
[0m10:53:55.351096 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:53:55.351583 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad'
[0m10:53:55.351862 [info ] [Thread-1 (]: 5 of 13 START test not_null_company_dim_cik .................................... [RUN]
[0m10:53:55.352142 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:53:55.352579 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.sec_edgar.company_dim, now test.sec_edgar.not_null_company_dim_cik.1042ff3e8b)
[0m10:53:55.361092 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad"
[0m10:53:55.361404 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:53:55.367222 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_company_dim_cik.1042ff3e8b"
[0m10:53:55.367774 [debug] [Thread-4 (]: Timing info for test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad (compile): 10:53:55.352751 => 10:53:55.367597
[0m10:53:55.368057 [debug] [Thread-4 (]: Began executing node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:53:55.375007 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_company_dim_cik.1042ff3e8b (compile): 10:53:55.361671 => 10:53:55.374858
[0m10:53:55.377582 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad"
[0m10:53:55.377905 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:53:55.379617 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_company_dim_cik.1042ff3e8b"
[0m10:53:55.380027 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:53:55.380390 [debug] [Thread-4 (]: On test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        data_completeness as value_field,
        count(*) as n_records

    from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
    group by data_completeness

)

select *
from all_values
where value_field not in (
    'Active','Limited Data','No Revenue Data'
)



      
    ) dbt_internal_test
[0m10:53:55.380669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:55.381410 [debug] [Thread-1 (]: On test.sec_edgar.not_null_company_dim_cik.1042ff3e8b: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_company_dim_cik.1042ff3e8b"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
where cik is null



      
    ) dbt_internal_test
[0m10:53:56.143552 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:3c9d9f64-1a47-4390-bbc5-53b64e41b416&page=queryresults
[0m10:53:56.153867 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:36c39157-7cbc-47d5-86fa-37a15b1f4729&page=queryresults
[0m10:53:56.800423 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_company_dim_cik.1042ff3e8b (execute): 10:53:55.378146 => 10:53:56.799949
[0m10:53:56.801547 [info ] [Thread-1 (]: 5 of 13 PASS not_null_company_dim_cik .......................................... [[32mPASS[0m in 1.45s]
[0m10:53:56.802958 [debug] [Thread-4 (]: Timing info for test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad (execute): 10:53:55.368254 => 10:53:56.802769
[0m10:53:56.803454 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_company_dim_cik.1042ff3e8b
[0m10:53:56.804044 [info ] [Thread-4 (]: 4 of 13 PASS accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data  [[32mPASS[0m in 1.45s]
[0m10:53:56.804412 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:53:56.804958 [debug] [Thread-4 (]: Finished running node test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad
[0m10:53:56.805309 [info ] [Thread-1 (]: 6 of 13 START test not_null_company_dim_company_name ........................... [RUN]
[0m10:53:56.805983 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:53:56.806749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_company_dim_cik.1042ff3e8b, now test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce)
[0m10:53:56.807078 [info ] [Thread-4 (]: 7 of 13 START test not_null_company_dim_ticker ................................. [RUN]
[0m10:53:56.807357 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:53:56.807784 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.accepted_values_company_dim_data_completeness__Active__Limited_Data__No_Revenue_Data.8fbc52d3ad, now test.sec_edgar.not_null_company_dim_ticker.c89adc0564)
[0m10:53:56.811114 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce"
[0m10:53:56.811429 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:53:56.814486 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_company_dim_ticker.c89adc0564"
[0m10:53:56.815037 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce (compile): 10:53:56.807966 => 10:53:56.814880
[0m10:53:56.815339 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:53:56.817027 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce"
[0m10:53:56.817349 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_company_dim_ticker.c89adc0564 (compile): 10:53:56.811689 => 10:53:56.817213
[0m10:53:56.817646 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:53:56.818908 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:53:56.819325 [debug] [Thread-1 (]: On test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select company_name
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
where company_name is null



      
    ) dbt_internal_test
[0m10:53:56.821207 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_company_dim_ticker.c89adc0564"
[0m10:53:56.822317 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:56.822649 [debug] [Thread-4 (]: On test.sec_edgar.not_null_company_dim_ticker.c89adc0564: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_company_dim_ticker.c89adc0564"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
where ticker is null



      
    ) dbt_internal_test
[0m10:53:57.541456 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:d0af59e8-05d1-4bbe-996d-72ebed393b41&page=queryresults
[0m10:53:57.830204 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:30642f74-a69f-4739-be17-7c245397a076&page=queryresults
[0m10:53:58.281641 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_company_dim_ticker.c89adc0564 (execute): 10:53:56.817823 => 10:53:58.281336
[0m10:53:58.282560 [info ] [Thread-4 (]: 7 of 13 PASS not_null_company_dim_ticker ....................................... [[32mPASS[0m in 1.47s]
[0m10:53:58.283246 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_company_dim_ticker.c89adc0564
[0m10:53:58.283614 [debug] [Thread-4 (]: Began running node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:53:58.284023 [info ] [Thread-4 (]: 8 of 13 START test unique_company_dim_cik ...................................... [RUN]
[0m10:53:58.284617 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_company_dim_ticker.c89adc0564, now test.sec_edgar.unique_company_dim_cik.9427e720be)
[0m10:53:58.284918 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:53:58.289882 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.unique_company_dim_cik.9427e720be"
[0m10:53:58.290827 [debug] [Thread-4 (]: Timing info for test.sec_edgar.unique_company_dim_cik.9427e720be (compile): 10:53:58.285099 => 10:53:58.290615
[0m10:53:58.291156 [debug] [Thread-4 (]: Began executing node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:53:58.293139 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.unique_company_dim_cik.9427e720be"
[0m10:53:58.293994 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:53:58.294360 [debug] [Thread-4 (]: On test.sec_edgar.unique_company_dim_cik.9427e720be: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.unique_company_dim_cik.9427e720be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select cik as unique_field
  from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`company_dim`
  where cik is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m10:53:58.751830 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce (execute): 10:53:56.815509 => 10:53:58.751556
[0m10:53:58.752646 [info ] [Thread-1 (]: 6 of 13 PASS not_null_company_dim_company_name ................................. [[32mPASS[0m in 1.95s]
[0m10:53:58.753553 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce
[0m10:53:59.244343 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:cfab2955-ca27-4962-a4ea-ea48c9584197&page=queryresults
[0m10:53:59.890018 [debug] [Thread-4 (]: Timing info for test.sec_edgar.unique_company_dim_cik.9427e720be (execute): 10:53:58.291387 => 10:53:59.889728
[0m10:53:59.890785 [info ] [Thread-4 (]: 8 of 13 PASS unique_company_dim_cik ............................................ [[32mPASS[0m in 1.61s]
[0m10:53:59.891206 [debug] [Thread-4 (]: Finished running node test.sec_edgar.unique_company_dim_cik.9427e720be
[0m10:54:01.312682 [debug] [Thread-2 (]: Timing info for model.sec_edgar.kpi_company_latest (execute): 10:53:50.955240 => 10:54:01.312511
[0m10:54:01.313373 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf3b206d-b80c-41a3-86e6-9b971585a6ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ebb67e0>]}
[0m10:54:01.313808 [info ] [Thread-2 (]: 2 of 13 OK created sql table model sec_curated_sec_viz.kpi_company_latest ...... [[32mCREATE TABLE (5.0 rows, 1.0 MiB processed)[0m in 10.37s]
[0m10:54:01.314222 [debug] [Thread-2 (]: Finished running node model.sec_edgar.kpi_company_latest
[0m10:54:01.314634 [debug] [Thread-1 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:54:01.315037 [debug] [Thread-4 (]: Began running node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:54:01.315407 [info ] [Thread-1 (]: 9 of 13 START test not_null_kpi_company_latest_cik ............................. [RUN]
[0m10:54:01.315939 [info ] [Thread-4 (]: 10 of 13 START test not_null_kpi_company_latest_ticker ......................... [RUN]
[0m10:54:01.316581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.sec_edgar.not_null_company_dim_company_name.08ef18f1ce, now test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd)
[0m10:54:01.317206 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.sec_edgar.unique_company_dim_cik.9427e720be, now test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db)
[0m10:54:01.317537 [debug] [Thread-1 (]: Began compiling node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:54:01.317798 [debug] [Thread-4 (]: Began compiling node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:54:01.321567 [debug] [Thread-4 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db"
[0m10:54:01.324771 [debug] [Thread-1 (]: Writing injected SQL for node "test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd"
[0m10:54:01.325391 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db (compile): 10:54:01.318507 => 10:54:01.325194
[0m10:54:01.325714 [debug] [Thread-4 (]: Began executing node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
[0m10:54:01.327567 [debug] [Thread-4 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db"
[0m10:54:01.327994 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd (compile): 10:54:01.317967 => 10:54:01.327777
[0m10:54:01.328479 [debug] [Thread-1 (]: Began executing node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:54:01.330457 [debug] [Thread-1 (]: Writing runtime sql for node "test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd"
[0m10:54:01.330877 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:54:01.331356 [debug] [Thread-4 (]: On test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select ticker
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
where ticker is null



      
    ) dbt_internal_test
[0m10:54:01.331668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:54:01.332516 [debug] [Thread-1 (]: On test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd: /* {"app": "dbt", "dbt_version": "1.7.15", "profile_name": "sec_edgar_bq", "target_name": "prod", "node_id": "test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select cik
from `sec-edgar-financials-warehouse`.`sec_curated_sec_viz`.`kpi_company_latest`
where cik is null



      
    ) dbt_internal_test
[0m10:54:02.067729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:197a0566-8fb7-4c0c-ad07-1102450b6938&page=queryresults
[0m10:54:02.248316 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=sec-edgar-financials-warehouse&j=bq:US:7992de68-695f-453c-b1fb-e44e62b0c19e&page=queryresults
[0m10:54:02.796376 [debug] [Thread-1 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd (execute): 10:54:01.328725 => 10:54:02.795954
[0m10:54:02.797523 [info ] [Thread-1 (]: 9 of 13 PASS not_null_kpi_company_latest_cik ................................... [[32mPASS[0m in 1.48s]
[0m10:54:02.798123 [debug] [Thread-1 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_cik.49d71c00bd
[0m10:54:03.132810 [debug] [Thread-4 (]: Timing info for test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db (execute): 10:54:01.325916 => 10:54:03.132413
[0m10:54:03.133825 [info ] [Thread-4 (]: 10 of 13 PASS not_null_kpi_company_latest_ticker ............................... [[32mPASS[0m in 1.82s]
[0m10:54:03.134376 [debug] [Thread-4 (]: Finished running node test.sec_edgar.not_null_kpi_company_latest_ticker.f838f277db
